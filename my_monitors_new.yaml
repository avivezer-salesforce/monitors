# team: TEAMNAME

alerts:

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] Mongo % Cache
    usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:data-tests,feature_name:orca}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:data-tests,feature_name:orca}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:data-tests'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n{{/is_alert}}  \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal \n{{/is_recovery}}  \n@slack-dd-data-tests"
  'multi': true
  'name': '[Data-tests] [sys] % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-data-tests'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 30
    'notify_audit': true
    'renotify_interval': 20
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_10m):min:system.swap.pct_free{environment:data-tests}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:data-tests'

- 'message': '.'
  'name': '[Prod] [Orca] [Infra] Integration - Fetched
    data core to Orca'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:production,feature_name:orca},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'orca'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:data-tests,type:mongo,feature_name:lead-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo,feature_name:lead-scoring}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:core-fetcher,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration,feature_name:engagement-scoring}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:pardot-fetcher,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}

    @slack-dd-p-staging-app'
  'multi': true
  'name': '[p-staging] [app] MongoDB has too many
    open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Data-tests] [App] [Core-Fetcher] Failed
    Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:data-tests,feature_name:core-fetcher,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'core-fetcher'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Sys]
    [Mongo] % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Attribution] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:attribution,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'attribution'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [scorer] [SQS]:
    Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-scorer}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests-dev,feature_name:oppcasting,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:data-tests-dev,type:mongo,feature_name:oppcasting}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': '@ychrysler@salesforce.com @dtendler@salesforce.com
    @ggovorov@salesforce.com @areznikov@salesforce.com @onijinsky@salesforce.com @slack-bot-oppty-scoring-prod
    @naama.horesh@salesforce.com'
  'multi': true
  'name': 'Oppty Scoring Error in tenant {{tid.name}}
    during last hour'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'max(last_1d):sum:orca.module.opptyscoring.runner.error{environment:production}
    by {tid} > 0'
  'restricted_roles': null
  'tags':
  - '*'
  - 'oppty_score'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Attribution] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:attribution,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo","feature_name:pardot-fetcher").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Sys]
    [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:campaign-insights,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Orca] % Usable Memory
    on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:orca,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Pod01] Number of containers
    for core-fetcher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:core-fetcher,implisit_service:implisit/core-fetcher:runtime,type:core-fetcher-canary,pod:pod01}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'core-fetcher'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Attribution] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-at-staging-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] Number of containers for campaign-insights-0
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'avg(last_10m):sum:docker.containers.running{host:pilot-staging-docker-campaign-insights-0,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Orca] Number of
    containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-beat:runtime,type:orca}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production,feature_name:core-fetcher,pod:pod00}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'env:production'
  - 'pod00'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [All] [Infra] Integration -
    Fetched data from core to All'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:pilot-staging},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Attribution] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-at-staging-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [All] % Usable Memory on
    {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:data-tests,feature_name:engagement-scoring}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'engagement-scoring'
  - 'mongo'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Lead-Scoring] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:production,rabbitmq_vhost:lead-scoring}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'lead-scoring'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Connections]
    Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:data-tests,type:mongo,feature_name:orca}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-forecast-subworker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,type:forecasting,implisit_service:implisit/celery-forecast-subworker:runtime,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Data-tests] [sys] [Offline Jobs] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests","feature_name:offline-jobs").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'offline-jobs'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:production,type:mongo,feature_name:attribution}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:core-fetcher,pod:pod01}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration,feature_name:oppcasting}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'oppcasting'
  - 'mongo'

- 'message': '.'
  'name': '[Staging] [All] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-staging-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging,feature_name:campaign-insights}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Attribution] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:attribution,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Sys]
    [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:engagement-scoring,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files\n@pagerduty-Ofek-Datadog \n {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Prod] [All] [Mongo] [app] MongoDB has
    too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Pardot-Fetcher] No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:pardot-fetcher,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:integration,type:mongo,feature_name:pardot-fetcher}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Integration] [All] [Infra] RDS CPU High'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 80.0
      'warning': 70.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.rds.cpuutilization{name:jungle-integration}
    > 80'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'infra'
  - 'rds'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo,feature_name:pardot-fetcher}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:integration,feature_name:oppcasting}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:production,feature_name:pardot-fetcher}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:integration,type:mongo,feature_name:pardot-fetcher}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Attribution] No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:attribution,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'attribution'

- 'message': '.'
  'name': '[Staging] [Campaign-Insights] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-ci-staging-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [sys] [Core-Fetcher] Load
    average (norm.15)'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'name': '[Prod] [Attribution] [Infra] Celery -
    Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:production,feature_name:attribution}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'attribution'
  - 'env:production'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging,feature_name:core-fetcher,pod:pod00}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:campaign-insights,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:pilot-staging,type:mongo,feature_name:campaign-insights}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}

    @slack-dd-perf-app'
  'multi': true
  'name': '[Perf] [app] MongoDB has too many open
    files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:performance}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:performance'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Offline-Jobs] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:offline-jobs,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'offline-jobs'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring-light in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,type:oppcasting-training,implisit_service:implisit/celery-oppty-scoring-light:runtime}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': '.'
  'name': '[Prod] [Core-Fetcher] [Pod00] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-cf-production-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production,feature_name:attribution}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'attribution'
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Engagement-Scoring]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:engagement-scoring,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Sys]
    [Mongo]  No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:engagement-scoring,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'status'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:pardot-fetcher,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging,feature_name:engagement-scoring}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}} \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}} \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [sys] [Core-Fetcher]
    No swap configured for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:core-fetcher,pod:pod01,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Camp. Insights]
    Number of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:campaign-insights,type:campaign-insights-pusher,implisit_service:implisit/celery-system-alerts:runtime,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'campaign-insights'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:attribution,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'attribution'

- 'message': '.'
  'name': '[Prod] [Core-Fetcher] [Pod01] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-cf-prod-pod01}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Eng. Scoring] Number
    of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/celery-pusher:runtime,type:engagement-scoring-pusher}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:integration,type:mongo,feature_name:oppcasting}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:pilot-staging,type:mongo,feature_name:oppcasting}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Lead-Scoring] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:lead-scoring,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:oppcasting,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'oppcasting'

- 'message': '.'
  'name': '[Prod] [Engagement-Scoring] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:production,rabbitmq_vhost:engagement-scoring}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'engagement-scoring'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': '.'
  'name': '[Integration] [Campaign-Insights] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-ci-integ-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Sys]
    [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:pardot-fetcher,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Orca] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:orca,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'orca'

- 'message': '.'
  'name': '[Prod] [All] [Infra] RDS Low Memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 20.0
    'timeout_h': 0
  'query': 'avg(last_30m):( avg:aws.rds.memory.free{name:jungle-production}
    / avg:aws.rds.memory.total{name:jungle-production} ) * 100 < 15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'infra'
  - 'rds'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Oppcasting] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-oc-production-pod01}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:production,type:mongo,feature_name:lead-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Sys]
    [Mongo]  % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:production,feature_name:engagement-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Tickets -
    Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:data-tests,type:mongo}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration,feature_name:pardot-fetcher}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Staging] [Core-Fetcher] [Pod01] [Infra]
    Integration - Fetched data core to Core-Fetcher'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:pilot-staging,feature_name:core-fetcher,pod:pod01},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Attribution] [Infra] AWS
    Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-at-integ-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Connections]
    Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:data-tests}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': '.'
  'name': '[Prod] [Core-Fetcher] [Pod01] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:production,feature_name:core-fetcher,pod:pod01}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'core-fetcher'
  - 'env:production'
  - 'pod01'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Attribution] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:attribution,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:data-tests,feature_name:campaign-insights}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:oppcasting,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Lead Scoring] Number
    of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-beat:runtime,type:lead-scoring-celery-beat}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Orca] Number of
    containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-system-alerts:runtime,type:fetchers-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] Mongo % Cache
    usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:pilot-staging'
  - 'cross-features'
  'type': 'query alert'

- 'message': 'Value: {{value}} < {{threshold}}'
  'name': '[Prod] Full Cycle Count Last 24H (Mongo5)
    < 4'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 4.0
      'warning': 6.0
    'timeout_h': 0
  'query': 'sum(last_1d):sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,mongo:mongo-5.vpc-internal}.as_count()
    < 4'
  'restricted_roles': null
  'tags':
  - 'pagerduty'
  - 'env:production'
  - 'mongocycles'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:data-tests,type:mongo,feature_name:campaign-insights}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': "--pilot-staging--\nRedis - No connections\
    \ for more than 4 hours\n## Check out some extra data on the:\n[Bonobo _extra\
    \ detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
    ```"
  'multi': true
  'name': '[Bnbo] [stag] [Redis] current connections'
  'options':
    'escalation_message': "***Renotifying***\n--pilot-staging--\n\
      Redis - No connections for more than 4 hours\n## Check out some extra data on\
      \ the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
      ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
      ```"
    'evaluation_delay': 590
    'include_tags': false
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:aws.elasticache.curr_connections{replication_group:b-redis-staging}
    by {name} < 1'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'redis'
  'type': 'query alert'

- 'message': ''
  'name': '[Integration] [Pod00] [App] [Attribution]
    [SEV0] Attribution Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:integration,feature_name:attribution,!sfenv:stmp1}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'attribution'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n@slack-dd-data-tests"
  'multi': true
  'name': '[Data-tests] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 2
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests","process:mongo").by("host","process").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Sys]
    [Mongo] % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:engagement-scoring,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Attribution] Number of containers
    for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:attribution,implisit_service:implisit/celery-pusher:runtime,environment:production,type:attribution-pusher}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'attribution'
  - 'env:production'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-oppty-scoring
    {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-oppty-scoring:runtime,type:oppty-scoring-main-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [All] [Mongo] [app] MongoDB
    has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Connections]
    Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:production,feature_name:orca}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Infra] Clock in sync with NTP
    - test'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'infra'
  - 'status'
  - 'TODO'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Staging] [Pod00] [App] [Pardot-Fetcher]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:pilot-staging,feature_name:pardot-fetcher,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'pardot-fetcher'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Connections]
    Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:production,type:mongo,feature_name:orca}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:integration,feature_name:oppcasting}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Orca] Number of
    containers for celery-fetcher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 7.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-fetcher:runtime,type:fetcher}
    by {host} < 7'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "--pilot-staging--\n{{host.base_name}}\
    \ - Job is down for the last 2 hours\n## Check out some extra data on the:\n[Bonobo\
    \ _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
    ```"
  'multi': true
  'name': '[Bnbo] [stag] [K8S] Job Is Up'
  'options':
    'escalation_message': '***Renotifying***

      --pilot-staging--

      {{host.base_name}} - Job is down for the last 2 hours

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-pilot-staging

      - @bonobo_dev@salesforce.com

      ```'
    'include_tags': true
    'locked': true
    'new_host_delay': 3600
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'avg(last_2h):avg:kubernetes.pods.running{kubernetes_name_space:bonobo,env:pilot-staging}
    by {host} < 1'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'kubernetes'
  - 'sys'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:oppcasting,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Sys]
    [Mongo]  No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:core-fetcher,!type:jungle,type:mongo,pod:pod01}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'core-fetcher'
  - 'pod01'

- 'message': "System load average is high on {{host.name}}\
    \ \n\n@slack-dd-perf-sys"
  'multi': true
  'name': '[Perf] [sys] Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.5
    'timeout_h': 0
  'query': 'avg(last_15m):avg:system.load.norm.15{environment:performance}
    by {host} > 1.5'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:performance'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:integration,feature_name:campaign-insights}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:attribution,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'attribution'

- 'message': '.'
  'name': '[Staging] [Lead-Scoring] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:pilot-staging,rabbitmq_vhost:lead-scoring}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'lead-scoring'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:pilot-staging,type:mongo,feature_name:oppcasting}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:data-tests,type:mongo,feature_name:engagement-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Core-Fetcher] [Pod00] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-cf-staging-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Orca] % Usable Swap
    Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:orca,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'orca'

- 'message': "{{#is_alert}}\n@slack-dd-prod \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-prod \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Jenkins] System Test - Connectivity
    (prod_gs0)'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 2
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'unknown': 1
      'warning': 1
    'timeout_h': 0
  'query': '"jenkins.job.status".over("host:impl-jenkins-production.pod00-CD","job:tests/connectivity_tests_runner_production_gs0").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'Tests'
  - 'status'
  - 'env:production'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests-dev,feature_name:oppcasting,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:attribution,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Core-Fetcher] [Pod01]
    [Infra] Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:integration,feature_name:core-fetcher,pod:pod01}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'core-fetcher'
  - 'pod01'
  - 'env:integration'
  - 'infra'
  'type': 'query alert'

- 'message': "System load is high on {{host.name}}\
    \ for over 1 hours\n @slack-bot-datadog-build"
  'multi': true
  'name': '[Build] [sys] Agent Load average'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.5
      'warning': 1.2
    'timeout_h': 0
  'query': 'min(last_1h):max:system.load.norm.15{environment:build,type:jenkins-slave}
    by {host} > 1.5'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:build'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo","feature_name:core-fetcher","pod:pod01").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Queue]  Queued
    read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo,feature_name:orca}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppty-scoring:runtime,type:oppcasting-worker,environment:integration}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Queue]
    Queued read requests'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:integration,type:mongo,feature_name:pardot-fetcher}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Lead-Scoring] No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:lead-scoring,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'lead-scoring'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}} \n@slack-dd-data-tests"
  'multi': true
  'name': '[Data-tests] MongoDB Replica with lag
    dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'

- 'message': '.'
  'name': '[Integration] [Core-Fetcher] [Pod00]
    [Infra] Integration - Fetched data core to Core-Fetcher'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:integration,feature_name:core-fetcher,pod:pod00},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Lead-Scoring] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:lead-scoring,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:production,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'name': '[Prod] [Core-Fetcher] [Pod00] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-cf-production-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:data-tests-dev,feature_name:oppcasting}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': '.'
  'name': '[Prod] [Attribution] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:production,rabbitmq_vhost:attribution}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'attribution'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Campaign-Insights] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:campaign-insights,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{value}} \n \n\
    {{/is_alert}} \n\n{{#is_no_data}}\n \n \n{{host.name}} \n{{/is_no_data}} \n\n\
    {{#is_alert_recovery}}\n \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n\
    \ \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:core-fetcher,!type:jungle,type:mongo,pod:pod00}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'core-fetcher'
  - 'pod00'

- 'message': '.'
  'name': '[Integration] [Campaign-Insights] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:integration,feature_name:campaign-insights}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'campaign-insights'
  - 'env:integration'
  - 'infra'
  'type': 'query alert'

- 'message': 'A query should be running in Splunk
    every 4 hours to validate that all voice calls processes will finish in the specified
    SLA.

    If a voice call does not finish within the SLA an alert is sent from Splunk to
    Datadog and is monitored by https://app.datadoghq.com/monitors/17120873.


    To make sure the job is running every 4 hours in Splunk, there is an alert that
    needs to be sent to Datadog from Splunk confirming there is no problem with the
    specified job.

    If Datadog does not receive an alert every 4 hours -> this monitor will create
    an alert indicating that the job is not running.'
  'name': 'pilot-staging: Splunk Tracking Pipeline
    - job is running'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'events(''sources:splunk priority:all
    "pilot-staging: Splunk Tracking Pipeline job is running"'').rollup(''count'').last(''4h'')
    <= 0'
  'restricted_roles': null
  'type': 'event alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:campaign-insights,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'campaign-insights'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo","feature_name:attribution").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'attribution'
  'type': 'service check'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on\
    \ {{host.name}} is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:production,feature_name:engagement-scoring}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:production,feature_name:engagement-scoring}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:production'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests","process:mongo","feature_name:engagement-scoring").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:production,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:pilot-staging,type:mongo,feature_name:attribution}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Campaign-Insights] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:campaign-insights,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [sys] [Core-Fetcher]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n@slack-dd-prod\
      \ \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-prod \n\
      {{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}} \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}} \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Orca] No swap configured
    for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:orca,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'orca'

- 'message': '?'
  'name': '[Staging] [Fetcher] SIQ Objects Fetched
    (< 100 24H)'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'sum(last_4h):sum:orca.siq.fetch.object_fetches{environment:pilot-staging,feature_name:orca}.as_count()
    < 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'integration'
  - 'env:pilot-staging'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Orca] Load average (norm.15)'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:orca,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'orca'

- 'message': '.'
  'name': '[Integration] [Engagement-Scoring] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-es-integ-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [app] MongoDB
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo","feature_name:attribution").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'attribution'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}}\n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Handles]
    WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:data-tests,type:mongo}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': '.'
  'name': '[Staging] [Lead-Scoring] [Infra] AWS
    Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-ls-staging-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for eng-scoring-main-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/eng-scoring-main-cycle:runtime,type:engagement-scoring-main-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo,feature_name:engagement-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Prod] [Campaign-Insights] [Infra] AWS
    Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-ci-production-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] RabbitMQ node
    memory use is high on {{host.name}}'
  'options':
    'escalation_message': 'RabbitMQ node memory
      consumption still very high on {{host.name}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 240
    'require_full_window': true
    'thresholds':
      'critical': 4000000000.0
      'warning': 2000000000.0
    'timeout_h': 0
  'query': 'min(last_5m):avg:rabbitmq.node.mem_used{environment:pilot-staging}
    by {host} > 4000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'
  'type': 'query alert'

- 'message': '{{value}}'
  'name': '[Prod] [Canary] [Pod00] [App] [Core-Fetcher]
    [SEV0] Core-Fetcher Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:core-fetcher,canary:true,pod:pod00,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'canary'
  - 'core-fetcher'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Orca] [SEV2] - Number of errors
    is higher than 1000'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.log.ERROR{environment:production,feature_name:orca}.as_count(),
    0) >= 1000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sev2'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Eng. Scoring]
    Number of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:pilot-staging,feature_name:engagement-scoring,implisit_service:implisit/celery-beat:runtime,type:engagement-scoring-celery-beat}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Data-tests] [App] [Orca] Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:data-tests,feature_name:orca,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'orca'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-siq-fetcher-fetch-chunk
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-siq-fetcher-fetch-chunk:runtime,type:fetchers-worker-canary}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': "{{#is_alert}}\n\n\n{{/is_alert}} \n\
    \n\n{{#is_no_data}}\n\n\n{{/is_no_data}}"
  'multi': true
  'name': 'Jenkins Slave - C5 (dedicated hosts)'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'min(last_1m):default(sum:docker.containers.running{type:jenkins-slave,instance-type:c5.4xlarge,docker_image:187473451979.dkr.ecr.us-west-2.amazonaws.com/jenkins-slave:20190512t110335_2c2d30c7}
    by {host,instance-type},0) > 0'
  'restricted_roles': null
  'tags':
  - 'slave'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:pilot-staging,type:mongo,feature_name:pardot-fetcher}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:integration,type:mongo,feature_name:engagement-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-staging-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:oppcasting,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}\n\n@slack-dd-perf-app"
  'multi': true
  'name': '[Integration] [All] [Mongo] MongoDB Replica
    with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:lead-scoring,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'status'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo,feature_name:engagement-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:data-tests,type:mongo,feature_name:attribution}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Containers] [Attribution]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:integration,feature_name:attribution}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'anomaly'
  - 'env:integration'
  - 'attribution'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Attribution] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:pilot-staging,rabbitmq_vhost:attribution}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'attribution'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-oppty-scoring-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-oppty-scoring-worker:runtime,type:oppty-scoring-main}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Handles]
    WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo,feature_name:orca}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Canary] [Containers] [Lead Scoring]
    Number of containers for celery-lead-scoring-gm-contribution in {{host.name}}
    is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-gm-contribution:runtime,type:lead-scoring-gm-contribution-worker-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:production'
  - 'canary'

- 'message': '. @slack-sev0-1'
  'name': '[Prod] [Pod00] [App] [Core-Fetcher] [SEV0]
    Core-Fetcher Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:core-fetcher,pod:pod00,canary:false,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [app] MongoDB
    Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production,feature_name:oppcasting}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'oppcasting'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Engagement-Scoring]
    Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:engagement-scoring,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'engagement-scoring'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:production,feature_name:oppcasting}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'oppcasting'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:integration,type:mongo,feature_name:campaign-insights}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Queue]  Queued
    write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Camp. Insights]
    Number of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:campaign-insights,environment:pilot-staging,implisit_service:implisit/celery-beat:runtime,type:campaign-insights-celery-beat}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'campaign-insights'
  - 'env:pilot-staging'

- 'message': "--pilot-staging--\nRedis - CPU Usage\
    \ is over 80% for more than 4 hours\n## Check out some extra data on the:\n[Bonobo\
    \ _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
    ```"
  'multi': true
  'name': '[Bnbo] [stag] [Redis] CPU Usage'
  'options':
    'escalation_message': "***Renotifying***\n--pilot-staging--\n\
      Redis - CPU Usage is over 80% for more than 4 hours\n## Check out some extra\
      \ data on the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
      ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
      ```"
    'evaluation_delay': 586
    'include_tags': false
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 80.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:aws.elasticache.cpuutilization{replication_group:b-redis-staging}
    by {name} > 80'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'redis'
  - 'sys'
  - 'cpu'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Staging] [Pod00] [App] [Core-Fetcher]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:pilot-staging,feature_name:core-fetcher,pod:pod00,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_no_data}} \n{{/is_no_data}} \n\n{{#is_no_data_recovery}} \n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}} \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [sys] [Core-Fetcher]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-prod'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n\
    {{/is_no_data_recovery}} \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage\
    \ back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Sys] [Mongo] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:oppcasting,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [All] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-integ}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests,feature_name:lead-scoring}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:data-tests'
  - 'lead-scoring'
  - 'mongo'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [app] MongoDB
    has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests,feature_name:orca}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] Zookeeper
    nodes number'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.nodes{environment:data-tests}
    by {name} < 20'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:data-tests,type:mongo,feature_name:campaign-insights}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:pilot-staging,feature_name:oppcasting}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests,feature_name:lead-scoring}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': '.'
  'name': '[Integration] [All] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-integ}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Fault
    Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:integration,feature_name:orca}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [Pod00] [sys] [Core-Fetcher] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production","feature_name:core-fetcher","pod:pod00").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod00'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for oppty-scoring-training-cycle-small
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,implisit_service:implisit/oppty-scoring-training-cycle-small:runtime,feature_name:orca,type:oppty-scoring-training-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': '.'
  'name': '[Integration] [All] [Infra] Slack service
    sent messages is low'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
      'warning': 5.0
    'timeout_h': 0
  'query': 'sum(last_1d):default(sum:aws.sqs.number_of_messages_sent{queuename:integration-slack-service.fifo}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'infra'
  - 'slack'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Oppcasting] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:oppcasting,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:production,feature_name:core-fetcher,pod:pod00}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:oppcasting,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{value}} \n@pagerduty-Ofek-Datadog\
    \ \n{{/is_alert}} \n\n{{#is_no_data}}\n \n@pagerduty-Ofek-Datadog \n{{host.name}}\
    \ \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n \n{{value}} \n{{/is_alert_recovery}}\n\
    \n{{#is_no_data_recovery}}\n \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Sys] [Mongo]  No swap configured
    for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 15
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,type:mongo,!type:jungle}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'cross-features'
  - 'pagerduty'

- 'message': ''
  'name': '[Integration] [Pod00] [App] [Core-Fetcher]
    [SEV0] Core-Fetcher Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:integration,feature_name:core-fetcher,pod:pod00,!sfenv:stmp1}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Pardot-Fetcher]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:pardot-fetcher,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] Zookeeper
    latency'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10000.0
      'warning': 7000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.latency.max{environment:data-tests}
    by {name} > 10000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:pilot-staging,type:mongo,feature_name:pardot-fetcher}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo,feature_name:oppcasting}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Containers] [Orca] Number
    of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:data-tests,feature_name:orca,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'containers'
  - 'anomaly'
  - 'orca'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Containers] [Orca] Number of
    containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:production,feature_name:orca,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'anomaly'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:data-tests,feature_name:pardot-fetcher}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n{{#is_alert}} \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}} \n\
    {{/is_alert_recovery}}"
  'multi': true
  'name': '[Development] [Recovery Test] [Pod00]
    Conf-2 is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:development","host:development.pod00-mongo-conf-2","pod:pod00","process:mongo").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'cross-features'
  - 'env:data-tests'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for oppcasting-main-cycle in {{host.name}} is
    below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/oppcasting-main-cycle:runtime,type:oppcasting-tenant-cycle-canary}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Sys]
    [Mongo]  No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:campaign-insights,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'status'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n{{value}}  Redis flushes\
    \ occurred on {{last_triggered_at}} \n@slack-Main_Account-dd-perf-infra \n{{/is_alert}}"
  'name': '[Perf] Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_30m):avg:aws.elasticache.evictions{replication_group:celery-performance}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:performance'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Orca] Number
    of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/celery-pusher:runtime,type:pusher,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:data-tests,type:mongo,feature_name:core-fetcher}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring-heavy in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,type:oppcasting-training,implisit_service:implisit/celery-oppty-scoring-heavy:runtime}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:integration,feature_name:attribution}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:integration,feature_name:attribution}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:integration'
  - 'attribution'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Orca] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-orca-production}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': ''
  'name': '[Integration] [Pod00] [App] [Engagement-Scoring]
    [SEV0] Engagement-Scoring Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:integration,feature_name:engagement-scoring,!sfenv:stmp1}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'engagement-scoring'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-b2b-marketing-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/celery-b2b-marketing-worker:runtime,type:engagement-scoring-worker}
    by {host} < 3'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:pilot-staging,feature_name:core-fetcher,pod:pod01}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': '{{#is_warning}}This is a warning level
    event{{/is_warning}}

    {{#is_alert}} RabbitMQ node memory use is high on {{host.name}} {{/is_alert}}'
  'name': '[Pilot-dev][Ran] Test when there are
    too many connections to redis(AWS-ElasticCache)'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
      'warning': 4.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:aws.elasticache.curr_connections{name:b-redis-pilot-dev-001,replication_group:b-redis-pilot-dev}
    > 5'
  'restricted_roles': null
  'tags':
  - 'redis'
  - 'infra'

- 'message': '.'
  'name': '[Prod] [Campaign-Insights] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:production,feature_name:campaign-insights}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'campaign-insights'
  - 'env:production'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': '. @slack-sev0-1'
  'name': '[Prod] [Pod00] [App] [Lead-Scoring] [SEV0]
    Lead-Scoring Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:lead-scoring,canary:false,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'lead-scoring'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:pilot-staging,type:mongo,feature_name:pardot-fetcher}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Data-tests] [Engagement-Scoring] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-es-data-tests}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Orca] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-orca-pilot-staging}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [Engagement-Scoring] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:data-tests,feature_name:engagement-scoring}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'engagement-scoring'
  - 'env:data-tests'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Queue]  Queued
    write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo,feature_name:orca}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:lead-scoring,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Attribution] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:attribution,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:data-tests,feature_name:lead-scoring}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [app] MongoDB
    Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production,feature_name:attribution}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'attribution'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Sys] [Mongo] Disk space
    is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:orca,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{value}} \n\
    {{/is_alert}} \n\n\n{{#is_recovery}}\n \n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo,feature_name:lead-scoring}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Sys]
    [Mongo] % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:engagement-scoring,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [All] [Infra] Fetcher - SIQ
    Objects Fetched (< 100 4H)'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 100.0
    'timeout_h': 0
  'query': 'sum(last_4h):avg:orca.siq.fetch.object_fetches{environment:pilot-staging}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'integration'
  - 'infra'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:production,feature_name:attribution}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'attribution'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-oppty-scoring-heavy
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-oppty-scoring-heavy:runtime,type:oppty-scoring-training-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:production,feature_name:core-fetcher,pod:pod00}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n\
    {{/is_no_data_recovery}} \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage\
    \ back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Sys] [Mongo] %
    Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:lead-scoring,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Pardot-Fetcher] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:integration,feature_name:pardot-fetcher}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'pardot-fetcher'
  - 'env:integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:pilot-staging,feature_name:engagement-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [All] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'cross-features'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] Mongo % Cache
    usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:integration}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:integration}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:integration'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}No swap configured for\
    \ {{host.name}}{{/is_alert}}\n{{#is_alert_recovery}}Swap now configured for {{host.name}}{{/is_alert_recovery}}\
    \ \n@slack-dd-data-tests"
  'multi': true
  'name': '[Data-tests] No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,!type:jungle,!type:services,!environment:staging-saws}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'

- 'message': "{{#is_alert}}\n@slack-dd-prod \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-prod \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production,feature_name:orca}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Oppcasting] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:oppcasting,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:attribution,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'attribution'

- 'message': '.'
  'name': '[Staging] [All] [Infra] Integration -
    Pushed data from All to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:pilot-staging}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [Core-Fetcher] [Infra] AWS
    Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-cf-data-tests}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'core-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Campaign-Insights] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:production,rabbitmq_vhost:campaign-insights}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'campaign-insights'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}} \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Mongo Queue ]  Queued write
    requests'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{type:mongo,environment:pilot-staging}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:pilot-staging,type:mongo,feature_name:lead-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': '.'
  'name': '[Data-tests] [Pardot-Fetcher] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-pf-data-tests}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Oppcasting] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:production,rabbitmq_vhost:oppcasting}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'oppcasting'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Containers] [Campaign Insights]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:pilot-staging,feature_name:campaign-insights,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'containers'
  - 'anomaly'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:pilot-staging,type:mongo,feature_name:lead-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Cursor]
    Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:integration,type:mongo}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration,feature_name:attribution}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'attribution'
  - 'mongo'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] Zookeeper
    Number of queued requests in the server: {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 10.0
      'warning': 8.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.outstanding_requests{environment:production}
    by {name} > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': '---PRODUCTION---

    Redis - CPU Usage is over 80% for more than 4 hours

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```'
  'multi': true
  'name': '[Bnbo] [prod] [Redis] CPU Usage'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      Redis - CPU Usage is over 80% for more than 4 hours

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```'
    'evaluation_delay': 586
    'include_tags': false
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 80.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:aws.elasticache.cpuutilization{replication_group:b-redis-production}
    by {name} > 80'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'redis'
  - 'sys'
  - 'cpu'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Data-tests] [sys] [All] Clock in sync
    with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'cross-features'
  'type': 'service check'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [app] MongoDB
    Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'cross-features'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Sys] [Mongo]  No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Fault
    Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:production,feature_name:attribution}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}} @pagerduty-Ofek-Datadog"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Tickets - Threads
    Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:production,type:mongo}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'

- 'message': '.'
  'name': '[Data-tests] [Lead-Scoring] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:data-tests,feature_name:lead-scoring}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'lead-scoring'
  - 'env:data-tests'
  - 'infra'
  'type': 'query alert'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [voice-call-download]
    [SQS]: Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-voice-call-download}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo,feature_name:attribution}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': '@peisendorf@salesforce.com'
  'name': '11111'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'renotify_interval': 0
  'query': '15695250 || 15695354 || 15695388'
  'restricted_roles': null
  'type': 'composite'

- 'message': "{{#is_alert}}\n\n \n\n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:campaign-insights,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:integration,feature_name:core-fetcher,pod:pod01}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring-worker in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppty-scoring-worker:runtime,type:oppcasting-service}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': '.'
  'name': '[Integration] [Campaign-Insights] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:integration,rabbitmq_vhost:campaign-insights}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'campaign-insights'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:integration,feature_name:campaign-insights}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Staging] [Lead-Scoring] [Infra] Integration
    - Fetched data core to Lead-Scoring'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:pilot-staging,feature_name:lead-scoring},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'lead-scoring'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:data-tests,type:mongo,feature_name:core-fetcher}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Offline-Jobs] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:offline-jobs,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Data-tests] [App] [Pardot-Fetcher] Failed
    Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:data-tests,feature_name:pardot-fetcher,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'pardot-fetcher'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:pilot-staging,feature_name:engagement-scoring}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Prod] [Lead-Scoring] [Infra] Integration
    - Pushed data from Lead-Scoring to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:production,feature_name:lead-scoring}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'lead-scoring'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Sys]
    [Mongo]  Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:engagement-scoring,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:data-tests,feature_name:pardot-fetcher}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:data-tests,feature_name:pardot-fetcher}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:data-tests'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:pilot-staging,feature_name:pardot-fetcher}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:integration,feature_name:lead-scoring}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:integration,feature_name:lead-scoring}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:integration'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94  \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}}  \n{{/is_warning}}\n\n{{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}}\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}} \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [app] Mongo % Cache usage -
    Average 12H'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.9
    'timeout_h': 0
  'query': 'avg(last_4h):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for oppcasting-main-cycle in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 30.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/oppcasting-main-cycle:runtime,type:oppcasting-tenant-cycle}
    by {host} < 30'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:production,feature_name:campaign-insights}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'campaign-insights'
  - 'mongo'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:integration,feature_name:core-fetcher,pod:pod01}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'mongo'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Queue]  Queued
    read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo,feature_name:orca}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': '{{value}}'
  'name': '[Prod] [Canary] [Pod00] [App] [Pardot-Fetcher]
    [SEV0] Pardot-Fetcher Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:pardot-fetcher,canary:true,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'canary'
  - 'pardot-fetcher'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo,feature_name:attribution}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging,feature_name:oppcasting}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'oppcasting'
  - 'mongo'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Sys] [Mongo]  % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests,feature_name:engagement-scoring}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:data-tests'
  - 'engagement-scoring'
  - 'mongo'

- 'message': '.}'
  'name': '[Prod] [All] [Infra] Fetcher - Pardot
    Fetch - Objects'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_1d):avg:pardot.fetch_records{environment:production}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'integration'
  - 'infra'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:integration,feature_name:pardot-fetcher}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'pardot-fetcher'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring-heavy in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,type:oppcasting-training,implisit_service:implisit/celery-oppty-scoring-heavy:runtime,environment:integration}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Queue]  Queued
    write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo,feature_name:attribution}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:data-tests,type:mongo,feature_name:pardot-fetcher}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging,feature_name:attribution}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging,feature_name:engagement-scoring}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'engagement-scoring'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:data-tests-dev,feature_name:oppcasting}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'oppcasting'
  - 'env:data-tests-dev'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [sys] [Core-Fetcher]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n@slack-dd-prod\
      \ \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-prod \n\
      {{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo,feature_name:campaign-insights}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n{{#is_alert}} \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}} \n\
    {{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] MongoDB is down
    on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'cross-features'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:data-tests,feature_name:orca}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'orca'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests-dev,feature_name:oppcasting,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'mongo'
  - 'status'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Engagement-Scoring] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:engagement-scoring,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:production,feature_name:engagement-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:integration,feature_name:attribution}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': '.'
  'name': '[Data-tests] [Core-Fetcher] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:data-tests,rabbitmq_vhost:corefetcher}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'core-fetcher'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}  \n{{/is_alert}} \n\n\
    {{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}  \n\
    {{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [sys] [Core-Fetcher] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:lead-scoring,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'lead-scoring'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo","feature_name:pardot-fetcher").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'service check'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [sys] [Offline Jobs] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration","feature_name:offline-jobs").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'offline-jobs'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:data-tests,feature_name:campaign-insights}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo,feature_name:pardot-fetcher}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod01,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Attribution] Number
    of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{implisit_service:implisit/celery-beat:runtime,feature_name:attribution,type:attribution-celery-beat,environment:production}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'attribution'
  - 'env:production'

- 'message': '.'
  'name': '[Staging] [Lead-Scoring] [Infra] AWS
    Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-ls-staging-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:lead-scoring,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'lead-scoring'

- 'message': '.'
  'name': '[Prod] [Pod01] [App] [Oppcasting] [SEV1]
    Oppcasting Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 400.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:oppcasting,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'app'
  - 'sev1'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:lead-scoring,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo","feature_name:oppcasting").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'oppcasting'
  'type': 'service check'

- 'message': '.'
  'name': '[Prod] [Campaign-Insights] [Infra] AWS
    Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-ci-production-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '---PRODUCTION---

    {{host.base_name}} - Storage Usage is over 80% for more than 4 hours


    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)'
  'multi': true
  'name': '[Bnbo] [prod] [K8S] Storage Usage'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      {{host.base_name}} - Storage Usage is over 80% for more than 4 hours


      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)'
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': true
    'thresholds':
      'critical': 80.0
    'timeout_h': 0
  'query': 'avg(last_4h):max:system.disk.in_use{env:production,kubernetes_name_space:bonobo}
    by {host} * 100 > 80'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'kubernetes'
  - 'sys'
  - 'storage'
  'type': 'query alert'

- 'message': '. @slack-sev0-1'
  'name': '[Prod] [Pod01] [App] [Oppcasting] [SEV0]
    Oppcasting Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:oppcasting,canary:false,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:integration,type:mongo,feature_name:lead-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] Zookeeper nodes
    number'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.nodes{environment:pilot-staging}
    by {name} < 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n@pagerduty-Ofek-Datadog \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n{{host.name}}: Low usable swap disk: {{value}}  \n \n{{/is_no_data}}\
    \ \n\n{{#is_recovery}}\n{{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\
    \n{{#is_no_data_recovery}}\n{{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Sys] [Mongo]  % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Sys] [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'cross-features'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [All] [Infra] Integration - Pushed
    data from All to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:production}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:pardot-fetcher,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for campaign-insights
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:campaign-insights,implisit_service:implisit/campaign-insights:runtime,type:campaign-insights-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}   \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}   \n{{/is_no_data}} \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal  \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again  \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Sys] [Mongo] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging,feature_name:campaign-insights}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging][Attribution] Number of containers
    for attribution-tenant-cycle in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:pilot-staging,feature_name:attribution,implisit_service:implisit/attribution-tenant-cycle:runtime,type:attribution}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Orca] Number of
    containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-pusher:runtime,type:pusher}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:data-tests,type:mongo,feature_name:attribution}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:production,type:mongo,feature_name:engagement-scoring}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] RabbitMQ on {{host.name}}
    is down or {{vhost.name}} doesn''t exist.'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
    'timeout_h': 0
  'query': '"rabbitmq.aliveness".over("environment:pilot-staging").by("host","vhost").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'rabbitMQ'
  - 'infra'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Pardot Fetcher]
    Number of containers for pardot-fetcher-cycle in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,implisit_service:implisit/pardot-fetcher-cycle:runtime,feature_name:pardot-fetcher,type:pardot-fetcher-main}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n \n{{value}} \n\
    {{/is_alert}} \n\n\n{{#is_recovery}}\n \n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Handles]
    WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo,feature_name:attribution}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n@slack-dd-p-staging-sys \n{{/is_no_data}}\
    \ \n\n{{#is_no_data_recovery}}\n@slack-dd-p-staging-sys \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{feature_name:orca,environment:pilot-staging}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'env:pilot-staging'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for celery-forecast-subworker in {{host.name}}
    is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-forecast-subworker:runtime,type:oppcasting-forecasting-canary}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Lead-Scoring] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:lead-scoring,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Campaign-Insights]
    Disk space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:campaign-insights,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-beat:runtime,type:oppcasting-celery-beat,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging,feature_name:lead-scoring}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': '.'
  'name': '[Data-tests] [Engagement-Scoring] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:data-tests,rabbitmq_vhost:engagement-scoring}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'engagement-scoring'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}} \n@peisendorf@salesforce.com\
    \  \nNo Cycles in pilot-staging in the last hour.\n{{value}}\n{{/is_alert}}\n\n\
    {{#is_no_data}} \n@slack-dd-p-staging-app \nNo Cycles in pilot-staging in the\
    \ last hour.\n{{/is_no_data}} \n\n{{#is_warning}}\nNo Cycles on pilot-staging\
    \ in the last hour.\n# of cycles in the past hour: {{value}}\n{{/is_warning}}"
  'name': '[p-staging] [app] No Cycles in the last
    hour.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_30m):sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}} @pagerduty-Ofek-Datadog"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Queue] Queued
    read requests'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [All] % Usable Memory
    on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [All] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Sys]
    [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:data-tests,type:mongo,feature_name:core-fetcher}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:production,type:mongo,feature_name:campaign-insights}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Sys] [Mongo] Disk space
    is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:orca,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'orca'
  'type': 'query alert'

- 'message': "Value: {{value}} < {{threshold}} \n\
    @pagerduty-Ofek-Datadog @slack-org-62"
  'name': '[Prod] [Orca] Full Cycle Count Last 24H
    (Mongo3 - Org62) < 1'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1d):sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,mongo:mongo-3.vpc-internal}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'pagerduty'
  - 'env:production'
  - 'orca'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Oppcasting] No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:oppcasting,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:integration,feature_name:oppcasting}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'oppcasting'
  - 'env:integration'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:orca,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:integration,feature_name:pardot-fetcher}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Queue]
    Queued write requests'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Connections]
    Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:integration,type:mongo}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] Zookeeper
    (Only exposed by the leader) number of pending syncs from the followers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
      'warning': 8.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.pending_syncs{environment:data-tests}
    by {name} > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}} \n\
    {{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Orca] Disk space is
    low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:orca,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Pardot-Fetcher] %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:pardot-fetcher,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Connections]
    Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:integration,type:mongo}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:data-tests,feature_name:engagement-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Connections]
    Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:integration,feature_name:orca}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': ''
  'name': '[Staging] [Pod00] [App] [Orca] [SEV0]
    Orca Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging,feature_name:orca,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'orca'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for lead-scoring-training-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/lead-scoring-training-cycle:runtime,type:lead-scoring-training-cycle}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-lead-scoring-training
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 30
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-training:runtime,type:lead-scoring-training-worker}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:data-tests,feature_name:attribution}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'attribution'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:integration,feature_name:core-fetcher,pod:pod00}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests-dev,feature_name:oppcasting,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Pod00] [App] [Orca] [SEV1] Orca
    Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 400.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:orca,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'orca'
  - 'pod00'
  - 'app'
  - 'sev1'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:data-tests,type:mongo,feature_name:campaign-insights}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:pilot-staging,feature_name:attribution}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:pilot-staging,feature_name:lead-scoring}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Orca] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:orca,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'orca'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on\
    \ {{host.name}} is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] Mongo %
    Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:production,feature_name:attribution}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:production,feature_name:attribution}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:production'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:integration,feature_name:core-fetcher,pod:pod01}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'env:integration'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Integration] [Pod00] [App] [Engagement-Scoring]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:integration,feature_name:engagement-scoring,!sfenv:stmp1}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'engagement-scoring'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:campaign-insights,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:data-tests,type:mongo,feature_name:attribution}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] RabbitMQ node
    memory usage'
  'options':
    'escalation_message': 'RabbitMQ node memory
      consumption still very high on {{host.name}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 240
    'require_full_window': true
    'thresholds':
      'critical': 35.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'min(last_1h):avg:rabbitmq.node.mem_used{environment:data-tests}
    by {host} / avg:system.mem.total{environment:data-tests} by {host} * 100 > 35'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}\n\n@slack-dd-perf-app"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] MongoDB Replica
    with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [sys] [Oppcasting] %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests-dev,feature_name:oppcasting,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'sys'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for predictor
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/predictor:runtime,type:predictor}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [sys] [All] Clock in sync
    with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'cross-features'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Connections]
    Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:production,type:mongo,feature_name:oppcasting}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': ''
  'name': '[Integration] [Pod00] [App] [Attribution]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:integration,feature_name:attribution,!sfenv:stmp1}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'attribution'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Sys] [Mongo] %
    CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:attribution,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Campaign Insights]
    Number of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:campaign-insights,implisit_service:implisit/celery-system-alerts:runtime,type:campaign-insights-pusher-canary}
    by {host,implisit_service} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'campaign-insights'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Orca] Number of
    containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,type:fetcher,implisit_service:implisit/celery-system-alerts:runtime}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files\n \n {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production,feature_name:core-fetcher,pod:pod01}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-crunch-tasks
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/celery-crunch-tasks:runtime,type:orca-crunch-tasks,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for oppty-training-cycle-large in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,type:oppcasting-training,implisit_service:implisit/oppty-training-cycle-large:runtime}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Containers] [Pardot Fetcher]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:production,feature_name:pardot-fetcher,!implisit_service:implisit/poststop:runtime,!implisit_service:implisit/prestart:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'containers'
  - 'anomaly'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:integration,feature_name:engagement-scoring}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for oppty-scoring-training-cycle-small
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/oppty-scoring-training-cycle-small:runtime,type:oppty-scoring-training,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Connections]
    Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:data-tests,type:mongo}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n@pagerduty-Ofek-Datadog\
    \ \n{{/is_alert}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Sys] [Mongo]  Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [All] % Usable Memory
    on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:production,type:mongo,feature_name:lead-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}Disk space is low on\
    \ {{host.name}} {{/is_alert}} \n{{#is_recovery}}Disk space back to normal on {{host.name}}\
    \ {{device.name}} {{/is_recovery}} \n@slack-dd-p-staging-sys"
  'multi': true
  'name': '[p-staging] [sys] Disk space is low on
    {{host.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - [Pilot-staging] )

      @slack-dd-p-staging-sys'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 0.8
    'timeout_h': 0
  'query': 'avg(last_10m):avg:system.disk.in_use{environment:pilot-staging,!device:shm,!device:tmpfs,!device:rootfs}
    by {device,host} >= 0.8'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files\n \n {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [app] MongoDB
    has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production,feature_name:lead-scoring}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}} MongoDB on {{host.name}}\
    \ has too many open files\n@pagerduty-Ofek-Datadog \n{{/is_alert}}\n\n{{#is_alert_recovery}}\
    \ MongoDB on {{host.name}} open files use has decreased \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] MongoDB has too
    many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Attribution] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:attribution,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on\
    \ {{host.name}} is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:production,feature_name:pardot-fetcher}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:production,feature_name:pardot-fetcher}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:production'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Attribution] Number
    of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:attribution,implisit_service:implisit/celery-system-alerts:runtime,type:attribution-pusher-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] Mongo % Cache
    usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging,feature_name:orca}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging,feature_name:orca}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:pilot-staging'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Offline-Jobs] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:offline-jobs,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'offline-jobs'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [sys] [Campaign-Insights]
    Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration","feature_name:campaign-insights").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'campaign-insights'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Prod] [Pod01] [App] [Core-Fetcher] Failed
    Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:production,feature_name:core-fetcher,pod:pod01,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) > 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  for over 4 hours\n{{/is_alert}} \n\n\n{{#is_no_data}}\n\
    {{host.name}}  - {{host.ip}} didn't report CPU for 60 minutes \n{{/is_no_data}}\
    \ \n @slack-bot-datadog-build"
  'multi': true
  'name': '[Build] [sys] Slave % CPU'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 90.0
    'timeout_h': 1
  'query': 'min(last_4h):max:system.cpu.user{environment:build,type:jenkins-slave}
    by {host} + max:system.cpu.system{environment:build,type:jenkins-slave} by {host}
    > 90'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:build'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] Zookeeper integration
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 2
    'renotify_interval': 20
    'thresholds':
      'critical': 3
    'timeout_h': 0
  'query': '"zookeeper.ruok".over("environment:production").by("host","port").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'
  'type': 'service check'

- 'message': '.'
  'name': '[Staging] [Orca] [Infra] Celery - Count
    celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:pilot-staging,feature_name:orca}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'orca'
  - 'env:pilot-staging'
  - 'infra'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests","process:mongo","feature_name:core-fetcher").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'core-fetcher'
  'type': 'service check'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:integration,feature_name:core-fetcher,pod:pod01}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:integration,feature_name:core-fetcher,pod:pod01}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Orca] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-orca-pilot-staging}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:production,type:mongo,feature_name:campaign-insights}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,implisit_service:implisit/celery-worker:runtime,feature_name:orca,type:orca-worker-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:core-fetcher,pod:pod00}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration,feature_name:attribution}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': '---PRODUCTION---

    {{host.base_name}} - memory usage is over 80% for more than 4 hours


    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)'
  'multi': true
  'name': '[Bnbo] [prod] [K8S] Memory Usage'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      {{host.base_name}} - memory usage is over 80% for more than 4 hours


      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)'
    'include_tags': true
    'locked': true
    'new_host_delay': 7200
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 80.0
    'timeout_h': 0
  'query': 'avg(last_4h):max:kubernetes.memory.usage_pct{env:production,kubernetes_name_space:bonobo}
    by {host} > 80'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'kubernetes'
  - 'sys'
  - 'memory'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Integration] [Pod00] [App] [Core-Fetcher]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:integration,feature_name:core-fetcher,pod:pod00,!sfenv:stmp1}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Sys] [Mongo] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:core-fetcher,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'core-fetcher'

- 'message': '.'
  'name': '[Integration] [Orca] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-orca-integration}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n\n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:pardot-fetcher,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:production,type:mongo,feature_name:pardot-fetcher}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:oppcasting,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-forecast
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-forecast:runtime,type:forecasting}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': ''
  'name': '[Integration] [Pod00] [App] [Lead-Scoring]
    [SEV0] Lead-Scoring Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:integration,feature_name:lead-scoring,!sfenv:stmp1}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'lead-scoring'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [Campaign-Insights] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:data-tests,rabbitmq_vhost:campaign-insights}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'campaign-insights'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': '@eskop@salesforce.com @adahan@salesforce.com
    @ndayan@salesforce.com @slack-bot-lead-scoring-prod-runtime'
  'name': 'GM Disablement/Opt-out Deletion SLA breach!'
  'options':
    'escalation_message': '@slack-lead-scoring @slack-ls-production-runtime
      @eskop@salesforce.com @adahan@salesforce.com @ndayan@salesforce.com'
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 1440
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1d):avg:orca.orca.celery_task.services.periodic_tasks.periodic_tasks.cleanup_global_model_db.time.count{env:production}.as_count()
    < 1'
  'restricted_roles': null
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n\n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Sys] [Mongo] Disk space
    is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:orca,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': '@slack-bot-datadog-assessor'
  'name': '[Synthetics] Assessor - check if file
    uploaded'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
  'query': 'no_query'
  'restricted_roles': null
  'tags':
  - 'probe_dc:aws:us-east-2'
  - 'check_type:browser'
  - 'check_status:live'
  'type': 'synthetics alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Handles]
    WT caches open file handles in memory,'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-b2b-marketing-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/celery-b2b-marketing-worker:runtime,type:engagement-scoring-worker-canary}
    by {host} < 3'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Connections]
    Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:pilot-staging,feature_name:orca}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Pardot-Fetcher] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:pardot-fetcher,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Sys] [Mongo]  No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:core-fetcher,!type:jungle,type:mongo,pod:pod01}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:integration,type:mongo,feature_name:attribution}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:production,type:mongo,feature_name:lead-scoring}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': '.'
  'name': '[Prod] [Pod00] [App] [Engagement-Scoring]
    [SEV1] Engagement-Scoring Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 60.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:engagement-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 60'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'engagement-scoring'
  - 'pod00'
  - 'app'
  - 'sev1'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Lead-Scoring] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-ls-integ-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for oppty-training-cycle-small in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/oppty-training-cycle-small:runtime,type:oppcasting-training,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Data-tests] [sys] [Core-Fetcher] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests","feature_name:core-fetcher").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:attribution,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo,feature_name:campaign-insights}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Prod] [Pardot Fetcher] [SEV2] - Number
    of errors is higher than 1000'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.log.ERROR{environment:production,feature_name:pardot-fetcher}.as_count(),
    0) >= 1000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sev2'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    \n{{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Orca] Number of
    containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-pusher:runtime,type:pushers-canary}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-core-fetcher
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:core-fetcher,type:core-fetcher,implisit_service:implisit/celery-core-fetcher:runtime}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'core-fetcher'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [sys] [Pardot-Fetcher] Clock in
    sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production","feature_name:pardot-fetcher").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'pardot-fetcher'
  'type': 'service check'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:pilot-staging,feature_name:campaign-insights}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'campaign-insights'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-oppty-scoring-heavy
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,type:oppty-scoring-training,implisit_service:implisit/celery-oppty-scoring-heavy:runtime,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Containers] [Oppcasting]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{feature_name:oppcasting,environment:integration,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'anomaly'
  - 'env:integration'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Attribution] [Infra] AWS
    Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-at-integ-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:pilot-staging,type:mongo,feature_name:lead-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:integration,feature_name:pardot-fetcher}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Integration] [Oppcasting] [Infra] Integration
    - Pushed data from Oppcasting to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:integration,feature_name:oppcasting}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'oppcasting'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Orca] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-orca-data-tests}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Orca] % Usable Memory
    on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:orca,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Oppcasting] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-oc-staging-pod01}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on\
    \ {{host.name}} is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:production,feature_name:core-fetcher,pod:pod01}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:production,feature_name:core-fetcher,pod:pod01}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Containers] [Lead Scoring] Number
    of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_10m'
      'trigger_window': 'last_5m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_1h):anomalies(sum:docker.containers.running{environment:production,feature_name:lead-scoring,!implisit_service:implisit/poststop:runtime,!implisit_service:implisit/prestart:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_5m'',
    interval=20, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'lead-scoring'
  - 'env:production'
  - 'containers'
  - 'anomaly'
  'type': 'query alert'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [Production] [organization-data-sync]
    [SQS]: Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'critical_recovery': 800.0
      'warning': 1300.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:production-conv-ai-organization-data-sync}
    > 2000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  'type': 'query alert'

- 'message': '123'
  'multi': true
  'name': 'Slave 4'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'min(last_1m):default(sum:docker.containers.running{type:jenkins-slave,instance-type:c5.4xlarge,docker_image:187473451979.dkr.ecr.us-west-2.amazonaws.com/jenkins-slave:20190512t110335_2c2d30c7}
    by {host,instance-type},0) > 0'
  'restricted_roles': null
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:production,type:mongo,feature_name:pardot-fetcher}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Data-tests] [Orca] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-orca-data-tests}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Core-Fetcher] [Pod01] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:pilot-staging,rabbitmq_vhost:corefetcher,pod:pod01}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] Zookeeper
    integration is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 2
    'renotify_interval': 20
    'thresholds':
      'critical': 3
    'timeout_h': 0
  'query': '"zookeeper.ruok".over("environment:integration").by("host","port").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Offline Jobs] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:offline-jobs,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:pilot-staging,type:mongo,feature_name:attribution}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [sys] [Core-Fetcher]
    Load average (norm.15)'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [Pod01] [sys] [Core-Fetcher] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production","feature_name:core-fetcher","pod:pod01").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod01'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n@gmoscovitch@salesforce.com\
    \ \n\n{{/is_alert}} \n\n{{#is_recovery}}\n@gmoscovitch@salesforce.com \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] Email processing connectivity
    test'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 2
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"jenkins.job.status".over("host:impl-jenkins-prod","job:tests/connectivity_tests_runner_production_email_pocessing").last(2).count_by_status()'
  'restricted_roles': null
  'type': 'service check'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Oppcasting] % Usable Swap
    Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:oppcasting,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'oppcasting'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-ci-staging-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': '.'
  'name': '[Data-tests] [Pardot-Fetcher] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:data-tests,rabbitmq_vhost:pardot-fetcher}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'pardot-fetcher'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:lead-scoring,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Queue]  Queued
    write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo,feature_name:oppcasting}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Attribution] % Usable Memory
    on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:attribution,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': ''
  'name': '[Integration] [App] [All] [SEV0] All
    Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:integration,!sfenv:stmp1}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-es-integ-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:data-tests,feature_name:pardot-fetcher}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo,feature_name:pardot-fetcher}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n \n{{value}} \n\
    {{/is_alert}} \n\n\n{{#is_recovery}}\n \n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:orca,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:integration,feature_name:engagement-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}} @pagerduty-Ofek-Datadog"
  'multi': true
  'name': '[Prod] [Mongo Cursor] [All] Open Cursors'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration,feature_name:core-fetcher,pod:pod00}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo,feature_name:engagement-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:data-tests,type:mongo,feature_name:core-fetcher}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Connections]
    Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:production,type:mongo,feature_name:attribution}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Lead-Scoring] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:lead-scoring,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [All] Disk space is
    low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests-dev] [Oppcasting] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-oc-dt-dev}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Sys] [Mongo] Disk space
    is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'cross-features'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [sys] [Oppcasting] Clock in
    sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging","feature_name:oppcasting").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'oppcasting'
  'type': 'service check'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}   \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}   \n{{/is_no_data}} \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal  \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again  \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Sys] [Mongo] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Sys]
    [Mongo] % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:engagement-scoring,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:data-tests,feature_name:core-fetcher}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'core-fetcher'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Offline Jobs] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:offline-jobs,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:data-tests,feature_name:core-fetcher}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:data-tests,feature_name:core-fetcher}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:data-tests'
  - 'core-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:integration,type:mongo,feature_name:campaign-insights}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Orca] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:orca,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'orca'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-oppty-scoring-light
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,type:oppty-scoring-training,implisit_service:implisit/celery-oppty-scoring-light:runtime}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Engagement-Scoring]
    % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:engagement-scoring,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Lead-Scoring] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:lead-scoring,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Lead-Scoring] No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:lead-scoring,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'lead-scoring'

- 'message': '.'
  'name': '[Data-tests] [Attribution] [Infra] AWS
    Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-at-data-tests}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n\
    {{/is_no_data_recovery}} \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage\
    \ back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:engagement-scoring,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}\n\n@slack-dd-perf-app"
  'multi': true
  'name': '[Perf] [app] MongoDB Replica with lag
    dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:performance}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:performance'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production,feature_name:engagement-scoring}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'engagement-scoring'
  - 'mongo'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Containers] [Attribution]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:pilot-staging,feature_name:attribution,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'containers'
  - 'anomaly'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for celery-oppty-scoring-heavy in {{host.name}}
    is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppty-scoring-heavy:runtime,type:oppcasting-training-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Prod] [All] [Mongo] {{host.name}} oplog
    window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:production}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Orca] % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:orca,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'orca'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] Zookeeper latency'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10000.0
      'warning': 7000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.latency.max{environment:pilot-staging}
    by {name} > 10000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': '.'
  'name': '[Integration] [Lead-Scoring] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:integration,feature_name:lead-scoring}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'lead-scoring'
  - 'env:integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:integration,type:mongo,feature_name:engagement-scoring}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Sys]
    [Mongo] % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Sys] [Mongo] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'cross-features'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [sys] [Engagement-Scoring]
    Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration","feature_name:engagement-scoring").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'engagement-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:orca,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'status'
  - 'orca'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:engagement-scoring,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'

- 'message': ''
  'name': '[Data-tests] [App] [Attribution] [SEV0]
    Attribution Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:data-tests,feature_name:attribution,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'attribution'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [sys] [Orca] Clock in sync
    with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging","feature_name:orca").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'orca'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Pardot-Fetcher] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:pardot-fetcher,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '--pilot-staging--

    {{host.base_name}} - RMQ no connections fo more than 2 hours

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-pilot-staging

    - @bonobo_dev@salesforce.com

    ```'
  'multi': true
  'name': '[Bnbo] [stag] [RMQ] Connections'
  'options':
    'escalation_message': '***Renotifying***

      --pilot-staging--

      {{host.base_name}} - RMQ no connections fo more than 2 hours

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-pilot-staging

      - @bonobo_dev@salesforce.com

      ```'
    'evaluation_delay': 590
    'include_tags': true
    'locked': true
    'new_host_delay': 3200
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'avg(last_2h):avg:rabbitmq.connections{inst_type:docker-services-bonobo,env:pilot-staging}
    by {host} < 1'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'rabbitmq'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n\n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:attribution,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [app] MongoDB
    has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-ls-production-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-forecast-subworker in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,type:oppcasting-forecasting,implisit_service:implisit/celery-forecast-subworker:runtime,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:lead-scoring,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n@pagerduty-Ofek-Datadog\n\
    {{/is_alert}} \n\n{{#is_recovery}}\n \n@pagerduty-Ofek-Datadog\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [App] [All] Failed Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:production,!sfenv:stmp1,!sfenv:stmp2}
    by {feature_name}.as_count(), 0) > 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'app'
  - 'status'
  - 'pagerduty'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Engagement-Scoring]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:engagement-scoring,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n{{/is_alert}}  \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal \n{{/is_recovery}}  \n@slack-dd-perf-sys"
  'multi': true
  'name': '[Perf] [sys] % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-perf-sys'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 30
    'notify_audit': true
    'renotify_interval': 20
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_10m):min:system.swap.pct_free{environment:performance}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:performance'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:integration,feature_name:lead-scoring}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Core-Fetcher] [Pod01] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-cf-prod-pod01}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:attribution,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': '{{value}}'
  'multi': true
  'name': '[staging-test] RabbitMQ - Bonobo - Messages
    waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{env:pilot-staging,rabbitmq_vhost:celery_ai}
    by {rabbitmq_node} > 3'
  'restricted_roles': null
  'tags':
  - 'infra'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:pilot-staging,feature_name:campaign-insights}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n@pagerduty-Ofek-Datadog\
    \ \n{{value}} \n{{/is_alert}} \n\n\n{{#is_recovery}}\n \n@pagerduty-Ofek-Datadog\
    \ \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Handles]
    WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:production,type:mongo,feature_name:engagement-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-core-fetcher
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:core-fetcher,implisit_service:implisit/celery-core-fetcher:runtime,type:core-fetcher-canary}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'core-fetcher'

- 'message': '.'
  'name': '[Integration] [Core-Fetcher] [Pod01]
    [Infra] Integration - Fetched data core to Core-Fetcher'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:integration,feature_name:core-fetcher,pod:pod01},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Canary] [App] [All] [SEV0] All
    Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,canary:true,!sfenv:stmp1,!sfenv:stmp2}
    by {feature_name}.as_count(), 0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'canary'
  - 'cross-features'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:integration,type:mongo,feature_name:lead-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [sys] [Lead-Scoring] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration","feature_name:lead-scoring").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'lead-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Sys] [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:core-fetcher,type:mongo,pod:pod00,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Eng. Scoring]
    Number of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/celery-pusher:runtime,type:engagement-scoring-pusher-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Sys]
    [Mongo]  % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'

- 'message': '@slack-dd-prod'
  'multi': true
  'name': 'Unusual amount of warnings'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_10m'
      'trigger_window': 'last_1d'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_1w):anomalies(avg:orca.log.WARNING{env:production}
    by {feature_name}.as_count(), ''agile'', 2, direction=''above'', alert_window=''last_1d'',
    interval=3600, count_default_zero=''true'', seasonality=''daily'') >= 1'
  'restricted_roles': null
  'tags':
  - 'cross-features'
  - 'env:production'
  - 'warning'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:lead-scoring,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:data-tests,type:mongo,feature_name:attribution}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-lead-scoring-main
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-main:runtime,type:lead-scoring-main-service,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Queue]  Queued
    write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo,feature_name:orca}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:pilot-staging,feature_name:oppcasting}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:production,feature_name:lead-scoring}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': '@pagerduty-Ofek-Datadog

    @slack-dd-prod'
  'name': '[App] [Orca] Number Of Pushed Scores
    (<150 24H)'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 150.0
    'timeout_h': 0
  'query': 'sum(last_1d):avg:module.opptyscoring.pushing.processed{environment:production}.as_count()
    < 150'
  'restricted_roles': null
  'tags':
  - 'pagerduty'
  - 'env:production'
  - 'orca'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:data-tests,type:mongo,feature_name:lead-scoring}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:engagement-scoring,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-oppty-scoring-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,implisit_service:implisit/celery-oppty-scoring-worker:runtime,feature_name:orca,type:oppty-scoring-main-canary}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': ''
  'name': '[Staging] [Pod00] [App] [Attribution]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:pilot-staging,feature_name:attribution,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'attribution'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Sys] [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests,feature_name:engagement-scoring}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Staging] [Engagement-Scoring] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-es-staging-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Engagement-Scoring] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-es-integ-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Engagement-Scoring] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-es-staging-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': ''
  'name': '[Integration] [Pod01] [App] [Core-Fetcher]
    [SEV0] Core-Fetcher Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:integration,feature_name:core-fetcher,pod:pod01,!sfenv:stmp1}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files\n \n {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production,feature_name:core-fetcher,pod:pod00}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging][Attribution] Number of containers
    for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:pilot-staging,feature_name:attribution,implisit_service:implisit/celery-pusher:runtime,inst_type:docker-attribution-pusher}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:engagement-scoring,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for oppty-scoring-training-cycle-large
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/oppty-scoring-training-cycle-large:runtime,type:oppty-scoring-training,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration,feature_name:core-fetcher,pod:pod01}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'name': '[Staging] [All] [Infra] Slack service
    delayed messages'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
      'warning': 5.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(max:aws.sqs.approximate_number_of_messages_delayed{queuename:pilot-staging-slack-service.fifo},
    0) > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'infra'
  - 'slack'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Campaign-Insights]
    Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:campaign-insights,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'campaign-insights'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for lead-scoring-training-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/lead-scoring-training-cycle:runtime,type:lead-scoring-training-cycle-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:campaign-insights,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nLow Celery Tasks Count\n\
    @slack-dd-p-staging-sys \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    @slack-dd-p-staging-sys \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n@slack-dd-p-staging-sys \n{{/is_no_data_recovery}}"
  'name': '[Staging] Celery - Core-Fetcher - Count
    celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):max:orca.orca.celery_task.time.count{feature_name:core-fetcher,environment:pilot-staging}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'core-fetcher'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': '---PRODUCTION---

    There are stuck messages in the queue for more than 4 hours


    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)'
  'name': '[Bnbo] [prod] [SQS] Stuck Messages In
    Queue'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      There are stuck messages in the queue for more than 4 hours


      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)'
    'evaluation_delay': 600
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 0.9
    'timeout_h': 0
  'query': 'avg(last_4h):( avg:aws.sqs.number_of_messages_sent{queuename:production-conv-ai-speech-engine}.as_count()
    + 1 ) / ( avg:aws.sqs.number_of_messages_received{queuename:production-conv-ai-speech-engine}.as_count()
    + 1 ) < 0.9'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'SQS'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Engagement-Scoring] [Infra] Integration
    - Pushed data from Engagement-Scoring to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:production,feature_name:engagement-scoring}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'engagement-scoring'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:integration,type:mongo,feature_name:oppcasting}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': '.'
  'name': '[Staging] [Lead-Scoring] [Infra] Integration
    - Pushed data from Lead-Scoring to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:pilot-staging,feature_name:lead-scoring}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'lead-scoring'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Staging] [Pod00] [App] [Engagement-Scoring]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:pilot-staging,feature_name:engagement-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'engagement-scoring'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "System load average is high on {{host.name}}\
    \ \n\n@slack-dd-p-staging-sys"
  'multi': true
  'name': '[p-staging] [sys] Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.5
    'timeout_h': 0
  'query': 'avg(last_15m):avg:system.load.norm.15{environment:pilot-staging}
    by {host} > 1.5'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Lead Scoring]
    Number of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-system-alerts:runtime,type:lead-scoring-fetchers-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:oppcasting,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:orca,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo,feature_name:pardot-fetcher}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Integration] [Pardot-Fetcher] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-pf-integ-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for celery-oppty-scoring-worker in {{host.name}}
    is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppty-scoring-worker:runtime,type:oppcasting-service-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:attribution,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'attribution'

- 'message': '{{#is_alert}}

    Lead Scoring deployment pipeline Prod - Failure

    {{/is_alert}}'
  'multi': true
  'name': '[Prod] [Lead Scoring] System Test - Success/Failure'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"jenkins.job.status".over("host:impl-jenkins-production.pod00-CD","job:lead-scoring/production-pod00/system_test").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'app'
  - 'pipeline'
  - 'lead-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Lead Scoring]
    Number of containers in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:lead-scoring,implisit_service:implisit/lead-scoring-training-cycle:runtime,type:lead-scoring-training-cycle,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Sys]
    [Mongo]  % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:engagement-scoring,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:production,feature_name:campaign-insights}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n@pagerduty-Ofek-Datadog\
    \ \n{{/is_alert}} \n\n{{value}} \nThis monitor does not include Mongo instances\n\
    {{#is_recovery}}\n \n@pagerduty-Ofek-Datadog \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [All] Disk space is low
    on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'pagerduty'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:integration,type:mongo,feature_name:attribution}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging,feature_name:attribution}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'attribution'
  - 'mongo'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Containers] [Offline Jobs]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_5m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_1h):anomalies(sum:docker.containers.running{feature_name:offline-jobs,environment:integration,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_5m'',
    interval=20, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'anomaly'
  - 'offline-jobs'
  - 'env:integration'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Connections]
    Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:data-tests}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:production,feature_name:core-fetcher,pod:pod01}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'mongo'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [All] % Usable Swap
    Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'cross-features'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [All] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Eng. Scoring]
    Number of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:engagement-scoring,implisit_service:implisit/celery-pusher:runtime,type:engagement-scoring-pusher,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'engagement-scoring'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:pilot-staging,type:mongo,feature_name:engagement-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:integration,feature_name:core-fetcher,pod:pod00}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'cross-features'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] Celery - Count
    celery tasks'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
      'warning': 300.0
    'timeout_h': 0
  'query': 'sum(last_15m):avg:orca.orca.celery_task.time.count{env:pilot-staging}
    by {feature_name}.as_count() < 5'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'cross-features'
  - 'env:pilot-staging'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Queue]  Queued
    read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo,feature_name:orca}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] RabbitMQ
    FD use is high'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_5m):sum:rabbitmq.node.fd_used{environment:integration}
    by {host} > 15000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'rabbitMQ'
  - 'infra'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo","feature_name:attribution").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'attribution'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-lead-scoring-training
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-training:runtime,type:lead-scoring-training-worker-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [All] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'cross-features'

- 'message': '.'
  'name': '[Staging] [Core-Fetcher] [Pod00] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-cf-staging-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Lead-Scoring] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:lead-scoring,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:production,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': '.'
  'name': '[Prod] [Lead-Scoring] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:production,feature_name:lead-scoring}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'lead-scoring'
  - 'env:production'
  - 'infra'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [sys] [Attribution] Clock in
    sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging","feature_name:attribution").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'attribution'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:data-tests,feature_name:core-fetcher}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [sys] [Attribution] Clock in sync
    with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production","feature_name:attribution").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'attribution'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}} @pagerduty-Ofek-Datadog"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Queue]  Queued
    read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'

- 'message': ''
  'name': '[Data-tests] [App] [Orca] [SEV0] Orca
    Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:data-tests,feature_name:orca,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'orca'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Pardot-Fetcher] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:pardot-fetcher,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Fault
    Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:data-tests}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': '.'
  'name': '[Data-tests] [Pardot-Fetcher] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-pf-data-tests}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] Mongo % Cache
    usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:data-tests}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:data-tests}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:data-tests'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Attribution] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:attribution,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-lead-scoring-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-worker:runtime,type:lead-scoring-main-worker-canary}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Orca] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:orca,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': '--pilot-staging--

    SQS - Oldest message in the queue is older than 3 days

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```'
  'name': '[Bnbo] [stag] [SQS] oldest messages queue'
  'options':
    'escalation_message': '***Renotifying***

      --pilot-staging--

      SQS - Oldest message in the queue is older than 3 days

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```'
    'evaluation_delay': 600
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 259800.0
    'timeout_h': 0
  'query': 'sum(last_2h):max:aws.sqs.approximate_age_of_oldest_message{queuename:pilot-staging-conv-ai-speech-engine}
    > 259800'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'SQS'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:production,feature_name:core-fetcher,pod:pod01}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'name': 'test - tenant disable'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'sum(last_5m):avg:jungle.api.tenant.disable{*}.as_count()
    < 0'
  'restricted_roles': null
  'tags':
  - 'onboarding'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Engagement-Scoring]
    % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:engagement-scoring,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'engagement-scoring'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] Zookeeper nodes
    number'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.nodes{environment:production}
    by {name} < 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': '.'
  'name': '[Prod] [Pardot-Fetcher] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-pf-production-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Orca] [Infra] Integration
    - Fetched data core to Orca'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:pilot-staging,feature_name:orca},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'orca'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] RabbitMQ on {{host.name}}
    is down or {{vhost.name}} doesn''t exist.'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
    'timeout_h': 0
  'query': '"rabbitmq.aliveness".over("environment:production").exclude("pod:pod01","vhost:oppcasting").by("host","vhost").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'rabbitMQ'
  - 'infra'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Lead Scoring] Number
    of containers for celery-lead-scoring-worker in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-worker:runtime,type:lead-scoring-main-worker}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Lead-Scoring] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:lead-scoring,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Sys] [Mongo]  No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:core-fetcher,!type:jungle,type:mongo,pod:pod00}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'core-fetcher'
  - 'pod00'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests,feature_name:pardot-fetcher}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Offline Jobs] No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:offline-jobs,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'offline-jobs'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:integration,type:mongo,feature_name:pardot-fetcher}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}   \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}   \n{{/is_no_data}} \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal  \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again  \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Orca] % Usable Swap
    Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:orca,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:data-tests-dev,type:mongo,feature_name:oppcasting}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [sys] [Lead-Scoring] Clock in
    sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production","feature_name:lead-scoring").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'lead-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-b2b-marketing-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:engagement-scoring,implisit_service:implisit/celery-b2b-marketing-worker:runtime,type:engagement-scoring-worker,environment:pilot-staging}
    by {host} < 3'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'engagement-scoring'
  - 'env:pilot-staging'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [Production] [pusher] [SQS]:
    Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'critical_recovery': 800.0
      'warning': 1300.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:production-conv-ai-pusher}
    > 2000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for lead-scoring-tenant-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/lead-scoring-tenant-cycle:runtime,type:lead-scoring-tenant-cycle}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:production,feature_name:core-fetcher,pod:pod00}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Sys] [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:core-fetcher,pod:pod00,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [Attribution] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:data-tests,feature_name:attribution}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'attribution'
  - 'env:data-tests'
  - 'infra'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [app] MongoDB
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'cross-features'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:integration,feature_name:oppcasting}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'oppcasting'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:pilot-staging,type:mongo,feature_name:engagement-scoring}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Oppcasting] System test failure - Staging'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'sum(last_10m):default(sum:jenkins.job.duration{host:impl-jenkins-pilot-staging-CD,job:oppcasting/system_test,result:failure},
    0) > 0'
  'restricted_roles': null
  'tags':
  - 'Tests'
  - 'oppcasting'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:pardot-fetcher,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:engagement-scoring,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:lead-scoring,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}} \n\
    {{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [sys] [Core-Fetcher]
    Disk space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Offline-Jobs] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:offline-jobs,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'offline-jobs'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration,feature_name:pardot-fetcher}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'pardot-fetcher'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:production,type:mongo,feature_name:engagement-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Sys] [Mongo]  No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:orca,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'orca'

- 'message': '--pilot-staging--

    {{host.base_name}} - memory usage is over 80% for more than 4 hours

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-pilot-staging

    - @bonobo_dev@salesforce.com

    ```'
  'multi': true
  'name': '[Bnbo] [stag] [K8S] Memory Usage'
  'options':
    'escalation_message': '***Renotifying***

      --pilot-staging--

      {{host.base_name}} - memory usage is over 80% for more than 4 hours

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-pilot-staging

      - @bonobo_dev@salesforce.com

      ```'
    'include_tags': true
    'locked': true
    'new_host_delay': 7200
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 80.0
    'timeout_h': 0
  'query': 'avg(last_4h):max:kubernetes.memory.usage_pct{kubernetes_name_space:bonobo,env:pilot-staging}
    by {host} > 80'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'kubernetes'
  - 'sys'
  - 'memory'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging,feature_name:engagement-scoring}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging,feature_name:engagement-scoring}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:pilot-staging'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Lead-Scoring] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:lead-scoring,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [sys] [Oppcasting] No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests-dev,feature_name:oppcasting,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'sys'
  - 'status'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Orca] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n@slack-dd-prod\
      \ \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-prod \n\
      {{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:orca,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_no_data}} \n{{/is_no_data}} \n\n{{#is_no_data_recovery}} \n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}} \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [sys] [Core-Fetcher] %
    Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-prod'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-crunch-tasks
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-crunch-tasks:runtime,type:orca-crunch-tasks}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:data-tests,feature_name:attribution}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:integration,type:mongo,feature_name:engagement-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': '.'
  'multi': true
  'name': 'test - feature disable'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_5m):avg:jungle.api.feature.disable{*}
    by {core_feature}.as_count() < 1'
  'restricted_roles': null
  'tags':
  - 'onboarding'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Pod00] [App] [Attribution] [SEV1]
    Attribution Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:attribution,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 40'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'attribution'
  - 'pod00'
  - 'app'
  - 'sev1'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:data-tests,type:mongo,feature_name:pardot-fetcher}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Oppcasting] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:oppcasting,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Data-tests-dev] [App] [Oppcasting] Failed
    Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:data-tests-dev,feature_name:oppcasting,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'oppcasting'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': ''
  'name': '[Staging] [Pod00] [App] [Campaign-Insights]
    [SEV0] Campaign-Insights Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging,feature_name:campaign-insights,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'campaign-insights'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] Zookeeper (Only
    exposed by the leader) number of pending syncs from the followers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
      'warning': 8.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.pending_syncs{environment:pilot-staging}
    by {name} > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-pf-production-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo","feature_name:pardot-fetcher").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'service check'

- 'message': "{{#is_alert}}\n@\n{{/is_alert}} \n\
    \n{{#is_recovery}}\n@ \n{{/is_recovery}}"
  'name': '[Data-tests] [App] [Campaign-Insights]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:data-tests,feature_name:campaign-insights,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'campaign-insights'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:integration,feature_name:pardot-fetcher}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  - 'env:integration'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:production,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [sys] [Core-Fetcher]
    Load average (norm.15)'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:integration,type:mongo,feature_name:oppcasting}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Attribution] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:attribution,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Offline-Jobs] %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:offline-jobs,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'offline-jobs'

- 'message': '.'
  'name': '[Data-tests] [Campaign-Insights] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-ci-data-tests}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppty-scoring:runtime,type:oppcasting-worker,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:engagement-scoring,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Lead-Scoring] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:lead-scoring,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Sys]
    [Mongo]  Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:engagement-scoring,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n@pagerduty-Ofek-Datadog\
    \ \n{{/is_alert}} \n\n{{#is_no_data}}\n \n@pagerduty-Ofek-Datadog \n{{/is_no_data}}\
    \ \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Sys] [Mongo] % Usable Memory
    on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'cross-features'
  - 'pagerduty'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:data-tests,feature_name:lead-scoring}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:data-tests,feature_name:lead-scoring}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:data-tests'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{value}} \n\
    {{/is_alert}} \n\n\n{{#is_recovery}}\n \n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo,feature_name:engagement-scoring}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:orca,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'orca'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:pilot-staging,feature_name:engagement-scoring}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'engagement-scoring'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:integration,feature_name:core-fetcher,pod:pod01}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:integration,feature_name:lead-scoring}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  - 'env:integration'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Canary] [Containers] [Lead Scoring]
    Number of containers for gm-contribution-cycle in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/lead-scoring-gm-contribution-cycle:runtime,type:lead-scoring-gm-contribution-cycle-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'
  - 'canary'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:data-tests,type:mongo,feature_name:attribution}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:integration,type:mongo,feature_name:attribution}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:data-tests,type:mongo,feature_name:pardot-fetcher}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Data-tests] [Lead-Scoring] [Infra] AWS
    Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-ls-data-tests}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '---PRODUCTION---

    {{host.base_name}} - Load Average is over 2.5 for the last 4 hours

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```'
  'multi': true
  'name': '[Bnbo] [prod] [K8S] Load Average'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      {{host.base_name}} - Load Average is over 2.5 for the last 4 hours

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```'
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 2.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.5{env:production,kubernetes_name_space:bonobo}
    by {host} > 2.5'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'kubernetes'
  - 'sys'
  - 'cpu'
  'type': 'query alert'

- 'message': 'for testing - DD API testing to learn
    how to use DD API'
  'multi': true
  'name': '[Prod] [sys] Implisit Memory - Clusters
    Mongo - API [Karim]'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 30
    'require_full_window': true
    'thresholds':
      'critical': 0.15
      'warning': 0.25
    'timeout_h': 0
  'query': 'avg(last_30m):avg:system.mem.pct_usable{type:mongo,environment:production}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'sys'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:pilot-staging,feature_name:pardot-fetcher}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': '@slack-bot-datadog-assessor'
  'name': '[Synthetics] Assessor - delete file from
    org'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
  'query': 'no_query'
  'restricted_roles': null
  'tags':
  - 'probe_dc:aws:us-east-2'
  - 'check_type:browser'
  - 'check_status:live'
  'type': 'synthetics alert'

- 'message': ''
  'name': '[Data-tests] [App] [Campaign-Insights]
    [SEV0] Campaign-Insights Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:data-tests,feature_name:campaign-insights,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'campaign-insights'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:data-tests,type:mongo,feature_name:attribution}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Oppcasting] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:oppcasting,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Oppcasting] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:oppcasting,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'oppcasting'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:integration,feature_name:pardot-fetcher}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:integration,feature_name:pardot-fetcher}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:integration'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Oppcasting] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:pilot-staging,rabbitmq_vhost:oppcasting}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'oppcasting'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,environment:data-tests,feature_name:oppcasting}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Sys] [Mongo] %
    Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:orca,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Oppcasting] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-oc-staging-pod01}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [sys] [Offline Jobs] Clock in
    sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production","feature_name:offline-jobs").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'offline-jobs'
  'type': 'service check'

- 'message': '.'
  'name': '[Prod] [All] [Infra] RDS CPU High'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 80.0
      'warning': 70.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.rds.cpuutilization{name:jungle-production}
    > 80'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'infra'
  - 'rds'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Connections]
    Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:pilot-staging}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging,feature_name:core-fetcher,pod:pod01}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'env:pilot-staging'
  - 'pod01'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Data-tests] [All] [Mongo] MongoDB has
    too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': '.'
  'name': '[Integration] [All] [Infra] RDS Low Memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 20.0
    'timeout_h': 0
  'query': 'avg(last_30m):( avg:aws.rds.memory.free{name:jungle-integration}
    / avg:aws.rds.memory.total{name:jungle-integration} ) * 100 < 15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'infra'
  - 'rds'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Campaign-Insights]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:campaign-insights,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Sys] [Mongo] %
    CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:lead-scoring,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for tenant-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,implisit_service:implisit/tenant-cycle:runtime,feature_name:orca,type:orca-canary}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Sys] [Mongo]  Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:orca,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'orca'

- 'message': '.'
  'name': '[Prod] [Orca] [Infra] Integration - Pushed
    data from Orca to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:production,feature_name:orca}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'orca'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Offline Jobs] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:offline-jobs,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'offline-jobs'

- 'message': "{{#is_alert}}\n{{/is_alert}} \n\n\
    {{#is_alert_recovery}}\n{{/is_alert_recovery}}"
  'multi': true
  'name': 'Master is broken for over 30 minutes
    on {{job.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):max:jenkins.job.duration{host:jenkins-build,result:failure,branch_name:master,!feature:offline-jobs-service,!feature:identity-proxy}
    by {job}.as_count() >= 1'
  'restricted_roles': null
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Oppcasting] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:oppcasting,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'oppcasting'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files\n \n {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [app] MongoDB has
    too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production,feature_name:orca}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:pardot-fetcher,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests,feature_name:campaign-insights}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:pilot-staging,type:mongo,feature_name:attribution}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Attribution] [Infra] AWS
    Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-at-integ-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Orca] % Usable Swap
    Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:orca,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'orca'

- 'message': '{{#is_alert}}

    Oppcasting deployment pipeline Prod - Failure

    {{/is_alert}}'
  'multi': true
  'name': '[Prod] [Oppcasting] Deployment Pipeline
    - Success/Failure'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"jenkins.job.status".over("host:impl-jenkins-production.pod01-CD","job:oppcasting/production-pod01/pipeline").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'oppcasting'
  - 'env:production'
  - 'app'
  - 'pipeline'
  'type': 'service check'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Data-tests] [All] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:data-tests}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging,feature_name:attribution}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for campaign-insights
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:campaign-insights,implisit_service:implisit/celery-campaign-insights:runtime,type:campaign-insights,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'campaign-insights'
  - 'env:pilot-staging'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] Zookeeper
    (Only exposed by the leader) number of pending syncs from the followers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
      'warning': 8.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.pending_syncs{environment:integration}
    by {name} > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}} \nOplog window size\
    \ on {{host.name}} - {{host.ip}} is currently {{value}}\n{{/is_alert}}"
  'multi': true
  'name': '[Data-tests] [Infra] Oplog window size
    less than 1 day on {{host.name}}.'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 43200.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:data-tests}
    by {host} < 43200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Campaign-Insights]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:campaign-insights,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Orca] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-orca-production}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}   \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}   \n{{/is_no_data}} \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal  \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again  \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [sys] [Core-Fetcher]
    % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Sys]
    [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:engagement-scoring,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Data-tests-dev] [sys] [Oppcasting] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests-dev","feature_name:oppcasting").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'sys'
  - 'status'
  - 'oppcasting'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}} \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}} \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Sys] [Mongo] No swap
    configured for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,type:mongo,!type:jungle}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'cross-features'

- 'message': 'please check @cchu@salesforce.com'
  'multi': true
  'name': '[Performance] Disk Free space is running
    low on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 200000000.0
      'warning': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:system.disk.free{environment:performance}
    by {host} < 200000000'
  'restricted_roles': null
  'tags':
  - '*'
  - 'env:performance'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:data-tests,type:mongo,feature_name:campaign-insights}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration,feature_name:campaign-insights}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [Pod00] [sys] [Core-Fetcher]
    Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging","feature_name:core-fetcher","pod:pod00").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod00'
  'type': 'service check'

- 'message': '.'
  'name': '[Integration] [Engagement-Scoring] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:integration,feature_name:engagement-scoring}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'engagement-scoring'
  - 'env:integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'

- 'message': ''
  'name': '[Integration] [Pod01] [App] [Oppcasting]
    [SEV0] Oppcasting Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:integration,feature_name:oppcasting,!sfenv:stmp1}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'oppcasting'
  - 'pod01'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging,feature_name:core-fetcher,pod:pod00}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:attribution,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Campaign-Insights]
    No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:campaign-insights,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo,feature_name:campaign-insights}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Engagement-Scoring]
    No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:engagement-scoring,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Pardot-Fetcher] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:pardot-fetcher,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:production,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo,feature_name:lead-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] RabbitMQ node
    memory use is high on {{host.name}}'
  'options':
    'escalation_message': 'RabbitMQ node memory
      consumption still very high on {{host.name}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 240
    'require_full_window': true
    'thresholds':
      'critical': 4000000000.0
      'warning': 2000000000.0
    'timeout_h': 0
  'query': 'min(last_5m):avg:rabbitmq.node.mem_used{environment:data-tests}
    by {host} > 4000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-forecast-subworker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-forecast-subworker:runtime,type:forecasting-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': '.'
  'name': '[Prod] [Oppcasting] [Infra] Integration
    - Pushed data from Oppcasting to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:production,feature_name:oppcasting}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'oppcasting'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n@slack-dd-data-tests"
  'multi': true
  'name': '[Data-tests] [sys] % CPU'
  'options':
    'escalation_message': 'CPU load still high on
      {{host.name}}, we need to fix it ASAP.


      @slack-dd-data-tests'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:system.cpu.user{environment:data-tests}
    by {host} + avg:system.cpu.system{environment:data-tests} by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}} \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}} \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [sys] [Core-Fetcher]
    No swap configured for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:core-fetcher,pod:pod00,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo,feature_name:campaign-insights}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Data-tests] [Campaign-Insights] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:data-tests,feature_name:campaign-insights}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'campaign-insights'
  - 'env:data-tests'
  - 'infra'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-ci-data-tests}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [All] [Infra] RDS CPU High'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 80.0
      'warning': 70.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.rds.cpuutilization{name:jungle-data-tests}
    > 80'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'infra'
  - 'rds'
  - 'status'
  'type': 'query alert'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [persister] [SQS]:
    Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-persister}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': ''
  'name': '[Staging] [Pod00] [App] [Pardot-Fetcher]
    [SEV0] Pardot-Fetcher Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging,feature_name:pardot-fetcher,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'pardot-fetcher'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:campaign-insights,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Campaign-Insights]
    % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:campaign-insights,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:data-tests,type:mongo,feature_name:engagement-scoring}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Sys]
    [Mongo] % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:campaign-insights,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:attribution,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'attribution'

- 'message': "{{#is_alert}}\n\n \n\n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:oppcasting,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Core-Fetcher] [Pod00] [Infra]
    Integration - Fetched data core to Core-Fetcher'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:pilot-staging,feature_name:core-fetcher,pod:pod00},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Sys] [Mongo] Disk space
    is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'cross-features'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] RabbitMQ node memory
    usage'
  'options':
    'escalation_message': 'RabbitMQ node memory
      consumption still very high on {{host.name}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 240
    'require_full_window': true
    'thresholds':
      'critical': 35.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'min(last_1h):avg:rabbitmq.node.mem_used{environment:production}
    by {host} / avg:system.mem.total{environment:production} by {host} * 100 > 35'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:engagement-scoring,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Core-Fetcher] [Pod00] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:pilot-staging,rabbitmq_vhost:corefetcher,pod:pod00}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:data-tests,type:mongo,feature_name:pardot-fetcher}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:attribution,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Pod00] Number of containers
    for core-fetcher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:core-fetcher,implisit_service:implisit/core-fetcher:runtime,type:core-fetcher-canary,pod:pod00}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:pilot-staging,feature_name:attribution}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Pardot-Fetcher] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:pardot-fetcher,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [sys] [Core-Fetcher] %
    CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n@slack-dd-prod\
      \ \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-prod \n\
      {{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo,feature_name:lead-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': '{{value}}'
  'name': '[Prod] [Canary] [Pod00] [App] [Attribution]
    [SEV0] Attribution Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:attribution,canary:true,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'canary'
  - 'attribution'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{{{is_match \"environment.name\"\
    \ \"production\"}}}} \n\n{{request.type.name}} failed {{value}} times in {{environment.name}}\n\
    {{{{/is_match}}}} @slack-bot-datadog-conv-ai-alerts"
  'multi': true
  'name': "[ConvAI] [conv-ai-fetcher]: Lots of fetching failures\uD83D\
    \uDCA5"
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'critical_recovery': 5.0
      'warning': 10.0
      'warning_recovery': 1.0
    'timeout_h': 0
  'query': 'sum(last_30m):sum:salesforce.api.requests{!status:success}
    by {request.type,profile}.as_count() > 15'
  'restricted_roles': null
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Tickets - Threads
    Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:pilot-staging,type:mongo,feature_name:orca}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:integration,type:mongo,feature_name:campaign-insights}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Prod] [Pardot-Fetcher] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:production,feature_name:pardot-fetcher}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'pardot-fetcher'
  - 'env:production'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-lead-scoring-training
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 30
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-training:runtime,type:lead-scoring-training-worker,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:pilot-staging'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Containers] [Engagement Scoring]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:pilot-staging,feature_name:engagement-scoring,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'containers'
  - 'anomaly'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Core Fetchers]
    Number of containers for celery-core-fetcher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:core-fetcher,type:core-fetcher,implisit_service:implisit/celery-core-fetcher:runtime,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'core-fetcher'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Fault
    Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:production,feature_name:oppcasting}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n  \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \  \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Attribution] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:attribution,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:engagement-scoring,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Lead-Scoring] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:lead-scoring,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo,feature_name:lead-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': "--pilot-staging--\n{{host.name}} -\
    \ RMQ Job is down\n## Check out some extra data on the:\n[Bonobo _extra detailed_\
    \ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
    ```"
  'multi': true
  'name': '[Bnbo] [stag] [RMQ] Job is up'
  'options':
    'escalation_message': "***Renotifying***\n--pilot-staging--\n\
      {{host.name}} - RMQ Job is down\n## Check out some extra data on the:\n[Bonobo\
      \ _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
      ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
      ```"
    'include_tags': true
    'locked': true
    'new_host_delay': 3609
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'avg(last_2h):avg:rabbitmq.node.running{inst_type:docker-services-bonobo,env:pilot-staging}
    by {host} < 1'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'rabbitmq'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring-light in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,type:oppcasting-training,implisit_service:implisit/celery-oppty-scoring-light:runtime,environment:integration}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:lead-scoring,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:pilot-staging,feature_name:campaign-insights}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n  \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \  \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Orca] Disk space is low
    on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:orca,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Orca] Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:orca,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production,feature_name:lead-scoring}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  - 'env:production'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo","feature_name:lead-scoring").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'lead-scoring'
  'type': 'service check'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests","process:mongo","feature_name:lead-scoring").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'lead-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Attribution] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:attribution,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for oppcasting-main-cycle in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/oppcasting-main-cycle:runtime,type:oppcasting-tenant-cycle,environment:integration}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:data-tests,type:mongo,feature_name:core-fetcher}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests","process:mongo","feature_name:pardot-fetcher").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Connections]
    Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:data-tests,type:mongo,feature_name:orca}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:data-tests,type:mongo,feature_name:campaign-insights}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:pardot-fetcher,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Pod00] [App] [Lead-Scoring] [SEV1]
    Lead-Scoring Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 400.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:lead-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'lead-scoring'
  - 'pod00'
  - 'app'
  - 'sev1'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Offline-Jobs] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:offline-jobs,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': '. @slack-sev0-1'
  'name': '[Prod] [Pod00] [App] [Pardot-Fetcher]
    [SEV0] Pardot-Fetcher Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:pardot-fetcher,canary:false,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pardot-fetcher'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Integration] [Pod00] [App] [Lead-Scoring]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:integration,feature_name:lead-scoring,!sfenv:stmp1}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'lead-scoring'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod01,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Queue]  Queued
    write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:data-tests,type:mongo,feature_name:orca}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:integration,feature_name:core-fetcher,pod:pod00}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'env:integration'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Engagement-Scoring]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:engagement-scoring,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] RabbitMQ node memory
    use is high on {{host.name}}'
  'options':
    'escalation_message': 'RabbitMQ node memory
      consumption still very high on {{host.name}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 240
    'require_full_window': true
    'thresholds':
      'critical': 4000000000.0
      'warning': 2000000000.0
    'timeout_h': 0
  'query': 'min(last_5m):avg:rabbitmq.node.mem_used{environment:production}
    by {host} > 4000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Infra] AWS
    Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-ci-production-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:attribution,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:pilot-staging,type:mongo,feature_name:attribution}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for attribution-tenant-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:attribution,implisit_service:implisit/attribution-tenant-cycle:runtime,type:attribution-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'attribution'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] Zookeeper
    nodes number'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.nodes{environment:integration}
    by {name} < 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  for over 1 hours\n{{/is_alert}} \n\n\n{{#is_no_data}}\n\
    {{host.name}}  - {{host.ip}} didn't report CPU for 30 minutes \n{{/is_no_data}}\
    \ \n @slack-bot-datadog-build"
  'multi': true
  'name': '[Build] [sys] Master % CPU'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 30
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 90.0
      'warning': 75.0
    'timeout_h': 1
  'query': 'min(last_1h):max:system.cpu.user{environment:build,type:jenkins-master}
    by {host} + max:system.cpu.system{environment:build,type:jenkins-master} by {host}
    > 90'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:build'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod00,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:pilot-staging,type:mongo,feature_name:oppcasting}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}} \nThis can cause significant\
    \ cycle degradation until Redis is cleaned.\n{{/is_alert}}\n\n{{#is_recovery}}\
    \ \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\
    \ \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Cycle Degradation Case]
    Duration of pre-cycle-run flow in minutes'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
      'warning': 4.5
    'timeout_h': 0
  'query': 'avg(last_5m):max:orca.module.tenant_run.pre_cycle_run.time.avg{environment:pilot-staging}
    by {feature_name} / 1000 / 60 > 5'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Attribution] Number
    of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:attribution,implisit_service:implisit/celery-pusher:runtime,type:attribution-pusher-canary}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-forecast
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-forecast:runtime,type:forecasting-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:data-tests,feature_name:pardot-fetcher}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo,feature_name:campaign-insights}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:integration,type:mongo,feature_name:campaign-insights}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Pardot-Fetcher] No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:pardot-fetcher,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Tickets - Threads
    Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:production,type:mongo,feature_name:orca}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:production,feature_name:pardot-fetcher}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n@slack-dd-p-staging-app"
  'multi': true
  'name': '[p-staging] [app] MongoDB is down on
    {{host.name}}'
  'options':
    'new_host_delay': 300
    'no_data_timeframe': 2
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo").by("host","process").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Offline-Jobs] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:offline-jobs,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:integration,type:mongo,feature_name:engagement-scoring}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests-dev,feature_name:oppcasting,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'mongo'
  - 'oppcasting'

- 'message': '.'
  'multi': true
  'name': '[Staging] Number of containers for pardot-fetcher-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_15m):sum:docker.containers.running{implisit_service:implisit/pardot-fetcher-cycle:runtime,environment:pilot-staging,feature_name:pardot-fetcher,type:pardot-fetcher-main}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:integration,feature_name:core-fetcher,pod:pod00}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': '.'
  'name': '[Staging] [Engagement-Scoring] [Infra]
    Integration - Pushed data from Engagement-Scoring to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:pilot-staging,feature_name:engagement-scoring}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'engagement-scoring'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration,feature_name:lead-scoring}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] Celery -
    Count celery tasks'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
      'warning': 300.0
    'timeout_h': 0
  'query': 'sum(last_15m):avg:orca.orca.celery_task.time.count{env:integration}
    by {feature_name}.as_count() < 5'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'cross-features'
  - 'env:integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:data-tests,type:mongo,feature_name:pardot-fetcher}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo,feature_name:attribution}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': '.'
  'name': '[Staging] [Oppcasting] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:pilot-staging,feature_name:oppcasting}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'oppcasting'
  - 'env:pilot-staging'
  - 'infra'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Infra] AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-cf-integ-pod01}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-data-tests}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [All] Disk space is low
    on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [All] [Infra] Fetcher -
    SIQ Objects Fetched (< 100 4H)'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 100.0
    'timeout_h': 0
  'query': 'sum(last_4h):avg:orca.siq.fetch.object_fetches{environment:integration}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Eng. Scoring] Number
    of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/celery-beat:runtime,type:engagement-scoring-celery-beat}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [sys] [Campaign-Insights] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production","feature_name:campaign-insights").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'campaign-insights'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Lead-Scoring] No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:lead-scoring,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on\
    \ {{host.name}} is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:production,feature_name:orca}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:production,feature_name:orca}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:production'
  - 'orca'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [Pod00] [sys] [Core-Fetcher]
    Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration","feature_name:core-fetcher","pod:pod00").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod00'
  'type': 'service check'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests,feature_name:core-fetcher}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:data-tests'
  - 'core-fetcher'
  - 'mongo'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for celery-oppty-scoring in {{host.name}} is
    below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppty-scoring:runtime,type:oppcasting-worker-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:core-fetcher,type:mongo,pod:pod01,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:integration,feature_name:oppcasting}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:integration,feature_name:oppcasting}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:integration'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [app] MongoDB
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests","process:mongo").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'cross-features'
  'type': 'service check'

- 'message': '.'
  'name': '[Staging] [Oppcasting] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-oc-staging-pod01}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Campaign-Insights] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:campaign-insights,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'campaign-insights'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests","process:mongo","feature_name:attribution").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'attribution'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo,feature_name:engagement-scoring}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:attribution,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:lead-scoring,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:data-tests-dev,type:mongo,feature_name:oppcasting}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n@pagerduty-Ofek-Datadog\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [app] MongoDB is
    down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pagerduty'
  - 'mongo'
  - 'cross-features'
  'type': 'service check'

- 'message': '.'
  'name': '[Integration] [Orca] [Infra] Integration
    - Fetched data core to Orca'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:integration,feature_name:orca},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'orca'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests,feature_name:core-fetcher}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Staging] [Orca] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:pilot-staging,feature_name:orca}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'orca'
  - 'mongo'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Engagement-Scoring] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:pilot-staging,feature_name:engagement-scoring}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'engagement-scoring'
  - 'env:pilot-staging'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:pilot-staging,feature_name:engagement-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Prod] [Core-Fetcher] [Pod01] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-cf-prod-pod01}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:integration,feature_name:lead-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production,feature_name:engagement-scoring}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging,feature_name:attribution}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging,feature_name:attribution}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:pilot-staging'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:data-tests,feature_name:campaign-insights}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:data-tests,feature_name:campaign-insights}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:data-tests'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging][Attribution] Number of containers
    for celery-attribution-main in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:pilot-staging,feature_name:attribution,type:attribution,implisit_service:implisit/celery-attribution-main:runtime}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:core-fetcher,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}   \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}   \n{{/is_no_data}} \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal  \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again  \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [sys] [Core-Fetcher]
    % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo,feature_name:attribution}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [All] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Core Fetcher] Number
    of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:core-fetcher,implisit_service:implisit/celery-beat:runtime,type:core-fetcher-celery-beat}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'core-fetcher'

- 'message': '.'
  'name': '[Data-tests-dev] [Oppcasting] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:data-tests,feature_name:oppcasting}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'oppcasting'
  - 'env:data-tests-dev'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n\
    {{/is_no_data_recovery}} \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage\
    \ back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Lead Scoring]
    Number of containers for celery-fetcher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-fetcher:runtime,type:lead-scoring-fetchers-canary}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:production,feature_name:lead-scoring}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'lead-scoring'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:production,feature_name:pardot-fetcher}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Prod] [Lead-Scoring] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-ls-production-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{value}} \n\
    {{/is_alert}} \n\n\n{{#is_recovery}}\n \n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': '.'
  'name': '[Data-tests] [Orca] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:data-tests,rabbitmq_vhost:orca}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'orca'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Prod] [Orca] [Mongo] {{host.name}} oplog
    window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:production,feature_name:orca}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'orca'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nLow Celery Tasks Count\n\
    @slack-dd-p-staging-sys \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    @slack-dd-p-staging-sys \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n@slack-dd-p-staging-sys \n{{/is_no_data_recovery}}"
  'name': '[Staging] Celery - Lead Scoring - Count
    celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 300.0
    'timeout_h': 0
  'query': 'sum(last_30m):max:orca.orca.celery_task.time.count{feature_name:lead-scoring,environment:pilot-staging}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'lead-scoring'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': '. @slack-sev0-1'
  'name': '[Prod] [Pod00] [App] [Engagement-Scoring]
    [SEV0] Engagement-Scoring Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:engagement-scoring,canary:false,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'engagement-scoring'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Pardot-Fetcher] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:pilot-staging,rabbitmq_vhost:pardot-fetcher}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'pardot-fetcher'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests,feature_name:campaign-insights}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:data-tests'
  - 'campaign-insights'
  - 'mongo'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [sys] [Pardot-Fetcher] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging","feature_name:pardot-fetcher").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'pardot-fetcher'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{value}} \n \n\
    {{/is_alert}} \n\n{{#is_no_data}}\n \n \n{{host.name}} \n{{/is_no_data}} \n\n\
    {{#is_alert_recovery}}\n \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n\
    \ \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:lead-scoring,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{value}} \n \n\
    {{/is_alert}} \n\n{{#is_no_data}}\n \n \n{{host.name}} \n{{/is_no_data}} \n\n\
    {{#is_alert_recovery}}\n \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n\
    \ \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:pardot-fetcher,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:production,type:mongo,feature_name:oppcasting}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "High Mongo latency on {{mongo.name}}\
    \ \n\n@slack-dd-perf-app"
  'multi': true
  'name': '[Perf] [app] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:performance}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:performance'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [sys] [Pardot-Fetcher]
    Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration","feature_name:pardot-fetcher").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'pardot-fetcher'
  'type': 'service check'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Attribution] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:attribution,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:production,feature_name:oppcasting}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:lead-scoring,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'lead-scoring'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [app] MongoDB
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'cross-features'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:oppcasting,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Tickets - Threads
    Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:pilot-staging,feature_name:orca}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': "{{#is_alert}} \n{{value}} \n@pagerduty-Ofek-Datadog\
    \ \n{{/is_alert}} \n\n{{#is_no_data}} \n{{host.name}} \n@pagerduty-Ofek-Datadog\
    \ \n{{/is_no_data}} \n\n{{#is_alert_recovery}} \n{{value}} \n{{/is_alert_recovery}}\n\
    \n{{#is_no_data_recovery}} \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Sys] [Mongo] No swap configured
    for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 15
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,type:mongo,!type:jungle}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Lead-Scoring] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:lead-scoring,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-forecast in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-forecast:runtime,type:oppcasting-forecasting}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:attribution,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging,feature_name:core-fetcher,pod:pod01}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging,feature_name:core-fetcher,pod:pod01}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Integration] [Orca] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:integration,feature_name:orca}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'orca'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Tickets -
    Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:data-tests}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Core Fetcher]
    Number of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:core-fetcher,implisit_service:implisit/celery-beat:runtime,type:core-fetcher-celery-beat,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'core-fetcher'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{value}} \n \n\
    {{/is_alert}} \n\n{{#is_no_data}}\n \n \n{{host.name}} \n{{/is_no_data}} \n\n\
    {{#is_alert_recovery}}\n \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n\
    \ \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:engagement-scoring,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:pilot-staging,type:mongo,feature_name:engagement-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Sys]
    [Mongo]  No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:engagement-scoring,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'engagement-scoring'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Staging] [All] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:pilot-staging}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'mongo'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:pilot-staging,feature_name:oppcasting}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'oppcasting'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}} @pagerduty-Ofek-Datadog"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Cursor] Open
    Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}} \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Mongo Fault Page] Operations
    which require Mongo to fetch data from disk'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Pardot-Fetcher]
    Disk space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:pardot-fetcher,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Eng. Scoring]
    Number of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:engagement-scoring,implisit_service:implisit/celery-system-alerts:runtime,type:engagement-scoring-pusher,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'engagement-scoring'
  - 'env:pilot-staging'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Containers] [Core Fetcher]
    Number of containers for core-fetcher celery-system-alerts {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'avg(last_10m):sum:docker.containers.running{feature_name:core-fetcher,environment:pilot-staging,implisit_service:implisit/celery-system-alerts:runtime,type:core-fetcher}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'core-fetcher'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests,feature_name:attribution}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:data-tests'
  - 'attribution'
  - 'mongo'

- 'message': '.'
  'name': '[Integration] [Campaign-Insights] [Infra]
    Integration - Pushed data from Campaign-Insights to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:integration,feature_name:campaign-insights}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'campaign-insights'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [sys] [Offline Jobs] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging","feature_name:offline-jobs").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'offline-jobs'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:data-tests,feature_name:campaign-insights}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{value}} \n\
    {{/is_alert}} \n\n\n{{#is_recovery}}\n \n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Handles]
    WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo,feature_name:orca}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration,feature_name:lead-scoring}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'lead-scoring'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:integration,feature_name:attribution}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': '.'
  'name': '[Staging] [Pardot-Fetcher] [Infra] AWS
    Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-pf-staging-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "--pilot-staging--\nRMQ - More than\
    \ 5K messages on rabbitmq_node.name\n## Check out some extra data on the:\n[Bonobo\
    \ _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
    ```"
  'multi': true
  'name': '[Bnbo] [stag] [RMQ] messages'
  'options':
    'escalation_message': "***Renotifying***\n--pilot-staging--\n\
      RMQ - More than 5K messages on rabbitmq_node.name\n## Check out some extra data\
      \ on the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
      ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
      ```"
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': 30
    'renotify_interval': 1440
    'require_full_window': true
    'thresholds':
      'critical': 5000.0
    'timeout_h': 2
  'query': 'avg(last_4h):sum:rabbitmq.queue.messages{type:bonobo_services,env:pilot-staging}
    by {rabbitmq_node} > 5000'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'rabbitmq'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:data-tests,feature_name:campaign-insights}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Prod] [Core-Fetcher] [Pod01] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:production,rabbitmq_vhost:corefetcher,pod:pod01}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:data-tests,feature_name:attribution}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}}\n{{type.name}} \n{{host.name}}:\
    \ Low usable memory: {{value}} \n{{/is_alert}} \n \n\n{{#is_recovery}}\n{{type.name}}\
    \ \n{{host.name}}: Disk usage back to normal \n{{/is_recovery}}  \n@slack-dd-data-tests"
  'multi': true
  'name': '[Data-tests] [sys] % Usable Memory on
    {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-data-tests'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 30
    'notify_audit': true
    'renotify_interval': 30
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_30m):min:system.mem.pct_usable{environment:data-tests}
    by {host,type} < 0.15'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:data-tests'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging,feature_name:campaign-insights}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Sys] [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:orca,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Connections]
    Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:integration,feature_name:orca}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files\n \n {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production,feature_name:pardot-fetcher}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': '{{#is_alert}}

    {{/is_alert}}'
  'multi': true
  'name': 'Jenkins Slave-  M4 (7 concurrent jobs)'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 7.0
      'warning': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):default(sum:docker.containers.running{type:jenkins-slave,docker_image:187473451979.dkr.ecr.us-west-2.amazonaws.com/jenkins-slave:20190512t110335_2c2d30c7,instance-type:m4.2xlarge}
    by {host,inst_type}, 0) >= 7'
  'restricted_roles': null
  'tags':
  - 'slave'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] Zookeeper
    integration is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 2
    'renotify_interval': 20
    'thresholds':
      'critical': 3
    'timeout_h': 0
  'query': '"zookeeper.ruok".over("environment:data-tests").by("host","port").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'
  'type': 'service check'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:integration,feature_name:campaign-insights}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:integration,feature_name:campaign-insights}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:integration'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo","feature_name:core-fetcher","pod:pod00").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Attribution] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:attribution,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'attribution'

- 'message': "{{#is_alert}}No swap configured for\
    \ {{host.name}}{{/is_alert}}\n{{#is_alert_recovery}}Swap now configured for {{host.name}}{{/is_alert_recovery}}\
    \ \n@slack-dd-p-staging-sys"
  'multi': true
  'name': '[p-staging] [sys] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,!type:jungle,!type:services}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:integration,feature_name:campaign-insights}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Lead Scoring] Number
    of containers for celery-fetcher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-fetcher:runtime,type:lead-scoring-fetcher}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Containers] [Pardot Fetcher]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:pilot-staging,feature_name:pardot-fetcher,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'containers'
  - 'anomaly'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-worker in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-worker:runtime,type:oppcasting-worker}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': '.'
  'name': '[Prod] [Lead-Scoring] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-ls-production-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Connections]
    Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:data-tests,feature_name:orca}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Lead-Scoring] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:lead-scoring,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': ''
  'name': '[Staging] [App] [All] [SEV0] All Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n \n\
    {{/is_alert}} \n\n{{#is_no_data}}\n \n \n{{host.name}} \n{{/is_no_data}} \n\n\
    {{#is_alert_recovery}}\n \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n\
    \ \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:attribution,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo,feature_name:campaign-insights}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] Zookeeper latency'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10000.0
      'warning': 7000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.latency.max{environment:production}
    by {name} > 10000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo,feature_name:pardot-fetcher}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Sys] [Mongo]  % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:integration}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': '@dmachlin@salesforce.com'
  'multi': true
  'name': 'Call Coaching Pipeline Staging - Failure'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"jenkins.job.status".over("host:impl-jenkins-pilot-staging.pod00-CD","job:call-coaching/pipeline").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'ecc'
  - 'pipeline'
  'type': 'service check'

- 'message': '. @slack-sev0-1'
  'name': '[Prod] [Pod00] [App] [Campaign-Insights]
    [SEV0] Campaign-Insights Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:campaign-insights,canary:false,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pod00'
  - 'sev0'
  - 'app'
  - 'pagerduty'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n \n\
    {{/is_alert}} \n\n{{#is_no_data}}\n \n \n{{host.name}} \n{{/is_no_data}} \n\n\
    {{#is_alert_recovery}}\n \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n\
    \ \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:oppcasting,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Campaign-Insights] %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:campaign-insights,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'campaign-insights'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo","feature_name:core-fetcher","pod:pod00").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo,feature_name:engagement-scoring}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Prod] [Pod00] [App] [Orca] Failed Cycles'
  'options':
    'escalation_message': '.'
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:production,feature_name:orca,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) > 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'orca'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Pardot-Fetcher] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:pardot-fetcher,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Oppcasting] [Infra] Integration
    - Pushed data from Oppcasting to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:pilot-staging,feature_name:oppcasting}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'oppcasting'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Sys]
    [Mongo]  Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [moments] [SQS]:
    Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-moments}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [All] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'cross-features'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Attribution] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:attribution,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:data-tests,feature_name:campaign-insights}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'campaign-insights'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:pilot-staging,type:mongo,feature_name:pardot-fetcher}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] Zookeeper
    latency'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10000.0
      'warning': 7000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.latency.max{environment:integration}
    by {name} > 10000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': '.'
  'name': '[Staging] [Pardot-Fetcher] [Infra] AWS
    Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-pf-staging-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Connections]
    Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:integration,type:mongo}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-forecast-subworker in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 6.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,type:oppcasting-forecasting,implisit_service:implisit/celery-forecast-subworker:runtime}
    by {host} < 6'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Offline-Jobs] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:offline-jobs,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Connections]
    Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:production,type:mongo,feature_name:oppcasting}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Engagement-Scoring] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:engagement-scoring,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Fault Page]
    Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:production}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Connections]
    Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:integration,type:mongo,feature_name:orca}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Engagement-Scoring]
    No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:engagement-scoring,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n{{type.name}} \n{{host.name}}:\
    \ Low usable memory: {{value}} \n{{/is_alert}} \n \n\n{{#is_recovery}}\n{{type.name}}\
    \ \n{{host.name}}: Disk usage back to normal \n{{/is_recovery}}   @slack-bot-datadog-build"
  'multi': true
  'name': '[Build] [sys] % Usable Memory on {{type.name}}
    - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-build'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 30
    'notify_audit': true
    'renotify_interval': 30
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_30m):min:system.mem.pct_usable{environment:build}
    by {host,type} < 0.15'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:build'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Prod] [Pod00] [App] [Pardot-Fetcher]
    Failed Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:production,feature_name:pardot-fetcher,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) > 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pardot-fetcher'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Oppcasting] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:oppcasting,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Data-tests] [App] [Engagement-Scoring]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:data-tests,feature_name:engagement-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'engagement-scoring'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo,feature_name:oppcasting}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-lead-scoring-main
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-main:runtime,type:lead-scoring-main-service-canary}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Connections]
    Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:production}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:data-tests,type:mongo,feature_name:pardot-fetcher}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [object-modification]
    [SQS]: Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-object-modification}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:production,type:mongo,feature_name:engagement-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] RabbitMQ
    node memory use is high on {{host.name}}'
  'options':
    'escalation_message': 'RabbitMQ node memory
      consumption still very high on {{host.name}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 240
    'require_full_window': true
    'thresholds':
      'critical': 4000000000.0
      'warning': 2000000000.0
    'timeout_h': 0
  'query': 'min(last_5m):avg:rabbitmq.node.mem_used{environment:integration}
    by {host} > 4000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging,feature_name:core-fetcher,pod:pod01}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests-dev,feature_name:oppcasting}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n@slack-dd-p-staging-sys \n{{/is_no_data}}\
    \ \n\n{{#is_no_data_recovery}}\n@slack-dd-p-staging-sys \n{{/is_no_data_recovery}}"
  'name': '[Staging] [Fetcher] Pardot Fetch - Objects'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_1d):avg:pardot.fetch_records{environment:pilot-staging}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'integration'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Pod01] [App] [Core-Fetcher] [SEV1]
    Core-Fetcher Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 150.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:core-fetcher,pod:pod01,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 150'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'
  - 'app'
  - 'sev1'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:integration,feature_name:lead-scoring}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'lead-scoring'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [All] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for predictor
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,implisit_service:implisit/predictor:runtime,feature_name:orca,type:predictor-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:data-tests,type:mongo,feature_name:engagement-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Fault Page]
    Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:production,feature_name:orca}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'cross-features'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:data-tests,type:mongo,feature_name:engagement-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Data-tests] [Orca] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-orca-data-tests}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:integration,feature_name:core-fetcher,pod:pod01}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:data-tests-dev,feature_name:oppcasting}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': '.'
  'name': '[Data-tests] [All] [Infra] RabbitMQ -
    Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:data-tests}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:orca,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'orca'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for oppcasting-main-cycle in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/oppcasting-main-cycle:runtime,type:oppcasting-tenant-cycle,environment:pilot-staging}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-oppty-scoring-light
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,type:oppty-scoring-training,implisit_service:implisit/celery-oppty-scoring-light:runtime,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\nLow Celery Tasks Count\n\
    @slack-dd-p-staging-sys \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    @slack-dd-p-staging-sys \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n@slack-dd-p-staging-sys \n{{/is_no_data_recovery}}"
  'name': '[Staging] Celery - Campaign Insights
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{feature_name:campaign-insights,environment:pilot-staging}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'campaign-insights'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:campaign-insights,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'campaign-insights'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for oppty-training-cycle-large in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,type:oppcasting-training,implisit_service:implisit/oppty-training-cycle-large:runtime,environment:integration}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Oppcasting] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:oppcasting,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Staging] [Pod00] [App] [Lead-Scoring]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:pilot-staging,feature_name:lead-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'lead-scoring'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nLow Celery Tasks Count\n\
    @slack-dd-p-staging-sys \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    @slack-dd-p-staging-sys \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n@slack-dd-p-staging-sys \n{{/is_no_data_recovery}}"
  'name': '[Staging] Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 300.0
    'timeout_h': 0
  'query': 'sum(last_30m):max:orca.orca.celery_task.time.count{host:pilot-staging-docker-pushers-0}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_no_data}} \n{{/is_no_data}} \n\n{{#is_no_data_recovery}} \n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}} \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [sys] [Core-Fetcher] %
    Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-prod'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-oppty-scoring-light
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-oppty-scoring-light:runtime,type:oppty-scoring-training-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': "{{#is_alert}}No swap configured for\
    \ {{host.name}}{{/is_alert}}\n{{#is_alert_recovery}}Swap now configured for {{host.name}}{{/is_alert_recovery}}\
    \ \n@slack-dd-perf-sys"
  'multi': true
  'name': '[Perf] [sys] No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:performance,!type:jungle,!type:services}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:performance'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] RabbitMQ
    on {{host.name}} is down or {{vhost.name}} doesn''t exist.'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
    'timeout_h': 0
  'query': '"rabbitmq.aliveness".over("environment:integration").by("host","vhost").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'rabbitMQ'
  - 'infra'
  'type': 'service check'

- 'message': ''
  'name': '[Data-tests] [App] [Engagement-Scoring]
    [SEV0] Engagement-Scoring Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:data-tests,feature_name:engagement-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'engagement-scoring'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Campaign-Insights] %
    Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:campaign-insights,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:attribution,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Connections]
    Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:integration,type:mongo,feature_name:orca}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Connections]
    Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:production,type:mongo,feature_name:oppcasting}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for oppty-scoring-training-cycle-large
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/oppty-scoring-training-cycle-large:runtime,type:oppty-scoring-training-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Sys] [Mongo] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:pilot-staging,feature_name:campaign-insights}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:pilot-staging,feature_name:core-fetcher,pod:pod01}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'mongo'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:pardot-fetcher,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'status'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}} @pagerduty-Ofek-Datadog"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Queue] Queued
    write requests'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-campaign-insights
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:campaign-insights,type:campaign-insights,implisit_service:implisit/celery-campaign-insights:runtime,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'campaign-insights'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-campaign-insights
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:campaign-insights,type:campaign-insights,implisit_service:implisit/celery-campaign-insights:runtime}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:pilot-staging,type:mongo,feature_name:campaign-insights}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:data-tests,type:mongo,feature_name:lead-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:campaign-insights,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'campaign-insights'

- 'message': "The newest EBS snapshot for production\
    \ mongo cluster {{ mongo_cluster.name }} is too old.\n\n1. Check Slack channel\
    \ [#production-ops](https://implisit.slack.com/messages/C2Y9PF954/) for `create-mongo-snapshot`\
    \ Jenkins job failures.\n1. Go to the [`create-mongo-snapshot` Jenkins job](http://localhost:2000/job/create-mongo-snapshots)\
    \ (first connect with **`dog.py devops ssh_2_all production`**).\n @slack-dd-prod"
  'multi': true
  'name': 'Production mongo snapshots too old -
    {{mongo_cluster.name}}'
  'options':
    'escalation_message': null
    'evaluation_delay': 1000
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 120
    'renotify_interval': null
    'require_full_window': false
    'thresholds':
      'critical': 86400.0
    'timeout_h': null
  'query': 'avg(last_1h):min:aws.ebs.snapshot_age{mongo_replica:2,environment:production}
    by {mongo_cluster} > 86400'
  'restricted_roles': null
  'tags':
  - 'mongo_backup'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:production,type:mongo,feature_name:pardot-fetcher}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Tickets - Threads
    Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:production}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'

- 'message': "{{#is_alert}}\n@slack-dd-prod \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-prod \n{{/is_alert_recovery}}"
  'name': '[Prod] [Jenkins] System Test - Connectivity
    (prod_gs0) TEST'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_10m):sum:jenkins.job.duration{host:impl-jenkins-production-CD,job:tests/connectivity_tests_runner_production_gs0,result:failure}.as_count()
    / sum:jenkins.job.duration{host:impl-jenkins-production-CD,job:tests/connectivity_tests_runner_production_gs0,result:failure}.as_count()
    > 1'
  'restricted_roles': null
  'tags':
  - 'Tests'
  - 'status'
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Attribution]
    Number of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{implisit_service:implisit/celery-system-alerts:runtime,environment:pilot-staging,feature_name:attribution,type:attribution-pusher}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n\
    {{/is_no_data_recovery}} \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage\
    \ back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Sys] [Mongo] %
    Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:attribution,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': 'In order to see results of the query
    in Splunk:

    Connect to Splunk in pilot-staging

    Click on Search&Reporting -> Alerts -> Tracking Pipeline -> Find the alert that
    was triggered depending on the time -> View results


    Splunk runs a job every 4 hours to check if all voice calls that entered the pipeline
    finished successfully within the SLA.

    If there are voice calls that did not finish within the SLA, an alert will be
    sent from splunk to datadog creating an alert in this monitor.


    We are monitoring the job that runs the periodic query to make sure that it is
    running - https://app.datadoghq.com/monitors/17127662


    Pipeline tracking service and computation of the SLA is explained here - https://salesforce.quip.com/wZ2aAbLDo4sB'
  'name': 'pilot-staging: Splunk Tracking Pipeline'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'events(''sources:splunk priority:all
    "pilot-staging: Splunk Tracking Pipeline Alert"'').rollup(''count'').last(''4h'')
    > 0'
  'restricted_roles': null
  'type': 'event alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Pardot-Fetcher] No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:pardot-fetcher,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'pardot-fetcher'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [app] MongoDB
    has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging,feature_name:orca}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on\
    \ {{host.name}} is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:production,feature_name:core-fetcher,pod:pod00}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:production,feature_name:core-fetcher,pod:pod00}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:data-tests,feature_name:engagement-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Prod] [Oppcasting] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-oc-production-pod01}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': 'test - tenant new'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_5m):avg:jungle.api.tenant.new{environment:production,region:us-west-2}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'onboarding'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo","feature_name:core-fetcher","pod:pod01").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'service check'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [app] MongoDB
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo","feature_name:lead-scoring").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'lead-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:integration,feature_name:attribution}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Data-tests] [sys] [Lead-Scoring] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests","feature_name:lead-scoring").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'lead-scoring'
  'type': 'service check'

- 'message': ''
  'name': '[Integration] [Pod00] [App] [Pardot-Fetcher]
    [SEV0] Pardot-Fetcher Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:integration,feature_name:pardot-fetcher,!sfenv:stmp1}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'pardot-fetcher'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n  \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \  \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Oppcasting] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:oppcasting,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': ''
  'name': '[Staging] [Pod00] [App] [Attribution]
    [SEV0] Attribution Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging,feature_name:attribution,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'attribution'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Pardot-Fetcher] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:pardot-fetcher,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Sys]
    [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Pod00] [App] [Campaign-Insights]
    [SEV1] Campaign-Insights Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:campaign-insights,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 40'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pod00'
  - 'app'
  - 'pagerduty'
  - 'sev1'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Prod] [Pod00] [App] [Engagement-Scoring]
    Failed Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:production,feature_name:engagement-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) > 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'engagement-scoring'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:data-tests,feature_name:engagement-scoring}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:data-tests,feature_name:engagement-scoring}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:data-tests'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n\
    {{/is_no_data_recovery}} \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage\
    \ back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:pardot-fetcher,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] RabbitMQ FD
    use is high'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_5m):sum:rabbitmq.node.fd_used{environment:data-tests}
    by {host} > 15000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'rabbitMQ'
  - 'infra'

- 'message': '.'
  'name': '[Staging] [Orca] [Infra] RabbitMQ - Messages
    waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:pilot-staging,rabbitmq_vhost:orca}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'orca'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Core-Fetcher] [Pod00] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-cf-production-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:integration,type:mongo,feature_name:engagement-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Offline-Jobs] %
    CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:offline-jobs,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Sys] [Mongo]  Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:core-fetcher,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'core-fetcher'
  'type': 'query alert'

- 'message': '@pagerduty-Ofek-Datadog

    @slack-dd-prod'
  'name': '[App] [Orca] Low number of Account Insights
    (<4k 24h)'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4000.0
    'timeout_h': 0
  'query': 'sum(last_1d):sum:orca.push_insights.LeadershipChange.new{env:production}.as_count()
    + sum:orca.push_insights.CompanyExpanding.new{env:production}.as_count() + sum:orca.push_insights.MergerAndAcquisition.new{env:production}.as_count()
    < 4000'
  'restricted_roles': null
  'tags':
  - 'pagerduty'
  - 'env:production'
  - 'orca'
  - 'app'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests,feature_name:attribution}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:data-tests,type:mongo,feature_name:orca}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:data-tests,feature_name:lead-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}} \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}} \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Sys] [Mongo] No swap
    configured for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,type:mongo,!type:jungle}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'status'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:integration,feature_name:pardot-fetcher}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Lead Scoring] Number
    of containers for gm-contribution-cycle in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'sum(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/lead-scoring-gm-contribution-cycle:runtime,type:lead-scoring-gm-contribution-cycle}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [Pod01] [sys] [Core-Fetcher]
    Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration","feature_name:core-fetcher","pod:pod01").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod01'
  'type': 'service check'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging,feature_name:pardot-fetcher}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'pardot-fetcher'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:pardot-fetcher,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n@pagerduty-Ofek-Datadog\n\n{{#is_alert}} \n{{/is_alert}} \n\n{{value}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] MongoDB is down
    on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pagerduty'
  - 'mongo'
  - 'cross-features'
  'type': 'service check'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Infra] AWS
    Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-cf-data-tests}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'core-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:pardot-fetcher,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Pardot-Fetcher]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:pardot-fetcher,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [pusher] [SQS]:
    Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-pusher}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:pilot-staging,feature_name:lead-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:pilot-staging,type:mongo,feature_name:oppcasting}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Lead Scoring] Number
    of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,type:lead-scoring-fetcher,implisit_service:implisit/celery-pusher:runtime}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Sys] [Mongo] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for eng-scoring-training-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,type:engagement-scoring-training-canary,implisit_service:implisit/eng-scoring-training-cycle:runtime}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Cursor]
    Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo,feature_name:attribution}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:production,feature_name:core-fetcher,pod:pod01}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Offline-Jobs] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:offline-jobs,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Connections]
    Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:integration}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:production,type:mongo,feature_name:pardot-fetcher}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Sys]
    [Mongo] % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:pardot-fetcher,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:production,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:orca,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:lead-scoring,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "--pilot-staging--\n{{host.base_name}}\
    \ - Load Average is over 2.5 for the last 4 hours\n## Check out some extra data\
    \ on the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
    ```"
  'multi': true
  'name': '[Bnbo] [stag] [K8S] Load Average'
  'options':
    'escalation_message': "***Renotifying***\n--pilot-staging--\n\
      {{host.base_name}} - Load Average is over 2.5 for the last 4 hours\n## Check\
      \ out some extra data on the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
      ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
      ```"
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 2.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.5{kubernetes_name_space:bonobo,env:pilot-staging}
    by {host} > 2.5'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'kubernetes'
  - 'sys'
  - 'cpu'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [Pardot-Fetcher] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:data-tests,feature_name:pardot-fetcher}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'pardot-fetcher'
  - 'env:data-tests'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable memory: {{value}}  \n{{/is_alert}}  \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal.\n{{/is_recovery}}  \n@slack-dd-p-staging-sys"
  'multi': true
  'name': '[p-staging] [sys] % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-p-staging-sys'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 30
    'notify_audit': true
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_10m):min:system.swap.pct_free{environment:pilot-staging}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-forecast-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,type:forecasting,implisit_service:implisit/celery-forecast-worker:runtime,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging,feature_name:oppcasting}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'oppcasting'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration,feature_name:engagement-scoring}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'engagement-scoring'
  - 'mongo'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}} \n\
    {{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [sys] [Core-Fetcher]
    Disk space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:data-tests,type:mongo,feature_name:pardot-fetcher}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:pilot-staging,feature_name:oppcasting}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:integration,feature_name:engagement-scoring}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:integration,feature_name:engagement-scoring}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:integration'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Handles]
    WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:data-tests,type:mongo,feature_name:orca}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Containers] [Core Fetcher]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:integration,feature_name:core-fetcher}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'anomaly'
  - 'env:integration'
  - 'core-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring-worker in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppty-scoring-worker:runtime,type:oppcasting-service,environment:pilot-staging}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Offline Jobs] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:offline-jobs,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'offline-jobs'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Pardot-Fetcher] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:pardot-fetcher,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Engagement-Scoring] [Infra] AWS
    Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-es-production-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': 'MongoDB swap use is high on {{host.name}}   @slack-dd-data-tests'
  'multi': true
  'name': '[Data-tests] MongoDB swap use is high
    on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000000000.0
      'warning': 10000000000.0
    'timeout_h': 0
  'query': 'min(last_30m):avg:system.swap.used{type:mongo,environment:data-tests}
    by {host} > 20000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n{{#is_alert}} \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}} \n\
    {{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] MongoDB is
    down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests","process:mongo").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'cross-features'
  'type': 'service check'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Containers] [Engagement
    Scoring] Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:data-tests,feature_name:engagement-scoring,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'containers'
  - 'anomaly'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:pilot-staging,type:mongo,feature_name:lead-scoring}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Sys] [Mongo]  % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:orca,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'orca'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging,feature_name:core-fetcher,pod:pod00}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [app] MongoDB
    Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'cross-features'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:production,feature_name:campaign-insights}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Tickets - Threads
    Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:production,feature_name:orca}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Connections]
    Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:production,type:mongo,feature_name:attribution}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}   \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}   \n{{/is_no_data}} \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal  \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again  \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [sys] [Core-Fetcher]
    % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}} \n@pagerduty-Ofek-Datadog\
    \ \n{{value}} \n{{/is_alert}} \n\n\n{{#is_recovery}} \n@pagerduty-Ofek-Datadog\
    \ \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Handles]
    WT caches open file handles in memory,'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Offline-Jobs] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:offline-jobs,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [Production] [object-modification]
    [SQS]: Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 2000.0
      'critical_recovery': 1400.0
      'warning': 1500.0
      'warning_recovery': 1000.0
    'timeout_h': 0
  'query': 'min(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:production-conv-ai-object-modification}
    > 2000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:campaign-insights,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [app] MongoDB
    Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests,feature_name:orca}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:data-tests'
  - 'orca'
  - 'mongo'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [sys] [Engagement-Scoring]
    Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging","feature_name:engagement-scoring").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'engagement-scoring'
  'type': 'service check'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-es-data-tests}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': ''
  'name': '[Staging] [Pod00] [App] [Engagement-Scoring]
    [SEV0] Engagement-Scoring Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging,feature_name:engagement-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'engagement-scoring'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-forecast-worker in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 12.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,type:oppcasting-forecasting,implisit_service:implisit/celery-forecast-worker:runtime}
    by {host} < 12'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Sys]
    [Mongo]  No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:campaign-insights,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:integration,feature_name:lead-scoring}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Integration] [Pod00] [App] [Campaign-Insights]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:integration,feature_name:campaign-insights,!sfenv:stmp1}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'campaign-insights'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:data-tests-dev,feature_name:oppcasting}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'oppcasting'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Integration] [Pod00] [App] [Orca] Failed
    Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:integration,feature_name:orca,!sfenv:stmp1}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'orca'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:oppcasting,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Connections]
    Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:production,type:mongo,feature_name:orca}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}}   \n\n{{#is_recovery}}\n{{host.name}}:\
    \ CPU usage back to normal \n{{/is_recovery}}  \n\n@slack-dd-perf-sys"
  'multi': true
  'name': '[Perf] [sys] % CPU'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 95.0
      'warning': 85.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:system.cpu.user{environment:performance}
    by {host} + avg:system.cpu.system{environment:performance} by {host} > 95'
  'restricted_roles': null
  'tags':
  - 'env:performance'
  - 'sys'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:data-tests,feature_name:engagement-scoring}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-integ}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Connections]
    Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:integration,type:mongo,feature_name:orca}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': "{{#is_alert}}\n  \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \  \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Lead-Scoring] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:lead-scoring,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production,feature_name:pardot-fetcher}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Engagement-Scoring]
    Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:engagement-scoring,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'engagement-scoring'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Containers] [Pardot Fetcher]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:data-tests,feature_name:pardot-fetcher,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'containers'
  - 'anomaly'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': 'A query should be running in Splunk
    every 4 hours to validate that all voice calls processes will finish in the specified
    SLA.

    If a voice call does not finish within the SLA an alert is sent from Splunk to
    Datadog and is monitored by https://app.datadoghq.com/monitors/17120873.


    To make sure the job is running every 4 hours in Splunk, there is an alert that
    needs to be sent to Datadog from Splunk confirming there is no problem with the
    specified job.

    If Datadog does not receive an alert every 4 hours -> this monitor will create
    an alert indicating that the job is not running.'
  'name': 'production: Splunk Tracking Pipeline
    - job is running'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'events(''sources:splunk priority:all
    "production: Splunk Tracking Pipeline job is running"'').rollup(''count'').last(''4h'')
    <= 0'
  'restricted_roles': null
  'type': 'event alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo,feature_name:oppcasting}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': '.'
  'name': '[Data-tests-dev] [Oppcasting] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-oc-dt-dev}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for oppty-scoring-training-cycle-small
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/oppty-scoring-training-cycle-small:runtime,type:oppty-scoring-training}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:integration,type:mongo,feature_name:campaign-insights}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-siq-fetcher-fetch-chunk
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/celery-siq-fetcher-fetch-chunk:runtime,type:fetcher-worker,environment:pilot-staging}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:production,type:mongo,feature_name:pardot-fetcher}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': '***Notifying***

    ---Bananas---

    Bananas Engine have found new GDPR requests!

    ```

    **Notified:**

    - @slack-bot-team-bonobo-alerts-research

    - @bonobo_dev@salesforce.com

    ```'
  'name': '[bananas-engine] New GDPR Requests!'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'sum(last_1m):avg:conv_ai.bananas{*}.as_count()
    > 0'
  'restricted_roles': null
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-lead-scoring-main
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-main:runtime,type:lead-scoring-main-service}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:production,feature_name:core-fetcher,pod:pod00}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'mongo'
  - 'pod00'
  'type': 'query alert'

- 'message': '{{value}}'
  'name': '[Prod] [Canary] [Pod00] [App] [Lead-Scoring]
    [SEV0] Lead-Scoring Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:lead-scoring,canary:true,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'canary'
  - 'lead-scoring'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Queue]  Queued
    read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:data-tests,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Engagement-Scoring]
    Disk space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:engagement-scoring,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Attribution] Number of containers
    for attribution-tenant-cycle in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:attribution,implisit_service:implisit/attribution-tenant-cycle:runtime,environment:production,type:attribution}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'attribution'
  - 'env:production'

- 'message': "{{#is_alert}}\ntid:100 env:pilot-staging\
    \ cycle took {{value}} minutes.\n{{/is_alert}}  \n{{#is_no_data}}\nNo data entry\
    \ in the past 60 minutes.\n{{/is_no_data}}\n@slack-dd-p-staging-app"
  'name': '[p-staging] [app] Cycle time on tid:100'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 45.0
    'timeout_h': 0
  'query': 'max(last_30m):max:orca.module.tenant_run.run_full_cycle.time.max{environment:pilot-staging,tid:100}.as_count()
    / 60000 > 45'
  'restricted_roles': null
  'tags':
  - 'team:testorgs'
  - 'app'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Oppcasting] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-oc-prod-pod01}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:attribution,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Infra] AWS
    Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-ls-staging-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Lead-Scoring] [Infra]
    Integration - Fetched data core to Lead-Scoring'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:integration,feature_name:lead-scoring},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'lead-scoring'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Core-Fetcher] [Pod00]
    [Infra] RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:integration,rabbitmq_vhost:corefetcher,pod:pod00}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}} \nThis can cause significant\
    \ cycle degradation until Redis is cleaned.\n{{/is_alert}}\n\n{{#is_recovery}}\
    \  \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Cycle Degradation Case] Duration
    of pre-cycle-run flow in minutes'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
      'warning': 4.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:orca.module.tenant_run.pre_cycle_run.time.avg{environment:production}
    by {feature_name} / 1000 / 60 > 5'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n@pagerduty-Ofek-Datadog \n{{/is_alert}}\n\n{{#is_warning}}\n\
    Cache usage on {{host.name}} is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'avg(last_4h):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:production}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:production}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [sys] [Core-Fetcher]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n@slack-dd-prod\
      \ \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-prod \n\
      {{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:pilot-staging,type:mongo,feature_name:oppcasting}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:integration,type:mongo,feature_name:lead-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [app] MongoDB Replica
    with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'cross-features'
  - 'mongo'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n@obachner@salesforce.com"
  'multi': true
  'name': '[Perf] [Ofer] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:performance","process:mongo").exclude("host:performance-mongo-1-0","host:performance-mongo-1-1","host:performance-mongo-1-2","host:performance-mongo-2-0","host:performance-mongo-2-1","host:performance-mongo-2-2","host:performance-mongo-3-0","host:performance-mongo-3-1","host:performance-mongo-3-2","host:performance-mongo-4-0","host:performance-mongo-4-1","host:performance-mongo-4-2","host:performance-mongo-5-1","host:performance-mongo-5-2","host:performance-mongo-5-0","host:performance-mongo-6-0","host:performance-mongo-6-1","host:performance-mongo-6-2","host:performance-mongo-7-0","host:performance-mongo-7-1","host:performance-mongo-7-2","host:performance-mongo-8-0","host:performance-mongo-8-1","host:performance-mongo-8-2","host:performance-mongo-9-0","host:performance-mongo-9-1","host:performance-mongo-9-2","host:performance-mongo-10-0","host:performance-mongo-10-1","host:performance-mongo-10-2","host:performance-mongo-11-0","host:performance-mongo-11-1","host:performance-mongo-11-2").by("host","process").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:performance'
  - 'temp'
  'type': 'service check'

- 'message': '.'
  'name': '[Prod] [Orca] [Infra] RabbitMQ - Messages
    waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:production,rabbitmq_vhost:orca}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'orca'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:data-tests,type:mongo,feature_name:engagement-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:pilot-staging,feature_name:core-fetcher,pod:pod00}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo,feature_name:lead-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Eng. Scoring]
    Number of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/celery-system-alerts:runtime,type:engagement-scoring-pusher-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for celery-oppcasting-pusher in {{host.name}}
    is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppcasting-pusher:runtime,type:oppcasting-pusher-canary}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [app] MongoDB
    Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production,feature_name:lead-scoring}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'lead-scoring'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'name': '[Prod] [Pod00] [App] [Core-Fetcher] [SEV1]
    Core-Fetcher Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1500.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:core-fetcher,pod:pod00,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1500'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'
  - 'app'
  - 'sev1'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [app] MongoDB
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo","feature_name:orca").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'orca'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Prod] [Pod00] [App] [Lead-Scoring] Failed
    Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:production,feature_name:lead-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) > 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'lead-scoring'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Containers] [Pardot Fetcher]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:integration,feature_name:pardot-fetcher}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'anomaly'
  - 'env:integration'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [All] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'cross-features'

- 'message': '---PRODUCTION---

    SQS - Oldest message in the queue is older than 3 days

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```'
  'name': '[Bnbo] [prod] [SQS] oldest messages queue'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      SQS - Oldest message in the queue is older than 3 days

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```'
    'evaluation_delay': 600
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 259800.0
    'timeout_h': 0
  'query': 'sum(last_2h):max:aws.sqs.approximate_age_of_oldest_message{queuename:production-conv-ai-speech-engine}
    > 259800'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'SQS'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Campaign-Insights] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:campaign-insights,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': 'Value: {{value}}  <  Threshold: {{threshold}}  in
    the last hour'
  'name': '[Prod] [Canary] [Pod01] [App] [Core-Fetcher]
    [SEV0] Core-Fetcher Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:core-fetcher,canary:true,pod:pod01,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'canary'
  - 'core-fetcher'
  - 'pod01'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Sys]
    [Mongo]  % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:engagement-scoring,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo","feature_name:campaign-insights").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'campaign-insights'
  'type': 'service check'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [app] MongoDB is
    down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo","feature_name:orca").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'orca'
  'type': 'service check'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [app] MongoDB
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo","feature_name:oppcasting").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'oppcasting'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:production,type:mongo,feature_name:campaign-insights}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging,feature_name:lead-scoring}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging,feature_name:lead-scoring}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:pilot-staging'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "---PRODUCTION---\n{{host.name}} -\
    \ RMQ Job is down\n## Check out some extra data on the:\n[Bonobo _extra detailed_\
    \ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-production  \n- @bonobo_dev@salesforce.com\n\
    ```"
  'multi': true
  'name': '[Bnbo] [prod] [RMQ] Job is up'
  'options':
    'escalation_message': "***Renotifying***\n---PRODUCTION---\n\
      {{host.name}} - RMQ Job is down\n## Check out some extra data on the:\n[Bonobo\
      \ _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
      ```\n**Notified:**\n- @slack-team-bonobo-alerts-production \n- @bonobo_dev@salesforce.com\n\
      ```"
    'include_tags': true
    'locked': true
    'new_host_delay': 3609
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'avg(last_2h):avg:rabbitmq.node.running{env:production,inst_type:docker-services-bonobo}
    by {host} < 1'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'rabbitmq'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:lead-scoring,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n{{/is_alert}}  \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal \n{{/is_recovery}}  \n@slack-dd-perf-sys"
  'multi': true
  'name': '[rule_test] [sys] % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-perf-sys'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 30
    'notify_audit': true
    'renotify_interval': 20
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_10m):min:system.swap.pct_free{environment:performance}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:performance'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:integration,feature_name:core-fetcher,pod:pod01}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'status'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:data-tests,type:mongo,feature_name:campaign-insights}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}\n\n@slack-dd-perf-app"
  'multi': true
  'name': '[Staging] [All] [Mongo] MongoDB Replica
    with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production,feature_name:core-fetcher,pod:pod00}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'
  - 'mongo'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:campaign-insights,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [All] [Infra] RabbitMQ - Messages
    waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:production}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Connections]
    Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:production,type:mongo}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Data-tests] [App] [All] Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:data-tests,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Orca] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:orca,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': 'In order to see results of the query
    in Splunk:

    Connect to Splunk in production

    Click on Search&Reporting -> Alerts -> Tracking Pipeline -> Find the alert that
    was triggered depending on the time -> View results


    Splunk runs a job every 4 hours to check if all voice calls that entered the pipeline
    finished successfully within the SLA.

    If there are voice calls that did not finish within the SLA, an alert will be
    sent from splunk to datadog creating an alert in this monitor.


    We are monitoring the job that runs the periodic query to make sure that it is
    running - https://app.datadoghq.com/monitors/17127662


    Pipeline tracking service and computation of the SLA is explained here - https://salesforce.quip.com/wZ2aAbLDo4sB'
  'name': 'production: Splunk Tracking Pipeline'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'events(''sources:splunk priority:all
    "production: Splunk Tracking Pipeline Alert"'').rollup(''count'').last(''4h'')
    > 0'
  'restricted_roles': null
  'type': 'event alert'

- 'message': '---PRODUCTION---

    Redis - No connections for more than 4 hours

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```'
  'multi': true
  'name': '[Bnbo] [prod] [Redis] current connections'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      Redis - No connections for more than 4 hours

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```'
    'evaluation_delay': 590
    'include_tags': false
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:aws.elasticache.curr_connections{replication_group:b-redis-production}
    by {name} < 1'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'redis'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nDisk space is low on\
    \ {{host.name}} - {{host.ip}}  - {{device.name}} - Value: {{value}} \n{{/is_alert}}\
    \ \n\n{{#is_recovery}}\nDisk space back to normal on {{host.name}} - {{host.ip}}\
    \  - {{device.name}} - Value: {{value}} \n {{/is_recovery}} \n\n{{#is_no_data}}\n\
    {{host.name}} {{device.name}} has not reported for 20 minutes \n{{/is_no_data}}\
    \ \n\n{{#is_no_data_recovery}}\n{{host.name}} {{device.name}} is reporting again\
    \ \n{{/is_no_data_recovery}} @slack-bot-datadog-build"
  'multi': true
  'name': '[Build] [sys] [Agents] Disk space is
    low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': "{{^is_alert}}\nDisk space\
      \ is still low on {{host.name}} ( {{device.name}} - Build )\n@slack-dd-build\
      \ \n{{/is_alert}}"
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 20
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 90.0
      'warning': 85.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:build,!host:build-jenkins-master}
    by {device,host} * 100 >= 90'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:build'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Pardot-Fetcher] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:integration,rabbitmq_vhost:pardot-fetcher}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'pardot-fetcher'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}\n\n@slack-dd-p-staging-app"
  'multi': true
  'name': '[p-staging] [app] MongoDB Replica with
    lag dangerous on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'

- 'message': '---PRODUCTION---

    {{host.base_name}} - RMQ no connections fo more than 2 hours


    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)'
  'multi': true
  'name': '[Bnbo] [prod] [RMQ] Connections'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      {{host.base_name}} - RMQ no connections fo more than 2 hours


      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)'
    'evaluation_delay': 590
    'include_tags': true
    'locked': true
    'new_host_delay': 3200
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'avg(last_2h):avg:rabbitmq.connections{env:production,inst_type:docker-services-bonobo}
    by {host} < 1'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'rabbitmq'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:lead-scoring,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on\
    \ {{host.name}} is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:production,feature_name:campaign-insights}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:production,feature_name:campaign-insights}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:production'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:integration,type:mongo,feature_name:oppcasting}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppcasting-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppcasting-pusher:runtime,type:oppcasting-pusher,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\nMongoDB swap use is\
    \ high on {{host.name}}  @slack-dd-p-staging-infra \n{{/is_alert}}"
  'multi': true
  'name': '[p-staging] [Infra] MongoDB swap use
    is high on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000000000.0
      'warning': 10000000000.0
    'timeout_h': 0
  'query': 'min(last_30m):avg:system.swap.used{type:mongo,environment:pilot-staging}
    by {host} > 20000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'

- 'message': "{{#is_alert}}Disk space is low on\
    \ {{host.name}} {{/is_alert}} \n{{#is_recovery}}Disk space back to normal on {{host.name}}\
    \ {{device.name}} {{/is_recovery}} \n@slack-dd-perf-sys"
  'multi': true
  'name': '[Perf] [sys] Disk space is low on {{host.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Performance)

      @slack-dd-perf-sys'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 0.8
    'timeout_h': 0
  'query': 'avg(last_10m):avg:system.disk.in_use{environment:performance,!device:shm,!device:tmpfs,!device:rootfs}
    by {device,host} >= 0.8'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:performance'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for campaign-insights
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:campaign-insights,implisit_service:implisit/celery-campaign-insights:runtime,type:campaign-insights}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod00,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [app] MongoDB
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo","feature_name:orca").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'orca'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Attribution] No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:attribution,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'attribution'

- 'message': "{{#is_alert}}\nMongoDB swap use is\
    \ high on {{host.name}}  \n{{/is_alert}}\n\n{{#is_alert_recovery}}\nRecovered\n\
    {{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Infra] MongoDB swap use
    is high on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20000000000.0
      'warning': 10000000000.0
    'timeout_h': 0
  'query': 'min(last_30m):avg:system.swap.used{type:mongo,environment:data-tests}
    by {host} > 20000000000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'sys'

- 'message': '--pilot-staging--

    {{host.base_name}} - Storage Usage is over 80% for more than 4 hours

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-pilot-staging

    - @bonobo_dev@salesforce.com

    ```'
  'multi': true
  'name': '[Bnbo] [stag] [K8S] Storage Usage'
  'options':
    'escalation_message': '***Renotifying***

      --pilot-staging--

      {{host.base_name}} - Storage Usage is over 80% for more than 4 hours

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-pilot-staging

      - @bonobo_dev@salesforce.com

      ```'
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': true
    'thresholds':
      'critical': 80.0
    'timeout_h': 0
  'query': 'avg(last_4h):max:system.disk.in_use{kubernetes_name_space:bonobo,env:pilot-staging}
    by {host} * 100 > 80'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'kubernetes'
  - 'sys'
  - 'storage'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:data-tests,type:mongo,feature_name:campaign-insights}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': ''
  'name': '[Prod] [Pod00] [App] [Attribution] Failed
    Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:production,feature_name:attribution,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'attribution'
  - 'pod00'
  - 'app'
  - 'status'
  - 'pagerduty'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for lead-scoring-tenant-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/lead-scoring-tenant-cycle:runtime,type:lead-scoring-tenant-cycle-canary}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'lead-scoring'

- 'message': '.'
  'name': '[Data-tests] [All] [Infra] Slack service
    delayed messages'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
      'warning': 5.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(max:aws.sqs.approximate_number_of_messages_delayed{queuename:data-tests-slack-service.fifo},
    0) > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'infra'
  - 'slack'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Camp. Insights]
    Number of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:campaign-insights,type:campaign-insights-pusher,implisit_service:implisit/celery-system-alerts:runtime}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Campaign-Insights]
    No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:campaign-insights,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:data-tests,type:mongo,feature_name:engagement-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Handles]
    WT caches open file handles in memory,'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging,feature_name:lead-scoring}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'lead-scoring'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Orca] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:orca,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'orca'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Attribution] [Infra] AWS
    Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-at-data-tests}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [All] [Mongo] MongoDB has
    too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:data-tests,feature_name:lead-scoring}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Sys] [Mongo] Disk space
    is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'cross-features'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Campaign-Insights] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-ci-staging-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Connections]
    Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:data-tests,type:mongo}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for core-fetcher
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:core-fetcher,implisit_service:implisit/core-fetcher:runtime,type:core-fetcher,!pod:pod01}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'core-fetcher'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-b2b-marketing
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:engagement-scoring,implisit_service:implisit/celery-b2b-marketing:runtime,type:engagement-scoring-worker,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'engagement-scoring'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for oppty-training-cycle-small in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/oppty-training-cycle-small:runtime,type:oppcasting-training}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:data-tests,type:mongo,feature_name:lead-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Sys]
    [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:engagement-scoring,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:pilot-staging,feature_name:lead-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Lead-Scoring] %
    Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:lead-scoring,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "--pilot-staging--\n{{host.base_name}}\
    \ - RMQ - Memory Alerts on rabbitmq_node.name\n## Check out some extra data on\
    \ the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
    ```"
  'multi': true
  'name': '[Bnbo] [stag] [RMQ] Memory Alerts'
  'options':
    'escalation_message': "***Renotifying***\n--pilot-staging--\n\
      {{host.base_name}} - RMQ - Memory Alerts on rabbitmq_node.name\n## Check out\
      \ some extra data on the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
      ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
      ```"
    'evaluation_delay': 590
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'max(last_30m):avg:rabbitmq.node.mem_alarm{type:bonobo_services,env:pilot-staging}
    by {rabbitmq_node} > 0'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'rabbitmq'
  - 'sys'
  - 'memory'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:integration,type:mongo,feature_name:campaign-insights}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging,feature_name:core-fetcher,pod:pod01}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Connections]
    Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:integration,type:mongo,feature_name:orca}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': "{{#is_alert}}\n  \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \  \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Pardot-Fetcher] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:pardot-fetcher,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Core Fetcher] Number
    of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:core-fetcher,type:core-fetcher,implisit_service:implisit/celery-system-alerts:runtime}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'core-fetcher'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [sys] [Orca] Clock in sync
    with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration","feature_name:orca").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'orca'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:engagement-scoring,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Attribution] Number
    of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{implisit_service:implisit/celery-system-alerts:runtime,feature_name:attribution,environment:production,type:attribution-pusher}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'attribution'
  - 'env:production'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:production,type:mongo,feature_name:lead-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-forecast-worker in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,type:oppcasting-forecasting,implisit_service:implisit/celery-forecast-worker:runtime,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Campaign-Insights]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:campaign-insights,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Connections]
    Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:pilot-staging,type:mongo}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': '.'
  'name': '[Integration] [Orca] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:integration,rabbitmq_vhost:orca}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'orca'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "The `research` standalone instance\
    \ `{{name.name}}` is over 8 days old\n\n1. Check Slack channel [#research-ops](https://implisit.slack.com/messages/C8XSG1WB0/)\
    \ for `automatically-delete-standalone-instance` Jenkins job failures.\n1. Go\
    \ to the [`automatically-delete-standalone-instance` Jenkins job](http://localhost:5000/job/automatically-delete-standalone-instance)\
    \ (first connect with **`dog.py connect jenkins research`**).\n @obachner@salesforce.com\
    \ @slack-bot-datadog-research"
  'multi': true
  'name': 'Research standalone instance over 8 days
    old - {{name.name}}'
  'options':
    'escalation_message': null
    'evaluation_delay': 1000
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': false
    'thresholds':
      'critical': 820800.0
      'warning': 777600.0
    'timeout_h': null
  'query': 'avg(last_1h):max:aws.ec2.instance_age{inst_type:standalone}
    by {name} > 820800'
  'restricted_roles': null
  'tags':
  - 'GDPR'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [sys] [Oppcasting] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests-dev,feature_name:oppcasting,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:data-tests,feature_name:attribution}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [sys] [Core-Fetcher] %
    CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n@slack-dd-prod\
      \ \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-prod \n\
      {{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [All] % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'cross-features'

- 'message': "{{#is_alert}}\nLow Celery Tasks Count\n\
    @slack-dd-p-staging-sys \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    @slack-dd-p-staging-sys \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n@slack-dd-p-staging-sys \n{{/is_no_data_recovery}}"
  'name': '[Staging] Celery - Attribution - Count
    celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 300.0
    'timeout_h': 0
  'query': 'sum(last_30m):max:orca.orca.celery_task.time.count{environment:pilot-staging,feature_name:attribution}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'env:pilot-staging'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n\n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:core-fetcher,type:mongo,pod:pod01,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}} \n\
    {{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [sys] [Core-Fetcher]
    Disk space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production,feature_name:core-fetcher,pod:pod01}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'env:production'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:integration,type:mongo,feature_name:orca}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] Zookeeper integration
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 2
    'renotify_interval': 20
    'thresholds':
      'critical': 3
    'timeout_h': 0
  'query': '"zookeeper.ruok".over("environment:pilot-staging").by("host","port").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:data-tests,type:mongo,feature_name:engagement-scoring}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Connections]
    Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:integration}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Lead Scoring]
    Number of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:lead-scoring,type:lead-scoring-fetcher,implisit_service:implisit/celery-pusher:runtime,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:pilot-staging'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:data-tests,feature_name:lead-scoring}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'lead-scoring'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo,feature_name:engagement-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [All] Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'cross-features'

- 'message': '.'
  'name': '[Data-tests] [All] [Infra] Slack service
    sent messages is low'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
      'warning': 5.0
    'timeout_h': 0
  'query': 'sum(last_1d):default(sum:aws.sqs.number_of_messages_sent{queuename:data-tests-slack-service.fifo}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'infra'
  - 'slack'
  - 'status'
  'type': 'query alert'

- 'message': '.}'
  'name': '[Data-tests] [All] [Infra] Fetcher -
    Pardot Fetch - Objects'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_1d):avg:pardot.fetch_records{environment:data-tests}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:integration,type:mongo,feature_name:attribution}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:pilot-staging,feature_name:core-fetcher,pod:pod00}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Lead Scoring]
    Number of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:lead-scoring,implisit_service:implisit/celery-beat:runtime,type:lead-scoring-celery-beat,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:oppcasting,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Lead-Scoring] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:lead-scoring,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:data-tests,feature_name:core-fetcher}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:campaign-insights,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Data-tests] [App] [Lead-Scoring] Failed
    Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:data-tests,feature_name:lead-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'lead-scoring'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Orca] [Infra] Integration
    - Pushed data from Orca to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:integration,feature_name:orca}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'orca'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:core-fetcher,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Sys] [Mongo] % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}}\n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Handles]
    WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:integration}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'cross-features'
  - 'env:integration'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [Attribution] [Infra] AWS
    Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-at-data-tests}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Attribution] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:attribution,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': ''
  'name': '[Data-tests-dev] [App] [Oppcasting] [SEV0]
    Oppcasting Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:data-tests-dev,feature_name:oppcasting,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'oppcasting'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for celery-oppty-scoring-light in {{host.name}}
    is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppty-scoring-light:runtime,type:oppcasting-training-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo,feature_name:lead-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging,feature_name:pardot-fetcher}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration,feature_name:core-fetcher,pod:pod01}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'
  - 'mongo'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] Celery - Count celery
    tasks'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 300.0
    'timeout_h': 0
  'query': 'sum(last_15m):default(avg:orca.orca.celery_task.time.count{env:production}
    by {feature_name}.as_count(),0) < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'cross-features'
  - 'env:production'
  - 'infra'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Containers] [Offline Jobs]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_5m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_1h):anomalies(sum:docker.containers.running{feature_name:offline-jobs,environment:data-tests,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_5m'',
    interval=20, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'anomaly'
  - 'offline-jobs'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Containers] [Offline Jobs] Number
    of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_5m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_1h):anomalies(sum:docker.containers.running{environment:production,feature_name:offline-jobs,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_5m'',
    interval=20, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'containers'
  - 'anomaly'
  - 'offline-jobs'
  - 'pagerduty'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Orca] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-orca-integration}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Orca] % Usable Memory on
    {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:orca,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': "--pilot-staging--\nThere are stuck\
    \ messages in the queue for more than 4 hours\n## Check out some extra data on\
    \ the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
    ```"
  'name': '[Bnbo] [stag] [SQS] Stuck Messages In
    Queue'
  'options':
    'escalation_message': "***Renotifying***\n--pilot-staging--\n\
      There are stuck messages in the queue for more than 4 hours\n## Check out some\
      \ extra data on the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
      ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
      ```"
    'evaluation_delay': 600
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 0.9
    'timeout_h': 0
  'query': 'avg(last_4h):( avg:aws.sqs.number_of_messages_sent{queuename:pilot-staging-conv-ai-speech-engine}.as_count()
    + 1 ) / ( avg:aws.sqs.number_of_messages_received{queuename:pilot-staging-conv-ai-speech-engine}.as_count()
    + 1 ) < 0.9'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'SQS'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{type.name}} \n{{host.name}}:\
    \ Low usable memory: {{value}} \n{{/is_alert}} \n\n{{#is_recovery}}\n{{type.name}}\
    \ \n{{host.name}}: Disk usage back to normal \n{{/is_recovery}}  \n@slack-dd-p-staging-sys"
  'multi': true
  'name': '[p-staging] [sys] % Usable Memory on
    {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-p-staging-sys'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 30
    'notify_audit': true
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 1
  'query': 'avg(last_15m):min:system.mem.pct_usable{environment:pilot-staging}
    by {host,type} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-forecast-subworker in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,type:oppcasting-forecasting,implisit_service:implisit/celery-forecast-subworker:runtime,environment:integration}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:core-fetcher,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [All] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-data-tests}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Orca] Number
    of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/celery-beat:runtime,type:orca,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Sys] [Mongo]  % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:data-tests-dev,type:mongo,feature_name:oppcasting}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': '.'
  'name': '[Prod] [Oppcasting] [Infra] Celery -
    Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:production,feature_name:oppcasting}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'oppcasting'
  - 'env:production'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:orca,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'orca'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Engagement-Scoring]
    % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:engagement-scoring,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:integration,feature_name:pardot-fetcher}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Sys] [Mongo] %
    CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:orca,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo,feature_name:lead-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': '.'
  'name': '[Staging] [All] [Infra] Slack service
    sent messages is low'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
      'warning': 5.0
    'timeout_h': 0
  'query': 'sum(last_1d):default(sum:aws.sqs.number_of_messages_sent{queuename:pilot-staging-slack-service.fifo}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'infra'
  - 'slack'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppty-scoring:runtime,type:oppcasting-worker}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging,feature_name:oppcasting}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging,feature_name:oppcasting}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:pilot-staging'
  - 'oppcasting'
  'type': 'query alert'

- 'message': 'Value: {{value}} < {{threshold}}'
  'name': '[Prod] Full Cycle Count Last 24H (Mongo0
    - Mongo2) < 2000'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 1900.0
    'timeout_h': 0
  'query': 'sum(last_4h):sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,mongo:mongo-0.vpc-internal}.as_count()
    < 1900'
  'restricted_roles': null
  'tags':
  - 'pagerduty'
  - 'status'
  - 'env:production'
  - 'mongocycles'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Prod] [Pod01] [App] [Oppcasting] Failed
    Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:production,feature_name:oppcasting,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) > 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_no_data}} \n{{/is_no_data}} \n\n{{#is_no_data_recovery}} \n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}} \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Orca] % Usable Memory
    on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-prod'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:orca,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': '{{#is_alert}}

    Lead Scoring deployment pipeline Prod - Failure

    {{/is_alert}}'
  'multi': true
  'name': '[Prod] [Lead Scoring] Deployment Pipeline
    - Success/Failure'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"jenkins.job.status".over("host:impl-jenkins-production.pod00-CD","job:lead-scoring/production-pod00/pipeline").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'app'
  - 'pipeline'
  - 'lead-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Offline Jobs] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:offline-jobs,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Engagement-Scoring] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:integration,rabbitmq_vhost:engagement-scoring}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'engagement-scoring'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Handles]
    WT caches open file handles in memory,'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:data-tests,type:mongo}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo,feature_name:oppcasting}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': '.'
  'name': '[Prod] [All] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-production}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:attribution,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Sys]
    [Mongo]  % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:pardot-fetcher,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:production,type:mongo,feature_name:campaign-insights}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration,feature_name:campaign-insights}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'campaign-insights'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:production,feature_name:campaign-insights}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:production,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:pardot-fetcher,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Integration] [Attribution] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:integration,feature_name:attribution}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'attribution'
  - 'env:integration'
  - 'infra'
  'type': 'query alert'

- 'message': '@pagerduty-Ofek-Datadog @slack-sev0-1'
  'name': '[Prod] [App] [All] [SEV0] All Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,canary:false,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'sev0'
  - 'app'
  - 'pagerduty'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:orca,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [sys] [Core-Fetcher] Load
    average (norm.15)'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Handles]
    WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo,feature_name:orca}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': "{{#is_alert}}\n \n \n{{value}} \n\
    {{/is_alert}} \n\n\n{{#is_recovery}}\n \n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo,feature_name:pardot-fetcher}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Connections]
    Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:integration,type:mongo}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Cursor]
    Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:data-tests,type:mongo,feature_name:orca}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Queue]  Queued
    read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo,feature_name:attribution}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}}\n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:data-tests,type:mongo,feature_name:core-fetcher}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}   \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}   \n{{/is_no_data}} \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal  \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again  \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [sys] [Core-Fetcher] %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on\
    \ {{host.name}} is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] Mongo % Cache
    usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:production,feature_name:oppcasting}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:production,feature_name:oppcasting}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:production'
  - 'oppcasting'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [All] [Infra] Slack service
    delayed messages'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
      'warning': 5.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(max:aws.sqs.approximate_number_of_messages_delayed{queuename:integration-slack-service.fifo},
    0) > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'infra'
  - 'slack'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [All] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'cross-features'

- 'message': '.}'
  'name': '[Integration] [All] [Infra] Fetcher -
    Pardot Fetch - Objects'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_1d):avg:pardot.fetch_records{environment:integration}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo,feature_name:pardot-fetcher}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:data-tests,feature_name:core-fetcher}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:data-tests,feature_name:attribution}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:data-tests,feature_name:attribution}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:data-tests'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:integration,feature_name:engagement-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [app] MongoDB
    Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging,feature_name:orca}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'orca'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Connections]
    Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:data-tests,type:mongo,feature_name:orca}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Cursor]
    Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:pilot-staging,type:mongo,feature_name:orca}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [organization-data-sync]
    [SQS]: Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-organization-data-sync}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:pilot-staging,type:mongo,feature_name:lead-scoring}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:integration,feature_name:engagement-scoring}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'engagement-scoring'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo,feature_name:pardot-fetcher}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Oppcasting] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:oppcasting,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Sys] [Mongo] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:orca,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] Mongo
    % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging,feature_name:pardot-fetcher}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging,feature_name:pardot-fetcher}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:pilot-staging'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Staging] [Pod01] [App] [Oppcasting]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:pilot-staging,feature_name:oppcasting,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'oppcasting'
  - 'pod01'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [Pod01] [sys] [Core-Fetcher]
    Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging","feature_name:core-fetcher","pod:pod01").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod01'
  'type': 'service check'

- 'message': '.'
  'name': '[Integration] [Oppcasting] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:integration,feature_name:oppcasting}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'oppcasting'
  - 'env:integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Campaign-Insights] No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:campaign-insights,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'campaign-insights'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [sys] [Core-Fetcher]
    Load average (norm.15)'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:integration,type:mongo,feature_name:oppcasting}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Pardot-Fetcher] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:pardot-fetcher,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Core-Fetcher] [Pod01] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-cf-staging-pod01}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring-light in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,type:oppcasting-training,implisit_service:implisit/celery-oppty-scoring-light:runtime,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': '.'
  'name': '[Integration] [Core-Fetcher] [Pod00]
    [Infra] Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:integration,feature_name:core-fetcher,pod:pod00}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'core-fetcher'
  - 'pod00'
  - 'env:integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:integration,type:mongo,feature_name:attribution}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:integration,feature_name:core-fetcher,pod:pod00}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': '.'
  'name': '[Integration] [Engagement-Scoring] [Infra]
    Integration - Pushed data from Engagement-Scoring to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:integration,feature_name:engagement-scoring}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'engagement-scoring'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:data-tests,type:mongo,feature_name:lead-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n@pagerduty-Ofek-Datadog \n{{/is_alert}} \n\n{{#is_recovery}}\n\
    \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Sys] [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'cross-features'
  - 'pagerduty'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [Core-Fetcher] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:data-tests,feature_name:core-fetcher}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'core-fetcher'
  - 'env:data-tests'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Sys]
    [Mongo]  No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:core-fetcher,!type:jungle,type:mongo,pod:pod00}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'core-fetcher'
  - 'pod00'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration,feature_name:oppcasting}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': '{{#is_alert}}

    #

    {{/is_alert}}'
  'multi': true
  'name': 'Elie''s 3'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1h):avg:docker.containers.running{type:jenkins-slave,!docker_image:187473451979.dkr.ecr.us-west-2.amazonaws.com/datadog:20190815t132118_c7b7798b,!image_name:sha256,!short_image:sha256}
    by {docker_image} >= 1'
  'restricted_roles': null

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Engagement-Scoring]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:engagement-scoring,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Mongo Cursor]
    Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:integration,type:mongo,feature_name:orca}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] Zookeeper
    Number of queued requests in the server: {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 10.0
      'warning': 8.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.outstanding_requests{environment:integration}
    by {name} > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for core-fetcher
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:core-fetcher,implisit_service:implisit/core-fetcher:runtime,type:core-fetcher,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'core-fetcher'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:pardot-fetcher,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Containers] [Attribution]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:data-tests,feature_name:attribution,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'containers'
  - 'anomaly'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Queue]
    Queued read requests'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Data-tests] [sys] [Orca] Clock in sync
    with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests","feature_name:orca").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'orca'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppcasting-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppcasting-pusher:runtime,type:oppcasting-pusher}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:orca,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'orca'

- 'message': '.'
  'name': '[Staging] [All] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-staging-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for oppty-training-cycle-small in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/oppty-training-cycle-small:runtime,type:oppcasting-training,environment:integration}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:data-tests,type:mongo,feature_name:core-fetcher}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Sys]
    [Mongo]  Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:pardot-fetcher,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:pilot-staging,feature_name:core-fetcher,pod:pod01}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Sys]
    [Mongo]  % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:campaign-insights,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'campaign-insights'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Containers] [Core Fetcher]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:pilot-staging,feature_name:core-fetcher,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'containers'
  - 'anomaly'
  - 'core-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Staging] [Pod01] [App] [Core-Fetcher]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:pilot-staging,feature_name:core-fetcher,pod:pod01,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': '---PRODUCTION---

    {{host.base_name}} - CPU Usage is over 80% for the last 4 hours

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```'
  'multi': true
  'name': '[Bnbo] [prod] [K8S] CPU Usage'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      {{host.base_name}} - CPU Usage is over 80% for the last 4 hours

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```'
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 80.0
    'timeout_h': 0
  'query': 'avg(last_4h):( ( max:kubernetes.cpu.usage.total{env:production,kubernetes_name_space:bonobo}
    by {host} / 1000000000 ) / avg:kubernetes.cpu.capacity{env:production,kubernetes_name_space:bonobo}
    by {host} ) * 100 > 80'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'kubernetes'
  - 'sys'
  - 'cpu'
  'type': 'query alert'

- 'message': '@hadar.sabag@salesforce.com @slack-dd-prod'
  'name': 'AWS EC2 Maintenance'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 0
    'timeout_h': 0
  'query': 'events(''sources:ec2 priority:all'').rollup(''count'').last(''2d'')
    > 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'ec2'
  - 'aws'
  'type': 'event alert'

- 'message': '.'
  'name': '[Staging] [Pardot-Fetcher] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:pilot-staging,feature_name:pardot-fetcher}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'pardot-fetcher'
  - 'env:pilot-staging'
  - 'infra'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Engagement-Scoring] [Infra] AWS
    Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-es-production-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n \n\
    {{/is_alert}} \n\n{{#is_no_data}}\n \n \n{{host.name}} \n{{/is_no_data}} \n\n\
    {{#is_alert_recovery}}\n \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n\
    \ \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Sys] [Mongo]  No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:orca,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'orca'

- 'message': '@pagerduty-Ofek-Datadog'
  'name': '[App] [Orca] Low Number Of Opp Insights
    (<10k 24h)'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10000.0
    'timeout_h': 0
  'query': 'sum(last_1d):sum:orca.push_insights.TaskOverdue.new{environment:production}.as_count()
    + sum:orca.push_insights.ReEngaged.new{environment:production}.as_count() + sum:orca.push_insights.DealSlowing.new{environment:production}.as_count()
    + sum:orca.push_insights.CloseDateOverdue.new{environment:production}.as_count()
    + sum:orca.push_insights.AmountOutlier.new{environment:production}.as_count()
    + sum:orca.push_insights.WinningUnlikely.new{environment:production}.as_count()
    + sum:orca.push_insights.ContactLeaving.new{environment:production}.as_count()
    + sum:orca.push_insights.NoFutureActivity.new{environment:production}.as_count()
    + sum:orca.push_insights.ProspectUnresponsive.new{environment:production}.as_count()
    + sum:orca.push_insights.TimeConsumingOpportunity.new{environment:production}.as_count()
    < 10000'
  'restricted_roles': null
  'tags':
  - 'pagerduty'
  - 'env:production'
  - 'orca'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Sys] [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:pilot-staging,type:mongo,feature_name:campaign-insights}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Staging] [Attribution] [Infra] Integration
    - Pushed data from Attribution to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:pilot-staging,feature_name:attribution}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'attribution'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Sys]
    [Mongo]  Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:campaign-insights,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'name': '[Data-tests] [All] [Infra] RDS Low Memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 20.0
    'timeout_h': 0
  'query': 'avg(last_30m):( avg:aws.rds.memory.free{name:jungle-data-tests}
    / avg:aws.rds.memory.total{name:jungle-data-tests} ) * 100 < 15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'infra'
  - 'rds'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Queue]
    Queued write requests'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:integration,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Sys] [Mongo] Load
    average (norm.15)'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': "System load average is high on {{host.name}}\
    \ \n\n@slack-dd-data-tests"
  'multi': true
  'name': '[Data-tests] [sys] Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.5
    'timeout_h': 0
  'query': 'avg(last_15m):avg:system.load.norm.15{environment:data-tests}
    by {host} > 1.5'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:data-tests'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [sys] [Oppcasting] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests-dev,feature_name:oppcasting,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'sys'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:pardot-fetcher,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:production,type:mongo,feature_name:engagement-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Camp. Insights]
    Number of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:campaign-insights,implisit_service:implisit/celery-pusher:runtime,type:campaign-insights-pusher-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Prod] [Core-Fetcher] [Pod00] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:production,feature_name:core-fetcher,pod:pod00}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'core-fetcher'
  - 'env:production'
  - 'pod00'
  - 'infra'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [sys] [Oppcasting] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration","feature_name:oppcasting").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'oppcasting'
  'type': 'service check'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Containers] [Attribution] Number
    of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:production,feature_name:attribution,!implisit_service:implisit/poststop:runtime,!implisit_service:implisit/prestart:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'containers'
  - 'anomaly'
  - 'attribution'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [Core-Fetcher] [Infra] AWS
    Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-cf-data-tests}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'core-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [All] [Infra] Fetcher -
    SIQ Objects Fetched (< 100 4H)'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 100.0
    'timeout_h': 0
  'query': 'sum(last_4h):avg:orca.siq.fetch.object_fetches{environment:data-tests}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'integration'
  - 'infra'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] Zookeeper Number
    of queued requests in the server: {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 10.0
      'warning': 8.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.outstanding_requests{environment:production}
    by {name} > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Offline-Jobs] %
    Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:offline-jobs,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] Zookeeper Number
    of queued requests in the server: {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 10.0
      'warning': 8.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.outstanding_requests{environment:pilot-staging}
    by {name} > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Connections]
    Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:data-tests,feature_name:orca}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'cross-features'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-production}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:pilot-staging,feature_name:lead-scoring}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'lead-scoring'
  - 'mongo'
  'type': 'query alert'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [Production] [voice-call-download]
    [SQS]: Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'critical_recovery': 800.0
      'warning': 1300.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:production-conv-ai-voice-call-download}
    > 2000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_no_data}} \n{{/is_no_data}}\
    \ @slack-org-62"
  'name': '[Org62] Alert: More than 12 hours have
    passed since last cycle on t_id:167'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 720
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1d):sum:orca.module.tenant_run.run_full_cycle.time.count{tid:167}.as_count()
    < 1'
  'restricted_roles': null
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Core-Fetcher] [Pod01] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-cf-staging-pod01}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Camp. Insights]
    Number of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:campaign-insights,implisit_service:implisit/celery-pusher:runtime,type:campaign-insights-pusher}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'campaign-insights'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}

    @slack-dd-data-tests'
  'multi': true
  'name': '[Data-tests] MongoDB has too many open
    files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': null
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:data-tests}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:attribution,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'attribution'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Campaign-Insights] [Infra] Integration
    - Pushed data from Campaign-Insights to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:production,feature_name:campaign-insights}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'campaign-insights'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Integration] [Pod01] [App] [Oppcasting]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:integration,feature_name:oppcasting,!sfenv:stmp1}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'oppcasting'
  - 'pod01'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production,feature_name:oppcasting}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'oppcasting'
  - 'env:production'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Lead-Scoring] [Infra]
    Integration - Pushed data from Lead-Scoring to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:integration,feature_name:lead-scoring}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'lead-scoring'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:data-tests,feature_name:pardot-fetcher}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:pilot-staging,feature_name:pardot-fetcher}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'pardot-fetcher'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-b2b-marketing
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/celery-b2b-marketing:runtime,type:engagement-scoring-worker-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': '123'
  'multi': true
  'name': 'Slave 5'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 7.0
    'timeout_h': 0
  'query': 'min(last_1m):default(sum:docker.containers.running{type:jenkins-slave,docker_image:187473451979.dkr.ecr.us-west-2.amazonaws.com/jenkins-slave:20190512t110335_2c2d30c7,instance-type:m4.2xlarge}
    by {host,inst_type}, 0) > 7'
  'restricted_roles': null
  'type': 'query alert'

- 'message': '---PRODUCTION---

    {{host.base_name}} - Job is down for the last 2 hours


    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)'
  'multi': true
  'name': '[Bnbo] [prod] [K8S] Job Is Up'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      {{host.base_name}} - Job is down for the last 2 hours


      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)'
    'include_tags': true
    'locked': true
    'new_host_delay': 3600
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'avg(last_2h):avg:kubernetes.pods.running{env:production,kubernetes_name_space:bonobo}
    by {host} < 1'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'kubernetes'
  - 'sys'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [All] [Infra] RabbitMQ - Messages
    waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:pilot-staging}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': '.'
  'name': '[Staging] [Engagement-Scoring] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:pilot-staging,rabbitmq_vhost:engagement-scoring}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'engagement-scoring'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Fault
    Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging,feature_name:orca}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [speech-engine]
    [SQS]: Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-speech-engine}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging,feature_name:oppcasting}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-forecast-worker in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,type:oppcasting-forecasting,implisit_service:implisit/celery-forecast-worker:runtime,environment:integration}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo","feature_name:engagement-scoring").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Orca] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:orca,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'orca'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Orca] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-orca-integration}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Cursor]
    Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo,feature_name:oppcasting}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [sys] [Core-Fetcher]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n@slack-dd-prod\
      \ \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n@slack-dd-prod \n\
      {{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Connections]
    Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:production,type:mongo}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'

- 'message': '.'
  'name': '[Data-tests] [Lead-Scoring] [Infra] AWS
    Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-ls-data-tests}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for celery-worker in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-worker:runtime,type:oppcasting-worker-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:attribution,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': "---PRODUCTION---\nRMQ - More than\
    \ 5K messages on rabbitmq_node.name\n## Check out some extra data on the:\n[Bonobo\
    \ _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-production \n- @bonobo_dev@salesforce.com\n\
    ```"
  'multi': true
  'name': '[Bnbo] [prod] [RMQ] messages'
  'options':
    'escalation_message': "***Renotifying***\n---PRODUCTION---\n\
      RMQ - More than 5K messages on rabbitmq_node.name\n## Check out some extra data\
      \ on the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
      ```\n**Notified:**\n- @slack-team-bonobo-alerts-production \n- @bonobo_dev@salesforce.com\n\
      ```"
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': 30
    'renotify_interval': 1440
    'require_full_window': true
    'thresholds':
      'critical': 5000.0
    'timeout_h': 2
  'query': 'avg(last_4h):sum:rabbitmq.queue.messages{env:production,type:bonobo_services}
    by {rabbitmq_node} > 5000'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'rabbitmq'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nMongoDB swap use is\
    \ high on {{host.name}}  @slack-dd-perf-infra \n{{/is_alert}}"
  'multi': true
  'name': '[Perf] [Infra] MongoDB swap use is high
    on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000000000.0
      'warning': 10000000000.0
    'timeout_h': 0
  'query': 'min(last_30m):avg:system.swap.used{type:mongo}
    by {host} > 20000000000'
  'restricted_roles': null
  'tags':
  - 'env:performance'
  - 'sys'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Cursor]
    Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:data-tests,type:mongo}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] Zookeeper (Only
    exposed by the leader) number of pending syncs from the followers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
      'warning': 8.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:zookeeper.pending_syncs{environment:production}
    by {name} > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'zookeeper'
  - 'infra'

- 'message': "{{#is_alert}}\n  \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \  \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Engagement-Scoring] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:engagement-scoring,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-forecast-subworker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 6.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,type:forecasting,implisit_service:implisit/celery-forecast-subworker:runtime}
    by {host} < 6'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:data-tests,type:mongo,feature_name:attribution}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': 'Value: {{value}} < {{threshold}}'
  'name': '[Prod] Full Cycle Count Last 24H (Mongo4)
    < 4'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
      'warning': 4.0
    'timeout_h': 0
  'query': 'sum(last_1d):sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,mongo:mongo-4.vpc-internal}.as_count()
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongocycles'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Oppcasting] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:oppcasting,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files\n \n {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [app] MongoDB
    has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production,feature_name:oppcasting}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:data-tests,type:mongo,feature_name:attribution}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:attribution,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-b2b-marketing
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/celery-b2b-marketing:runtime,type:engagement-scoring-worker}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [app] MongoDB
    Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration,feature_name:orca}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'orca'
  - 'mongo'

- 'message': '.'
  'name': '[Staging] [Lead-Scoring] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:pilot-staging,feature_name:lead-scoring}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'lead-scoring'
  - 'env:pilot-staging'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-worker:runtime,type:orca-worker}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n{{#is_alert}} \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}} \n\
    {{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] MongoDB is
    down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'cross-features'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Sys] [Mongo] Load
    average (norm.15)'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Containers] [Core Fetcher] Number
    of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:production,feature_name:core-fetcher,!implisit_service:implisit/poststop:runtime,!implisit_service:implisit/prestart:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'containers'
  - 'anomaly'
  - 'core-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Engagement-Scoring]
    Disk space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:engagement-scoring,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Connections]
    Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:pilot-staging,type:mongo}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Engagement-Scoring] No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:engagement-scoring,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Cursor]
    Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo,feature_name:orca}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [sys] [Engagement-Scoring] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production","feature_name:engagement-scoring").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'engagement-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}} \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}} \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [sys] [Core-Fetcher] No
    swap configured for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:core-fetcher,pod:pod00,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:pardot-fetcher,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Queue]  Queued
    write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:data-tests,feature_name:lead-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': '.'
  'name': '[Staging] [Core-Fetcher] [Pod01] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:pilot-staging,feature_name:core-fetcher,pod:pod01}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'core-fetcher'
  - 'env:pilot-staging'
  - 'pod01'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Staging] [Pod00] [App] [Orca] Failed
    Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:pilot-staging,feature_name:orca,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'orca'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Data-tests] [sys] [Attribution] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests","feature_name:attribution").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'attribution'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Attribution] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:attribution,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:integration,feature_name:campaign-insights}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'campaign-insights'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for predictor
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/predictor:runtime,type:predictor,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': '.'
  'name': '[Integration] [Oppcasting] [Infra] AWS
    Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-oc-integ-pod01}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "Value: {{value}} < {{threshold}} \n\
    @pagerduty-Ofek-Datadog"
  'name': '[Prod] [Orca] Full Cycle Count Last 24H
    (Mongo7 - Statefarm) < 2'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1d):sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,mongo:mongo-7.vpc-internal}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'pagerduty'
  - 'env:production'
  - 'orca'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Pardot-Fetcher] %
    Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:pardot-fetcher,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}} \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}} \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [sys] [Core-Fetcher] No
    swap configured for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:core-fetcher,pod:pod01,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-attribution-main
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:attribution,implisit_service:implisit/celery-attribution-main:runtime,type:attribution-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_no_data}} \n{{/is_no_data}} \n\n{{#is_no_data_recovery}} \n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}} \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [sys] [Core-Fetcher]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-prod'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Attribution] [SEV2] - Number
    of errors is higher than 1000'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.log.ERROR{environment:production,feature_name:attribution}.as_count(),
    0) >= 1000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sev2'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:data-tests-dev,type:mongo,feature_name:oppcasting}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Oppcasting] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:oppcasting,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [All] [Mongo] MongoDB has too
    many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo","feature_name:lead-scoring").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'lead-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:lead-scoring,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo,feature_name:pardot-fetcher}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}} \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}} \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Sys] [Mongo] No
    swap configured for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,type:mongo,!type:jungle}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:integration,type:mongo}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [app] MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging,feature_name:engagement-scoring}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:oppcasting,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'oppcasting'

- 'message': '.'
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Infra] AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-cf-integ-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}   \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}   \n{{/is_no_data}} \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal  \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again  \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [sys] [Core-Fetcher] %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'name': '[Integration] [Core-Fetcher] [Pod01]
    [Infra] RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:integration,rabbitmq_vhost:corefetcher,pod:pod01}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Core Fetcher]
    Number of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:core-fetcher,type:core-fetcher,implisit_service:implisit/celery-system-alerts:runtime,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'core-fetcher'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Queue]
    Queued write requests'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:data-tests,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}}\n{{type.name}} \n{{host.name}}:\
    \ Low usable memory: {{value}} \n{{/is_alert}} \n \n\n{{#is_recovery}}\n{{type.name}}\
    \ \n{{host.name}}: Disk usage back to normal \n{{/is_recovery}}  \n@slack-dd-perf-sys"
  'multi': true
  'name': '[Perf] [sys] % Usable Memory on {{type.name}}
    - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-perf-sys'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 30
    'notify_audit': true
    'renotify_interval': 30
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_30m):min:system.mem.pct_usable{environment:performance}
    by {host,type} < 0.15'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:performance'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Containers] [Campaign
    Insights] Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:integration,feature_name:campaign-insights}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'anomaly'
  - 'env:integration'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:integration,type:mongo,feature_name:pardot-fetcher}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Prod] [Pardot-Fetcher] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-pf-production-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files\n \n {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production,feature_name:engagement-scoring}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Integration] [Pod00] [App] [Pardot-Fetcher]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:integration,feature_name:pardot-fetcher,!sfenv:stmp1}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'pardot-fetcher'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging,feature_name:core-fetcher,pod:pod00}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging,feature_name:core-fetcher,pod:pod00}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:data-tests,type:mongo,feature_name:core-fetcher}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': '.'
  'name': '[Prod] [All] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-production}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:integration,type:mongo,feature_name:lead-scoring}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging,feature_name:core-fetcher,pod:pod00}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'env:pilot-staging'
  - 'pod00'
  'type': 'query alert'

- 'message': '---PRODUCTION---

    {{host.base_name}} - RMQ - less than 15 Gb of free disk space for more than 4
    hours

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```'
  'multi': true
  'name': '[Bnbo] [prod] [RMQ] Free Disk Space'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      {{host.base_name}} - RMQ - less than 15 Gb of free disk space for more than
      4 hours

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```'
    'include_tags': true
    'locked': true
    'new_host_delay': 7200
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 15000000000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:rabbitmq.node.disk_free{env:production,inst_type:docker-services-bonobo}
    by {host} < 15000000000'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'rabbitmq'
  - 'sys'
  - 'storage'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Lead-Scoring] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:lead-scoring,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Connections]
    Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:pilot-staging,type:mongo,feature_name:orca}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Sys] [Mongo]  % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:orca,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'orca'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \n\n{{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Queue]
    Queued read requests'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:data-tests,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:production,type:mongo,feature_name:lead-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Data-tests] [app] Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:data-tests}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:data-tests}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:integration,type:mongo,feature_name:lead-scoring}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:orca,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'orca'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [sys] [Campaign-Insights] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging","feature_name:campaign-insights").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'campaign-insights'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [All] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] MongoDB Replica
    with lag dangerous on {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'mongo'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:data-tests,type:mongo,feature_name:lead-scoring}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:pilot-staging,type:mongo,feature_name:pardot-fetcher}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [app] MongoDB
    has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration,feature_name:orca}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-oppty-scoring
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/celery-oppty-scoring:runtime,type:oppty-scoring-main,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': '. @slack-sev0-1'
  'name': '[Prod] [Pod00] [App] [Orca] [SEV0] Orca
    Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:orca,canary:false,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'orca'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:data-tests,type:mongo,feature_name:lead-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring-worker in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppty-scoring-worker:runtime,type:oppcasting-service,environment:integration}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:data-tests,feature_name:core-fetcher}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:integration,feature_name:attribution}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'attribution'
  - 'env:integration'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Orca] [Infra] Integration
    - Pushed data from Orca to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:pilot-staging,feature_name:orca}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'orca'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Pardot-Fetcher] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-pf-integ-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [Engagement-Scoring] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-es-data-tests}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-forecast in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-forecast:runtime,type:oppcasting-forecasting,environment:integration}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:pilot-staging,type:mongo,feature_name:attribution}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:production,feature_name:engagement-scoring}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'engagement-scoring'
  - 'mongo'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Core-Fetcher] [Pod01]
    [Infra] AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-cf-integ-pod01}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Integration] [App] [All] Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:integration,!sfenv:stmp1}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Orca] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-orca-production}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Containers] [Engagement
    Scoring] Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:integration,feature_name:engagement-scoring}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'anomaly'
  - 'env:integration'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests-dev] [Oppcasting] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:data-tests,rabbitmq_vhost:oppcasting}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'oppcasting'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for eng-scoring-training-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:engagement-scoring,implisit_service:implisit/eng-scoring-training-cycle:runtime,type:engagement-scoring-training,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'engagement-scoring'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for oppty-scoring-training-cycle-large
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/oppty-scoring-training-cycle-large:runtime,type:oppty-scoring-training}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:pilot-staging,type:mongo,feature_name:attribution}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-oppty-scoring
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-oppty-scoring:runtime,type:oppty-scoring-main}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Sys] [Mongo] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:orca,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Data-tests] [sys] [Campaign-Insights]
    Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests","feature_name:campaign-insights").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'campaign-insights'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:data-tests,type:mongo,feature_name:lead-scoring}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Lead Scoring]
    Number of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:lead-scoring,type:lead-scoring-fetcher,implisit_service:implisit/celery-system-alerts:runtime,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Lead Scoring] Number
    of containers for celery-lead-scoring-gm-contribution in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-gm-contribution:runtime}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:production'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for celery-campaign-insights
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:campaign-insights,implisit_service:implisit/celery-campaign-insights:runtime,type:campaign-insights-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'campaign-insights'
  - 'celery-worker'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:production,feature_name:attribution}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': '.'
  'name': '[Prod] [Engagement Scoring] [SEV2] -
    Number of errors is higher than 1000'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.log.ERROR{environment:production,feature_name:engagement-scoring}.as_count(),
    0) >= 1000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sev2'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo","feature_name:engagement-scoring").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}   \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}   \n{{/is_no_data}} \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal  \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again  \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Sys] [Mongo] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for eng-scoring-training-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/eng-scoring-training-cycle:runtime,type:engagement-scoring-training}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [scheduler] [SQS]:
    Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-scheduler}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Connections]
    Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:pilot-staging,feature_name:orca}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': '.'
  'name': '[Prod] [Oppcasting] [SEV2] - Number of
    errors is higher than 1000'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.log.ERROR{environment:production,feature_name:oppcasting}.as_count(),
    0) >= 1000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'oppcasting'
  - 'sev2'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Engagement-Scoring]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:engagement-scoring,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:production,type:mongo,feature_name:campaign-insights}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Lead-Scoring] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:lead-scoring,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/celery-worker:runtime,type:orca-worker,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests-dev,feature_name:oppcasting}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:data-tests-dev'
  - 'oppcasting'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Connections]
    Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:production}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:pilot-staging,type:mongo,feature_name:engagement-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Integration] [All] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:integration}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Connections]
    Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:production,feature_name:attribution}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': '.'
  'name': '[Prod] [Campaign Insights] [SEV2] - Number
    of errors is higher than 1000'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.log.ERROR{environment:production,feature_name:campaign-insights}.as_count(),
    0) >= 1000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sev2'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Pardot-Fetcher]
    Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:pardot-fetcher,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Staging] [Core-Fetcher] [Pod00] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:pilot-staging,feature_name:core-fetcher,pod:pod00}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'core-fetcher'
  - 'env:pilot-staging'
  - 'pod00'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:data-tests,type:mongo,feature_name:campaign-insights}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Prod] [Lead Scoring] [SEV2] - Number
    of errors is higher than 1000'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.log.ERROR{environment:production,feature_name:lead-scoring}.as_count(),
    0) >= 1000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sev2'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-worker in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-worker:runtime,type:oppcasting-worker,environment:pilot-staging}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Pardot-Fetcher]
    No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:pardot-fetcher,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n\
    {{/is_no_data_recovery}} \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage\
    \ back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:campaign-insights,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Connections]
    Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:production,type:mongo}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'

- 'message': '.'
  'name': '[Integration] [Lead-Scoring] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-ls-integ-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Attribution] % Usable Swap
    Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:attribution,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'attribution'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-siq-fetcher-fetch-chunk
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/celery-siq-fetcher-fetch-chunk:runtime,type:fetcher-worker}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n@slack-dd-perf-app"
  'multi': true
  'name': '[Perf] [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 15
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:performance","process:mongo").by("host","process").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:performance'
  'type': 'service check'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Attribution] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-at-production-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging,feature_name:lead-scoring}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:data-tests,type:mongo,feature_name:engagement-scoring}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:data-tests,feature_name:orca}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'orca'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:pilot-staging,type:mongo,feature_name:oppcasting}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [All] Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Oppcasting] No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:oppcasting,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'oppcasting'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:integration,feature_name:core-fetcher,pod:pod00}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'mongo'
  - 'pod00'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging,feature_name:oppcasting}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:attribution,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'attribution'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Offline-Jobs] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:offline-jobs,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'offline-jobs'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Attribution]
    Number of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{implisit_service:implisit/celery-beat:runtime,environment:pilot-staging,feature_name:attribution,type:attribution-celery-beat}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': '.'
  'name': '[Integration] [Oppcasting] [Infra] AWS
    Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-oc-integ-pod01}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:integration,type:mongo,feature_name:lead-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Orca] Number
    of containers for celery-fetcher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 7.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/celery-fetcher:runtime,type:fetcher,environment:pilot-staging}
    by {host} < 7'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [All] % Usable Swap
    Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'cross-features'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-ci-integ-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Attribution] No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:attribution,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:pilot-staging,type:mongo,feature_name:campaign-insights}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Connections]
    Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:production,type:mongo,feature_name:attribution}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [All] % Usable Memory
    on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [sys] [Lead-Scoring] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging","feature_name:lead-scoring").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'lead-scoring'
  'type': 'service check'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-pf-integ-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n\
    {{/is_no_data_recovery}} \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage\
    \ back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:pilot-staging,type:mongo,feature_name:pardot-fetcher}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:production,feature_name:lead-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for tenant-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/tenant-cycle:runtime,type:orca}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Campaign-Insights] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:campaign-insights,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:pardot-fetcher,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:integration,feature_name:campaign-insights}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  - 'env:integration'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Infra] AWS
    Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-pf-staging-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n\n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:core-fetcher,type:mongo,pod:pod00,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Engagement-Scoring] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:engagement-scoring,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Sys]
    [Mongo]  No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:engagement-scoring,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'engagement-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Eng. Scoring] Number
    of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/celery-system-alerts:runtime,type:engagement-scoring-pusher}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo","feature_name:engagement-scoring").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:data-tests-dev,feature_name:oppcasting}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:data-tests-dev,feature_name:oppcasting}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:data-tests-dev'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Sys]
    [Mongo]  % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:campaign-insights,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:lead-scoring,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'lead-scoring'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production,feature_name:campaign-insights}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'campaign-insights'
  - 'mongo'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:core-fetcher,type:mongo,pod:pod00,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': '.}'
  'name': '[Staging] [All] [Infra] Fetcher - Pardot
    Fetch - Objects'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_1d):avg:pardot.fetch_records{environment:pilot-staging}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Tickets - Threads
    Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:pilot-staging}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [verification]
    [SQS]: Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-verification}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging,feature_name:attribution}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'attribution'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests,feature_name:pardot-fetcher}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:data-tests'
  - 'pardot-fetcher'
  - 'mongo'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for oppty-training-cycle-small in {{host.name}}
    is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/oppty-training-cycle-small:runtime,type:oppcasting-training-canary}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Attribution] Number of containers
    for celery-attribution-main in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:attribution,implisit_service:implisit/celery-attribution-main:runtime,environment:production,type:attribution}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'attribution'
  - 'env:production'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:data-tests,feature_name:engagement-scoring}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:pilot-staging,type:mongo,feature_name:lead-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Tickets - Threads
    Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:pilot-staging,type:mongo}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Sys] [Mongo] % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:data-tests,type:mongo,feature_name:attribution}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:pardot-fetcher,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'

- 'message': '.'
  'name': '[Staging] [Attribution] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-at-staging-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:integration,feature_name:campaign-insights}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for oppty-training-cycle-large in {{host.name}}
    is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/oppty-training-cycle-large:runtime,type:oppcasting-training-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': ''
  'name': '[Data-tests] [App] [Attribution] Failed
    Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:data-tests,feature_name:attribution,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'attribution'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [PilotStaging] [dead-letter-queue]
    [SQS]: Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000000000.0
      'critical_recovery': 800.0
      'warning': 1300000000.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:pilot-staging-conv-ai-dead-letter-queue}
    > 2000000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:production,feature_name:pardot-fetcher}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pardot-fetcher'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Fault
    Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:lead-scoring,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Lead Scoring] Number
    of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:lead-scoring,type:lead-scoring-fetcher,implisit_service:implisit/celery-system-alerts:runtime}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Sys] [Mongo] Disk space
    is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:orca,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppcasting-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-oppcasting-pusher:runtime,type:oppcasting-pusher,environment:integration}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo,feature_name:attribution}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Engagement-Scoring] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:engagement-scoring,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests-dev,feature_name:oppcasting,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-oppty-scoring-heavy in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,type:oppcasting-training,implisit_service:implisit/celery-oppty-scoring-heavy:runtime,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-oppty-scoring-heavy
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,type:oppty-scoring-training,implisit_service:implisit/celery-oppty-scoring-heavy:runtime}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:production,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:pilot-staging,feature_name:attribution}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Integration] [All] [Mongo] [app] MongoDB
    has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:integration}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo,feature_name:campaign-insights}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:data-tests,feature_name:core-fetcher}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:attribution,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'status'
  - 'attribution'

- 'message': "{{#is_alert}} {{host.name}} isn't\
    \ reporting to datadog, either the machine or the agent has stopped communication\
    \ {{/is_alert}} \n{{#is_alert_recovery}} {{host.name}} has emerged back from the\
    \ dead {{/is_alert_recovery}} \n\n @slack-dd-data-tests"
  'multi': true
  'name': '[Data-tests] {{host.name}} has gone missing'
  'options':
    'escalation_message': '{{host.name}} has been
      missing for a day!'
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 5
    'renotify_interval': 240
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"datadog.agent.up".over("environment:data-tests").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  'type': 'service check'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo","feature_name:core-fetcher","pod:pod00").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'
  'type': 'service check'

- 'message': '@peisendorf@salesforce.com'
  'multi': true
  'name': '[Integration] [Oppcasting] Containers
    running per type'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{env:integration,feature_name:oppcasting,pod:pod01}
    by {host} < 5'
  'restricted_roles': null

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Sys] [Mongo]  Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Sys]
    [Mongo]  Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:pilot-staging,feature_name:core-fetcher,pod:pod00}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': ''
  'name': '[Integration] [Pod00] [App] [Campaign-Insights]
    [SEV0] Campaign-Insights Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:integration,feature_name:campaign-insights,!sfenv:stmp1}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'campaign-insights'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Sys] [Mongo] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Connections]
    Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:pilot-staging,type:mongo,feature_name:orca}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:pilot-staging,feature_name:campaign-insights}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:pilot-staging,feature_name:campaign-insights}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:pilot-staging'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Staging] [sys] [All] Clock in sync with
    NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:pilot-staging").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'cross-features'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Oppcasting] % Usable Memory
    on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:oppcasting,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Sys] [Mongo] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:oppcasting,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:campaign-insights,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging,feature_name:pardot-fetcher}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'cross-features'
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for eng-scoring-main-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:engagement-scoring,implisit_service:implisit/eng-scoring-main-cycle:runtime,type:engagement-scoring-main,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'engagement-scoring'
  - 'env:pilot-staging'

- 'message': '.'
  'name': '[Prod] [Lead-Scoring] [Infra] Integration
    - Fetched data core to Lead-Scoring'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:production,feature_name:lead-scoring},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'lead-scoring'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Attribution] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:attribution,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'attribution'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Oppcasting] [Infra] AWS
    Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-oc-integ-pod01}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo,feature_name:oppcasting}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:production,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:production,feature_name:core-fetcher,pod:pod01}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Prod] [Pod00] [App] [Campaign-Insights]
    Failed Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:production,feature_name:campaign-insights,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) > 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'campaign-insights'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Campaign-Insights]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:campaign-insights,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nLatency on {{mongo.name}}\
    \ is {{value}}\n{{/is_alert}} \n\n@slack-dd-perf-app"
  'multi': true
  'name': '[Perf] [app] High latency on {{mongo.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:orca.mongo.latency_test.find.time.max{environment:performance}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'env:performance'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-beat:runtime,type:oppcasting-celery-beat,environment:integration}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Orca] Disk space
    is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:orca,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:pardot-fetcher,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:attribution,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:integration,feature_name:oppcasting}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': '.'
  'multi': true
  'name': '[Integration] [All] [Infra] RabbitMQ
    node memory usage'
  'options':
    'escalation_message': 'RabbitMQ node memory
      consumption still very high on {{host.name}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 240
    'require_full_window': true
    'thresholds':
      'critical': 35.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'min(last_1h):avg:rabbitmq.node.mem_used{environment:integration}
    by {host} / avg:system.mem.total{environment:integration} by {host} * 100 > 35'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging,feature_name:lead-scoring}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [All] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Prod] [Pod00] [App] [Core-Fetcher] Failed
    Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:production,feature_name:core-fetcher,pod:pod00,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) > 20'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Infra] AWS
    Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-es-production-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Sys] [Mongo] Disk space
    is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'cross-features'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] Mongo
    Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production,feature_name:campaign-insights}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'

- 'message': '{{#is_alert}}@peisendorf@salesforce.com

    White smoke rises from {{host.name}} - {{host.feature_name}} as {{host.mongo_replica}}
    was elected as the new primary Pope. {{/is_alert}}'
  'multi': true
  'name': '[TEST] [LS] [Pavel] alerts when new primary
    elected'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 2
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"datadog.agent.up".over("env:production","feature_name:lead-scoring","mongo_replica:0").exclude("mongo_cluster:conf").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:engagement-scoring,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_no_data}} \n{{/is_no_data}} \n\n{{#is_no_data_recovery}} \n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}} \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [sys] [Core-Fetcher]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-prod'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n\n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:engagement-scoring,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo,feature_name:engagement-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': 'Amount of {{implisit_service.name}}
    on {{type.name}} instance is unusual'
  'multi': true
  'name': '[Prod] [Containers] [Engagement Scoring]
    Number of containers of type {{implisit_service.name}} is not usual'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:production,feature_name:engagement-scoring,!implisit_service:implisit/poststop:runtime,!implisit_service:implisit/prestart:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'containers'
  - 'anomaly'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:integration,feature_name:engagement-scoring}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  - 'env:integration'
  'type': 'query alert'

- 'message': '.'
  'name': '[Data-tests] [Attribution] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:data-tests,rabbitmq_vhost:attribution}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'attribution'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Connections]
    Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:pilot-staging}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': '.'
  'name': '[Prod] [Core-Fetcher] [Pod00] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:production,rabbitmq_vhost:corefetcher,pod:pod00}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Connections]
    Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:production,feature_name:oppcasting}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': ''
  'name': '[Data-tests] [App] [Core-Fetcher] [SEV0]
    Core-Fetcher Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:data-tests,feature_name:core-fetcher,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'core-fetcher'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}\n\n@slack-dd-perf-app"
  'multi': true
  'name': '[Staging] [Core-Fetcher] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging,feature_name:core-fetcher}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'core-fetcher'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:production","process:mongo","feature_name:campaign-insights").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'campaign-insights'
  'type': 'service check'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Pardot-Fetcher]
    % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:pardot-fetcher,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Containers] [Offline Jobs]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_5m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_1h):anomalies(sum:docker.containers.running{feature_name:offline-jobs,environment:pilot-staging,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_5m'',
    interval=20, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'anomaly'
  - 'offline-jobs'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-oc-dt-dev}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'oppcasting'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Sys] [Mongo]  % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:core-fetcher,type:mongo,pod:pod00}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for eng-scoring-main-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:engagement-scoring,implisit_service:implisit/eng-scoring-main-cycle:runtime,type:engagement-scoring-main}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Prod] [All] [Infra] Integration - Fetched
    data from core to All'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:production},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Connections]
    Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:production,type:mongo,feature_name:orca}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}\n\n@slack-dd-perf-app"
  'multi': true
  'name': '[Prod] [Core-Fetcher] [Mongo] [app] MongoDB
    Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production,feature_name:core-fetcher}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'core-fetcher'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:pardot-fetcher,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Infra] AWS
    Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-ls-data-tests}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-forecast
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/celery-forecast:runtime,type:forecasting,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo,feature_name:campaign-insights}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:lead-scoring,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'lead-scoring'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [sys] [Oppcasting] Clock in sync
    with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production","feature_name:oppcasting").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'oppcasting'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:production,feature_name:engagement-scoring}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Queue]  Queued
    write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:data-tests,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for lead-scoring-tenant-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:lead-scoring,implisit_service:implisit/lead-scoring-tenant-cycle:runtime,type:lead-scoring-tenant-cycle,environment:pilot-staging}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:data-tests,type:mongo,feature_name:campaign-insights}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Containers] [Orca] Number
    of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{feature_name:orca,environment:pilot-staging,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'anomaly'
  - 'orca'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:lead-scoring,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{value}}  Redis flushes\
    \ occurred on {{last_triggered_at}} \n@slack-Main_Account-dd-p-staging-infra \n\
    {{/is_alert}}"
  'name': '[p-staging] Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_30m):avg:aws.elasticache.evictions{replication_group:celery-pilot-staging}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:campaign-insights,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'cross-features'
  'type': 'query alert'

- 'message': '{{value}}'
  'name': '[Prod] [Canary] [Pod00] [App] [Engagement-Scoring]
    [SEV0] Engagement-Scoring Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:engagement-scoring,canary:true,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'canary'
  - 'engagement-scoring'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:data-tests-dev,type:mongo,feature_name:oppcasting}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Integration] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-worker in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-worker:runtime,type:oppcasting-worker,environment:integration}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:integration'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:integration,type:mongo,feature_name:oppcasting}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Lead-Scoring] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:lead-scoring,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:pilot-staging,type:mongo,feature_name:campaign-insights}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.


    @slack-dd-data-tests'
  'multi': true
  'name': '[Data-tests] Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 2
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  'type': 'service check'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] [Containers] [Camp. Insights]
    Number of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:campaign-insights,type:campaign-insights,implisit_service:implisit/celery-beat:runtime}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Staging] [Campaign-Insights] [Infra]
    Celery - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:pilot-staging,feature_name:campaign-insights}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'campaign-insights'
  - 'env:pilot-staging'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:data-tests,feature_name:engagement-scoring}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Campaign-Insights] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-ci-integ-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n  \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \  \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Campaign-Insights] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:campaign-insights,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Orca] [Infra] Celery -
    Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:integration,feature_name:orca}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'orca'
  - 'env:integration'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Sys] [Mongo]  Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:core-fetcher,type:mongo,pod:pod01}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Containers] [Campaign Insights]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:production,feature_name:campaign-insights,!implisit_service:implisit/poststop:runtime,!implisit_service:implisit/prestart:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'containers'
  - 'anomaly'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Oppcasting] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:oppcasting,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:pardot-fetcher,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:production,feature_name:lead-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n \n{{value}} \n\
    {{/is_alert}} \n\n\n{{#is_recovery}}\n \n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo,feature_name:campaign-insights}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Campaign-Insights] %
    CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:campaign-insights,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "--pilot-staging--\n{{host.base_name}}\
    \ - CPU Usage is over 80% for the last 4 hours\n## Check out some extra data on\
    \ the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
    ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
    ```"
  'multi': true
  'name': '[Bnbo] [stag] [K8S] CPU Usage'
  'options':
    'escalation_message': "***Renotifying***\n--pilot-staging--\n\
      {{host.base_name}} - CPU Usage is over 80% for the last 4 hours\n## Check out\
      \ some extra data on the:\n[Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)\n\
      ```\n**Notified:**\n- @slack-team-bonobo-alerts-pilot-staging \n- @bonobo_dev@salesforce.com\n\
      ```"
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 80.0
    'timeout_h': 0
  'query': 'avg(last_4h):( ( max:kubernetes.cpu.usage.total{kubernetes_name_space:bonobo,env:pilot-staging}
    by {host} / 1000000000 ) / avg:kubernetes.cpu.capacity{kubernetes_name_space:bonobo,env:pilot-staging}
    by {host} ) * 100 > 80'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'kubernetes'
  - 'sys'
  - 'cpu'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Lead Scoring]
    Number of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,implisit_service:implisit/celery-pusher:runtime,feature_name:lead-scoring,type:lead-scoring-fetchers-canary}
    by {host} < 10'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:data-tests,feature_name:lead-scoring}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}}\n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Handles] WT caches open file handles in memory,'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo,feature_name:lead-scoring}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n{{host.name}}: CPU\
    \ usage back to normal \n{{/is_recovery}}  \n@slack-dd-p-staging-sys"
  'multi': true
  'name': '[p-staging] [sys] % CPU'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 60
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'min(last_15m):avg:system.cpu.user{environment:pilot-staging}
    by {host} + avg:system.cpu.system{environment:pilot-staging} by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Sys]
    [Mongo]  % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:engagement-scoring,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}}\n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:data-tests-dev,type:mongo,feature_name:oppcasting}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:production,feature_name:orca}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'orca'
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:lead-scoring,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'lead-scoring'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [app] MongoDB
    is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests","process:mongo","feature_name:orca").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'orca'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Orca] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:orca,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Connections]
    Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:pilot-staging,type:mongo}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:campaign-insights,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:integration,feature_name:lead-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo,feature_name:attribution}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Sys] [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:core-fetcher,type:mongo,pod:pod01,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Core-Fetcher] [Pod01] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-cf-staging-pod01}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:data-tests,type:mongo,feature_name:engagement-scoring}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'engagement-scoring'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:integration,feature_name:attribution}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'attribution'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:integration,feature_name:orca}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'orca'

- 'message': ''
  'name': '[Data-tests] [App] [Pardot-Fetcher] [SEV0]
    Pardot-Fetcher Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:data-tests,feature_name:pardot-fetcher,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'pardot-fetcher'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:integration","process:mongo","feature_name:core-fetcher","pod:pod01").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Pardot-Fetcher] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:pardot-fetcher,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': ''
  'name': '[Staging] [Pod00] [App] [Core-Fetcher]
    [SEV0] Core-Fetcher Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging,feature_name:core-fetcher,pod:pod00,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:integration,type:mongo,feature_name:attribution}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n\
    {{/is_no_data_recovery}} \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage\
    \ back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Sys] [Mongo] % Usable
    Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:production,feature_name:orca,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Queue]  Queued
    read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:production,type:mongo,feature_name:oppcasting}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': '.'
  'name': '[Prod] [Attribution] [Infra] AWS Elasticache
    Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-at-production-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Connections]
    Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:production,feature_name:oppcasting}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:production,feature_name:core-fetcher,pod:pod01}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}} \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}} \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [sys] [Core-Fetcher]
    No swap configured for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:core-fetcher,pod:pod01,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:data-tests-dev,type:mongo,feature_name:oppcasting}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': '.'
  'name': '[Prod] [All] [Infra] Fetcher - SIQ Objects
    Fetched (< 100 4H)'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 100.0
    'timeout_h': 0
  'query': 'sum(last_4h):avg:orca.siq.fetch.object_fetches{environment:production}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'integration'
  - 'infra'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Containers] [Oppcasting] Number
    of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{feature_name:oppcasting,environment:pilot-staging,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'anomaly'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Core-Fetcher] [Pod00]
    [Infra] AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-cf-integ-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Queue]  Queued
    write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo,feature_name:orca}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] RabbitMQ on
    {{host.name}} is down or {{vhost.name}} doesn''t exist.'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
    'timeout_h': 0
  'query': '"rabbitmq.aliveness".over("environment:data-tests").by("host","vhost").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'rabbitMQ'
  - 'infra'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:data-tests,feature_name:campaign-insights}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Integration] [Lead-Scoring] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:integration,rabbitmq_vhost:lead-scoring}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'lead-scoring'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{value}} \n \n\
    {{/is_alert}} \n\n{{#is_no_data}}\n \n \n{{host.name}} \n{{/is_no_data}} \n\n\
    {{#is_alert_recovery}}\n \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n\
    \ \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:core-fetcher,!type:jungle,type:mongo,pod:pod01}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'name': '[Prod] [Core-Fetcher] [Pod00] [Infra]
    Integration - Fetched data core to Core-Fetcher'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:production,feature_name:core-fetcher,pod:pod00},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Data-tests] [sys] [Engagement-Scoring]
    Clock in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests","feature_name:engagement-scoring").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'engagement-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Integration] [Pod01] [App] [Core-Fetcher]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:integration,feature_name:core-fetcher,pod:pod01,!sfenv:stmp1}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [Mongo
    Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:production,feature_name:campaign-insights}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:data-tests,type:mongo,feature_name:pardot-fetcher}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Lead-Scoring] %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:integration,feature_name:lead-scoring,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'lead-scoring'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for celery-forecast-worker in {{host.name}}
    is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-forecast-worker:runtime,type:oppcasting-forecasting-canary}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Oppcasting] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:oppcasting,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': 'Value: {{value}} < {{threshold}}'
  'name': '[Prod] Full Cycle Count Last 24H (Mongo8)
    < 30'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 30.0
    'timeout_h': 0
  'query': 'sum(last_1d):sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,mongo:mongo-8.vpc-internal}.as_count()
    < 30'
  'restricted_roles': null
  'tags':
  - 'pagerduty'
  - 'env:production'
  - 'mongocycles'
  'type': 'query alert'

- 'message': '@slack-bot-datadog-assessor'
  'name': '[Synthetics] Assessor - Execute Assessor'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
  'query': 'no_query'
  'restricted_roles': null
  'tags':
  - 'probe_dc:aws:us-east-2'
  - 'check_type:browser'
  - 'check_status:live'
  'type': 'synthetics alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for oppty-training-cycle-large in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,type:oppcasting-training,implisit_service:implisit/oppty-training-cycle-large:runtime,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\nDisk space is low on\
    \ {{host.name}} \n{{/is_alert}} \n\n{{#is_recovery}}\nDisk space back to normal\
    \ on {{host.name}} {{device.name}} \n {{/is_recovery}} \n\n{{#is_no_data}}\n{{host.name}}\
    \ {{device.name}} has not reported for 20 minutes \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\
    {{host.name}} {{device.name}} is reporting again \n{{/is_no_data_recovery}} @slack-bot-datadog-build\
    \ @dresnick@salesforce.com"
  'multi': true
  'name': '[Build] [sys] [Master] Disk space is
    low on {{host.name}}'
  'options':
    'escalation_message': "{{^is_alert}}\nDisk space\
      \ is still low on {{host.name}} ( {{device.name}} - Build )\n@slack-dd-build\
      \ \n{{/is_alert}}"
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 20
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 90.0
      'warning': 85.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.disk.in_use{environment:build,host:build-jenkins-master}
    by {device} * 100 >= 90'
  'restricted_roles': null
  'tags':
  - 'sys'
  - 'env:build'
  'type': 'query alert'

- 'message': ''
  'name': '[Integration] [Pod00] [App] [Orca] [SEV0]
    Orca Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:integration,feature_name:orca,!sfenv:stmp1}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'orca'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [All] [Infra] RabbitMQ FD use
    is high'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_5m):sum:rabbitmq.node.fd_used{environment:production}
    by {host} > 15000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'status'
  - 'rabbitMQ'
  - 'infra'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo","feature_name:campaign-insights").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'campaign-insights'
  'type': 'service check'

- 'message': '.'
  'name': '[Prod] [Attribution] [Infra] Integration
    - Pushed data from Attribution to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:production,feature_name:attribution}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'attribution'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:data-tests,feature_name:core-fetcher,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'status'
  - 'core-fetcher'

- 'message': '. @slack-sev0-1'
  'name': '[Prod] [Pod01] [App] [Core-Fetcher] [SEV0]
    Core-Fetcher Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:core-fetcher,pod:pod01,canary:false,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:pilot-staging,type:mongo,feature_name:campaign-insights}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:production,feature_name:pardot-fetcher}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Engagement-Scoring]
    No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:engagement-scoring,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Engagement-Scoring]
    Disk space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:engagement-scoring,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] RabbitMQ FD use
    is high'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_5m):sum:rabbitmq.node.fd_used{environment:pilot-staging}
    by {host} > 15000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'status'
  - 'rabbitMQ'
  - 'infra'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Connections]
    Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:data-tests,type:mongo}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Lead-Scoring] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:data-tests,type:mongo,feature_name:lead-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\nLow Celery Tasks Count\n\
    @slack-dd-p-staging-sys \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    @slack-dd-p-staging-sys \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n@slack-dd-p-staging-sys \n{{/is_no_data_recovery}}"
  'name': '[Staging] Celery - Orca - Count celery
    tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 300.0
    'timeout_h': 0
  'query': 'sum(last_30m):max:orca.orca.celery_task.time.count{feature_name:orca,environment:pilot-staging}.as_count()
    < 100'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'orca'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:integration,type:mongo,feature_name:engagement-scoring}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Engagement-Scoring]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:engagement-scoring,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-beat in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-beat:runtime,type:oppcasting-celery-beat}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Fault
    Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:data-tests,feature_name:orca}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [sys] [Oppcasting] %
    Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests-dev,feature_name:oppcasting,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Sys]
    [Mongo]  Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:campaign-insights,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'campaign-insights'

- 'message': "High Mongo latency on {{mongo.name}}\
    \ \n\n@slack-dd-p-staging-app"
  'multi': true
  'name': '[p-staging] [app] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}} \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}} \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [sys] [Core-Fetcher]
    No swap configured for {{host.name}}'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:core-fetcher,pod:pod00,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}   \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}   \n{{/is_no_data}} \n\n{{#is_recovery}}\n{{host.name}}:\
    \ Disk usage back to normal  \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again  \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [sys] [Core-Fetcher]
    % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:oppcasting,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'status'
  - 'oppcasting'

- 'message': '.'
  'name': '[Staging] [All] [Infra] RDS CPU High'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 80.0
      'warning': 70.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.rds.cpuutilization{name:jungle-pilot-staging}
    > 80'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'infra'
  - 'rds'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [Campaign-Insights] [Infra]
    Integration - Pushed data from Campaign-Insights to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:pilot-staging,feature_name:campaign-insights}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'campaign-insights'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Orca] [Infra] Celery - Count
    celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:production,feature_name:orca}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'orca'
  - 'env:production'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:oppcasting,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [sys] [Core-Fetcher]
    Load average (norm.15)'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:core-fetcher,pod:pod01,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Lead-Scoring] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:lead-scoring,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:attribution,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Staging] [App] [All] Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:pilot-staging,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:data-tests,type:mongo,feature_name:pardot-fetcher}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Sys]
    [Mongo]  No swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:pardot-fetcher,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:production,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Offline-Jobs] Load average
    (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:offline-jobs,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'offline-jobs'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:production,type:mongo,feature_name:lead-scoring}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:pilot-staging,feature_name:core-fetcher,pod:pod01}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:data-tests}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'cross-features'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Connections]
    Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:production,feature_name:attribution}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Sys]
    [Mongo] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:campaign-insights,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Integration] [sys] [Attribution] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:integration","feature_name:attribution").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'attribution'
  'type': 'service check'

- 'message': '.'
  'multi': true
  'name': 'test - feature enable'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_5m):avg:jungle.api.feature.enable{*}
    by {core_feature}.as_count() < 1'
  'restricted_roles': null
  'tags':
  - 'onboarding'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Engagement-Scoring]
    Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:engagement-scoring,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Prod] [Core Fetcher] [SEV2] - Number
    of errors is higher than 1000'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.log.ERROR{environment:production,feature_name:core-fetcher}.as_count(),
    0) >= 1000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sev2'
  - 'core-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{/is_alert}} \n\n\
    {{#is_recovery}}\n \n{{/is_recovery}}"
  'name': '[Staging] [Pod00] [App] [Campaign-Insights]
    Failed Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 20.0
      'warning': 15.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.cycle.error{environment:pilot-staging,feature_name:campaign-insights,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    > 20'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'campaign-insights'
  - 'pod00'
  - 'app'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Lead-Scoring] %
    CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:lead-scoring,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Production] [Canary] [Pod01] [Containers]
    [Oppcasting] Number of containers for celery-forecast in {{host.name}} is below
    threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-forecast:runtime,type:oppcasting-forecasting-canary}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'oppcasting'
  - 'pod01'
  - 'canary'

- 'message': 'Value: {{value}} < {{threshold}}'
  'name': '[Prod] Full Cycle Count Last 24H (Mongo-6)
    < 10'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1d):sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,mongo:mongo-6.vpc-internal}.as_count()
    < 10'
  'restricted_roles': null
  'tags':
  - 'pagerduty'
  - 'env:production'
  - 'mongocycles'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:production,feature_name:engagement-scoring}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Prod] [All] [Infra] Slack service delayed
    messages'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
      'warning': 5.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(max:aws.sqs.approximate_number_of_messages_delayed{queuename:production-slack-service.fifo},
    0) > 10'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'infra'
  - 'slack'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging,feature_name:core-fetcher,pod:pod01}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Engagement-Scoring] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:integration,feature_name:engagement-scoring}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:production,feature_name:lead-scoring}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'lead-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:oppcasting,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Sys] [Mongo] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:orca,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Orca] Number
    of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,type:fetcher,implisit_service:implisit/celery-system-alerts:runtime,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Campaign-Insights] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:production,feature_name:campaign-insights,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Staging] [Core-Fetcher] [Pod00] [Infra]
    AWS Elasticache Redis flushes'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 10.0
    'timeout_h': 0
  'query': 'sum(last_1h):avg:aws.elasticache.evictions{replication_group:celery-cf-staging-pod00}.as_count()
    > 10'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod00'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Cursor]
    Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:pilot-staging,type:mongo}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pardot-Fetcher] [Mongo] [app]
    MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production,feature_name:pardot-fetcher}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'pardot-fetcher'
  - 'mongo'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Integration] [All] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:integration}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Queue]  Queued
    read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:data-tests,type:mongo,feature_name:orca}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Fault
    Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:integration}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': '.'
  'name': '[Data-tests] [Lead-Scoring] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:data-tests,rabbitmq_vhost:lead-scoring}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'lead-scoring'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [All] [Infra] Celery - Count
    celery tasks'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
      'warning': 300.0
    'timeout_h': 0
  'query': 'sum(last_15m):avg:orca.orca.celery_task.time.count{env:data-tests}
    by {feature_name}.as_count() < 5'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'cross-features'
  - 'env:data-tests'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_alert_recovery}} \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Sys] [Mongo] Load average
    (norm.15)'
  'options':
    'escalation_message': ''
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Camp. Insights]
    Number of containers for celery-pusher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:campaign-insights,implisit_service:implisit/celery-pusher:runtime,type:campaign-insights-pusher,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'campaign-insights'
  - 'env:pilot-staging'

- 'message': '{{value}}'
  'name': '[Prod] [Canary] [Pod00] [App] [Orca]
    [SEV0] Orca Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:orca,canary:true,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'canary'
  - 'orca'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Attribution] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:integration,rabbitmq_vhost:attribution}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'attribution'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}Disk space is low on\
    \ {{host.name}} {{/is_alert}} \n{{#is_recovery}}Disk space back to normal on {{host.name}}\
    \ {{device.name}} {{/is_recovery}} \n@slack-dd-data-tests"
  'multi': true
  'name': '[Data-tests] Disk space is low on {{host.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}}

      @slack-dd-data-tests'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 0.9
      'warning': 0.7
    'timeout_h': 0
  'query': 'avg(last_10m):avg:system.disk.in_use{environment:data-tests,!device:shm,!device:tmpfs,!device:rootfs}
    by {device,host} >= 0.9'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:data-tests,feature_name:pardot-fetcher,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests","process:mongo","feature_name:campaign-insights").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'mongo'
  - 'campaign-insights'
  'type': 'service check'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-ls-integ-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'lead-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Sys] [Mongo] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:pilot-staging,feature_name:orca,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}}\n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Handles]
    WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Lead-Scoring] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:lead-scoring,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Connections] Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:data-tests-dev,feature_name:oppcasting}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files\n \n {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production,feature_name:campaign-insights}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:production'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\nLow Celery Tasks Count\n\
    @slack-dd-p-staging-sys \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    @slack-dd-p-staging-sys \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n@slack-dd-p-staging-sys\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n@slack-dd-p-staging-sys \n{{/is_no_data_recovery}}"
  'name': '[Staging] Celery - Eng. Scoring - Count
    celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{feature_name:engagement-scoring,environment:pilot-staging}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'engagement-scoring'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Prod] [Containers] [Oppcasting] Number
    of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:production,feature_name:oppcasting,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'env:production'
  - 'anomaly'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:pilot-staging,feature_name:orca}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'orca'
  - 'env:pilot-staging'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Core-Fetcher] [Pod01] [Infra]
    Integration - Fetched data core to Core-Fetcher'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:production,feature_name:core-fetcher,pod:pod01},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] Mongo % Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:integration,feature_name:core-fetcher,pod:pod00}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:integration,feature_name:core-fetcher,pod:pod00}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:data-tests-dev,type:mongo,feature_name:oppcasting}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests-dev'
  - 'oppcasting'

- 'message': '{{#is_alert}}

    Oppcasting System Test Prod - Failure

    {{/is_alert}}'
  'multi': true
  'name': '[Prod] [Canary] [Oppcasting] Deployment
    Pipeline - Success/Failure'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"jenkins.job.status".over("host:impl-jenkins-production.pod01-CD","job:oppcasting/production-pod01-canary/pipeline").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'oppcasting'
  - 'env:production'
  - 'app'
  - 'pipeline'
  - 'canary'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [sys] [Oppcasting] %
    CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests-dev,feature_name:oppcasting,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'sys'
  - 'oppcasting'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Core-Fetcher] [Pod00]
    [Infra] AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-cf-integ-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Attribution] [Mongo] [Mongo
    Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:integration,feature_name:attribution}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n \n{{value}} \n\
    {{/is_alert}} \n\n\n{{#is_recovery}}\n \n \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Handles]
    WT caches open file handles in memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:production,type:mongo,feature_name:oppcasting}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] Number of containers for pardot-fetcher-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 4.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,implisit_service:implisit/pardot-fetcher-cycle:runtime,type:pardot-fetcher-main-canary}
    by {host} < 4'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'
  - 'canary'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [sys] [Orca] Clock in sync with
    NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production","feature_name:orca").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'orca'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Attribution] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:attribution,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:pilot-staging,type:mongo,feature_name:engagement-scoring}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Sys] [Mongo]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:oppcasting,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:data-tests,feature_name:orca}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{value}} \n \n\
    {{/is_alert}} \n\n{{#is_no_data}}\n \n \n{{host.name}} \n{{/is_no_data}} \n\n\
    {{#is_alert_recovery}}\n \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n\
    \ \n{{host.name}} is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [Campaign-Insights] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:campaign-insights,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'mongo'
  - 'status'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Queue]  Queued
    read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:pilot-staging,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Mongo]
    [app] MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:data-tests-dev","process:mongo","feature_name:oppcasting").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'mongo'
  - 'oppcasting'
  'type': 'service check'

- 'message': '.'
  'name': '[Data-tests] [Campaign-Insights] [Infra]
    AWS Elasticache Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-ci-data-tests}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'campaign-insights'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Engagement-Scoring] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:engagement-scoring,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Pardot-Fetcher] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:production,rabbitmq_vhost:pardot-fetcher}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pardot-fetcher'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for core-fetcher-oppty-scoring
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:core-fetcher,environment:pilot-staging,implisit_service:implisit/core-fetcher-oppty-scoring:runtime,type:core-fetcher}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'core-fetcher'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,feature_name:lead-scoring,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'lead-scoring'

- 'message': ''
  'name': '[Staging] [Pod01] [App] [Oppcasting]
    [SEV0] Oppcasting Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging,feature_name:oppcasting,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'oppcasting'
  - 'pod01'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Orca] % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:production,feature_name:orca,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'orca'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Mongo] [Tickets
    - Threads Mongo] Write available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.write.available{type:mongo,environment:integration,feature_name:oppcasting}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'oppcasting'

- 'message': '.'
  'multi': true
  'name': '[Staging] [All] [Infra] RabbitMQ node
    memory usage'
  'options':
    'escalation_message': 'RabbitMQ node memory
      consumption still very high on {{host.name}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 240
    'require_full_window': true
    'thresholds':
      'critical': 35.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'min(last_1h):avg:rabbitmq.node.mem_used{environment:pilot-staging}
    by {host} / avg:system.mem.total{environment:pilot-staging} by {host} * 100 >
    35'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'rabbitMQ'
  - 'infra'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo,feature_name:engagement-scoring}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Campaign-Insights]
    Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:integration,feature_name:campaign-insights,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Data-tests] [Orca] [Infra] Celery -
    Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:data-tests,feature_name:orca}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'orca'
  - 'env:data-tests'
  - 'infra'
  'type': 'query alert'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files\n \n {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [app] MongoDB
    has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:production,feature_name:attribution}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [All] % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:pilot-staging,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'cross-features'

- 'message': '.'
  'multi': true
  'name': '[Staging] Number of containers for tenant-cycle
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 30.0
    'timeout_h': 0
  'query': 'min(last_15m):sum:docker.containers.running{implisit_service:implisit/tenant-cycle:runtime,environment:pilot-staging,feature_name:orca,type:orca}
    by {host} < 30'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:pilot-staging,feature_name:pardot-fetcher}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:data-tests,feature_name:pardot-fetcher}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'pardot-fetcher'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Fault Page] Operations which require Mongo to fetch data from disk'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 800.0
      'warning': 500.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.extra_info.page_faultsps{type:mongo,env:pilot-staging,feature_name:engagement-scoring}
    by {host} > 800'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:integration,feature_name:orca}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'orca'
  - 'env:integration'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Attribution] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-at-production-pod00}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'attribution'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}} @pagerduty-Ofek-Datadog"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Queue]  Queued
    write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:production,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'
  - 'pagerduty'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:attribution,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'attribution'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Connections]
    Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:pilot-staging,type:mongo,feature_name:orca}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': '.'
  'name': '[Prod] [All] [Infra] Slack service sent
    messages is low'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
      'warning': 5.0
    'timeout_h': 0
  'query': 'sum(last_1d):default(sum:aws.sqs.number_of_messages_sent{queuename:production-slack-service.fifo}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'cross-features'
  - 'infra'
  - 'slack'
  - 'status'
  'type': 'query alert'

- 'message': '.'
  'name': '[Staging] [All] [Infra] RDS Low Memory'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 20.0
    'timeout_h': 0
  'query': 'avg(last_30m):( avg:aws.rds.memory.free{name:jungle-pilot-staging}
    / avg:aws.rds.memory.total{name:jungle-pilot-staging} ) * 100 < 15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'cross-features'
  - 'infra'
  - 'rds'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Orca] [Mongo] [Mongo Connections]
    Active clients - Update'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_1h):avg:mongodb.opcounters.updateps{environment:data-tests,type:mongo,feature_name:orca}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'orca'

- 'message': ''
  'name': '[Staging] [Pod01] [App] [Core-Fetcher]
    [SEV0] Core-Fetcher Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging,feature_name:core-fetcher,pod:pod01,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Mongo] [Mongo Cursor] Open Cursors'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'warning': 1000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.metrics.cursor.open.total{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 2000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Sys] [Mongo]  %
    Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:pardot-fetcher,type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-lead-scoring-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:lead-scoring,implisit_service:implisit/celery-lead-scoring-worker:runtime,type:lead-scoring-main-worker,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo,feature_name:engagement-scoring}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': '@slack-bot-datadog-conv-ai-alerts'
  'name': '[ConvAI] [Production] [scheduler] [SQS]:
    Too many unhandled messages on {{queuename}}'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2000.0
      'critical_recovery': 800.0
      'warning': 1300.0
      'warning_recovery': 500.0
    'timeout_h': 0
  'query': 'avg(last_30m):sum:aws.sqs.approximate_number_of_messages_visible{queuename:production-conv-ai-scheduler}
    > 2000'
  'restricted_roles': null
  'tags':
  - 'env:production'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Campaign-Insights] No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:campaign-insights,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'campaign-insights'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Pardot-Fetcher] Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:pilot-staging,feature_name:pardot-fetcher,!type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Prod] [sys] [All] Clock in sync with
    NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:production").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'cross-features'
  'type': 'service check'

- 'message': '.'
  'name': '[Integration] [Attribution] [Infra] Integration
    - Pushed data from Attribution to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:integration,feature_name:attribution}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'attribution'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [All] [Mongo] [Mongo Connections]
    Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:pilot-staging,type:mongo}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Offline-Jobs] No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:offline-jobs,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'sys'
  - 'status'
  - 'offline-jobs'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on {{host.name}}\
    \ is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Integration] [Orca] [Mongo] Mongo %
    Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:integration,feature_name:orca}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:integration,feature_name:orca}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:integration'
  - 'orca'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Pod00] [App] [Pardot-Fetcher]
    [SEV1] Pardot-Fetcher Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 150.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:pardot-fetcher,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 150'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'pardot-fetcher'
  - 'pod00'
  - 'app'
  - 'sev1'
  'type': 'query alert'

- 'message': 'TEST'
  'multi': true
  'name': '[API] Implisit Mongo CPU - API [Karim]'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
      'warning': 70.0
    'timeout_h': 0
  'query': 'avg(last_5m):100 - avg:system.cpu.idle{type:mongo,environment:production}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'sys'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pod01] [Core-Fetcher] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production,feature_name:core-fetcher,pod:pod01}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'core-fetcher'
  - 'pod01'
  - 'mongo'

- 'message': "{{#is_alert}}  \n{{/is_alert}} \n\n\
    {{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}  \n\
    {{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [sys] [Core-Fetcher] Disk
    space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] [Mongo
    Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:data-tests,feature_name:attribution}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'attribution'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Attribution] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:attribution,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': '.'
  'name': '[Prod] [Engagement-Scoring] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:production,feature_name:engagement-scoring}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'engagement-scoring'
  - 'env:production'
  - 'infra'
  'type': 'query alert'

- 'message': "MongoDB process is down on host {{host.name}}\
    \ \n\n\n{{#is_alert}}\n \n{{/is_alert}} \n\n{{value}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [app]
    MongoDB is down on {{host.name}}'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 3
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"process.up".over("environment:pilot-staging","process:mongo","feature_name:oppcasting").by("host","process").last(4).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'mongo'
  - 'oppcasting'
  'type': 'service check'

- 'message': '.'
  'name': '[Staging] [Campaign-Insights] [Infra]
    RabbitMQ - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:pilot-staging,rabbitmq_vhost:campaign-insights}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'campaign-insights'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': ''
  'name': '[Data-tests] [App] [All] [SEV0] All Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:data-tests,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Staging] [sys] [Offline-Jobs] No swap
    configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:pilot-staging,feature_name:offline-jobs,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'sys'
  - 'status'
  - 'offline-jobs'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Attribution] [Mongo] [Mongo Connections]
    Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:production,type:mongo,feature_name:attribution}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'attribution'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [Mongo Connections]
    Active clients - Readers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.activeclients.readers{environment:data-tests,type:mongo}
    by {host} > 15'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'cross-features'

- 'message': "{{#is_alert}}\nCache usage on {{host.name}}\
    \ is high {{value}} > 94 \n \n{{/is_alert}}\n\n{{#is_warning}}\nCache usage on\
    \ {{host.name}} is {{value}} \n{{/is_warning}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Mongo] Mongo %
    Cache usage'
  'options':
    'escalation_message': '{{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 10
    'require_full_window': true
    'thresholds':
      'critical': 0.95
      'warning': 0.94
    'timeout_h': 0
  'query': 'max(last_5m):max:mongodb.wiredtiger.cache.bytes_currently_in_cache{environment:production,feature_name:lead-scoring}
    by {host} / avg:mongodb.wiredtiger.cache.maximum_bytes_configured{environment:production,feature_name:lead-scoring}
    by {host} >= 0.95'
  'restricted_roles': null
  'tags':
  - 'mongo'
  - 'status'
  - 'env:production'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [All] [Infra] Integration
    - Pushed data from All to core'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'sum(last_4h):default(sum:orca.push_sfdc.records{environment:integration}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': ''
  'name': '[Data-tests] [App] [Lead-Scoring] [SEV0]
    Lead-Scoring Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:data-tests,feature_name:lead-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'lead-scoring'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Pod01] [Containers] [Oppcasting]
    Number of containers for celery-forecast in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:oppcasting,pod:pod01,implisit_service:implisit/celery-forecast:runtime,type:oppcasting-forecasting,environment:pilot-staging}
    by {host} < 2'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'oppcasting'
  - 'pod01'
  - 'env:pilot-staging'

- 'message': '.'
  'name': '[Staging] [Attribution] [Infra] Celery
    - Count celery tasks'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
      'warning': 10.0
    'timeout_h': 0
  'query': 'sum(last_4h):max:orca.orca.celery_task.time.count{environment:pilot-staging,feature_name:attribution}.as_count()
    < 1'
  'restricted_roles': null
  'tags':
  - 'celery'
  - 'status'
  - 'attribution'
  - 'env:pilot-staging'
  - 'infra'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests-dev] [Oppcasting] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests-dev,feature_name:oppcasting,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests-dev'
  - 'status'
  - 'mongo'
  - 'oppcasting'

- 'message': '.'
  'multi': true
  'name': '[TEST] [Containers] [Offline Jobs] Number
    of containers - Pavel Test'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{feature_name:offline-jobs,env:pilot-staging,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] [Containers] [Lead Scoring]
    Number of containers for celery-fetcher in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 5.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:lead-scoring,implisit_service:implisit/celery-fetcher:runtime,type:lead-scoring-fetcher,environment:pilot-staging}
    by {host} < 5'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'lead-scoring'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Connections]
    Active clients - Getmore'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.getmoreps{type:mongo,environment:production,feature_name:orca}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

- 'message': '.'
  'multi': true
  'name': '[Integration] [Core-Fetcher] [Pod01]
    [Infra] AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-cf-integ-pod01}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'core-fetcher'
  - 'pod01'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pod01] [Core-Fetcher] [Mongo]
    [Mongo Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo,feature_name:core-fetcher,pod:pod01}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'pod01'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Containers] [Campaign Insights]
    Number of containers'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'threshold_windows':
      'recovery_window': 'last_15m'
      'trigger_window': 'last_15m'
    'thresholds':
      'critical': 1.0
      'critical_recovery': 0.0
    'timeout_h': 0
  'query': 'avg(last_4h):anomalies(sum:docker.containers.running{environment:data-tests,feature_name:campaign-insights,!implisit_service:implisit/prestart:runtime,!implisit_service:implisit/poststop:runtime}
    by {implisit_service,type}, ''basic'', 2, direction=''both'', alert_window=''last_15m'',
    interval=60, count_default_zero=''true'') >= 1'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'containers'
  - 'anomaly'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Oppcasting] [Mongo] [Mongo
    Queue]  Queued write requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.writers{environment:pilot-staging,type:mongo,feature_name:oppcasting}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n\n \n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod01] [Core-Fetcher]
    [Sys] [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:core-fetcher,pod:pod01,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'core-fetcher'
  - 'pod01'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Mongo] [app] MongoDB
    Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:data-tests}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:data-tests'
  - 'cross-features'
  - 'mongo'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Staging] Number of containers for celery-oppty-scoring-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{feature_name:orca,implisit_service:implisit/celery-oppty-scoring-worker:runtime,type:oppty-scoring-main,environment:pilot-staging}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'orca'
  - 'env:pilot-staging'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_no_data}}\n \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n\n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}}\n \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Sys]
    [Mongo] % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:integration,feature_name:campaign-insights,type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': 'Triggers if any host''s clock goes
    out of sync with the time given by NTP. The offset threshold is configured in
    the Agent''s `ntp.yaml` file.


    Please read the [KB article](http://help.datadoghq.com/hc/en-us/articles/204282095-Network-Time-Protocol-NTP-Offset-Issues)
    on NTP Offset issues for more details on cause and resolution.'
  'multi': true
  'name': '[Data-tests] [sys] [Pardot-Fetcher] Clock
    in sync with NTP'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"ntp.in_sync".over("environment:data-tests","feature_name:pardot-fetcher").by("host").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'sys'
  - 'status'
  - 'pardot-fetcher'
  'type': 'service check'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Attribution] % CPU
    Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:attribution,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'attribution'
  'type': 'query alert'

- 'message': '{{#is_alert}}

    Lead Scoring System Test Prod - Failure

    {{/is_alert}}'
  'multi': true
  'name': '[Prod] [Canary] [Lead Scoring] Deployment
    Pipeline - Success/Failure'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"jenkins.job.status".over("host:impl-jenkins-production.pod00-CD","job:lead-scoring/production-pod00-canary/pipeline").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'app'
  - 'pipeline'
  - 'canary'
  - 'lead-scoring'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}}\n\
    \ \n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [sys] [Campaign-Insights]
    Disk space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:integration,feature_name:campaign-insights,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'sys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{value}} \n{{/is_alert}}\
    \ \n\n\n{{#is_recovery}} \n{{value}} \n{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [Mongo
    Handles] WT caches open file handles in memory'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 250000.0
      'warning': 200000.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:system.fs.file_handles.used{environment:pilot-staging,type:mongo,feature_name:pardot-fetcher}
    by {host} > 250000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': '--pilot-staging--

    {{host.base_name}} - RMQ - less than 15 Gb of free disk space for more than 4
    hours

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-pilot-staging

    - @bonobo_dev@salesforce.com

    ```'
  'multi': true
  'name': '[Bnbo] [stag] [RMQ] Free Disk Space'
  'options':
    'escalation_message': '***Renotifying***

      --pilot-staging--

      {{host.base_name}} - RMQ - less than 15 Gb of free disk space for more than
      4 hours

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-pilot-staging

      - @bonobo_dev@salesforce.com

      ```'
    'include_tags': true
    'locked': true
    'new_host_delay': 7200
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 15000000000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:rabbitmq.node.disk_free{inst_type:docker-services-bonobo,env:pilot-staging}
    by {host} < 15000000000'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:pilot-staging'
  - 'rabbitmq'
  - 'sys'
  - 'storage'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Mongo]
    [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:pilot-staging,type:mongo,feature_name:engagement-scoring}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'engagement-scoring'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Pardot-Fetcher] %
    CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:data-tests,feature_name:pardot-fetcher,!type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'pardot-fetcher'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Oppcasting] [Mongo] [Mongo Connections]
    Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:production,type:mongo,feature_name:oppcasting}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'oppcasting'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Campaign-Insights] [Mongo]
    [Mongo Queue]  Queued read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo,feature_name:campaign-insights}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'campaign-insights'

- 'message': '{{#is_alert}} MongoDB on {{host.name}}
    has too many open files {{/is_alert}}

    {{#is_alert_recovery}} MongoDB on {{host.name}} open files use has decreased {{/is_alert_recovery}}'
  'multi': true
  'name': '[Staging] [Pardot-Fetcher] [Mongo] [app]
    MongoDB has too many open files'
  'options':
    'escalation_message': null
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': null
    'require_full_window': true
    'thresholds':
      'critical': 800000.0
      'warning': 600000.0
    'timeout_h': null
  'query': 'avg(last_5m):max:system.processes.open_file_descriptors{environment:pilot-staging,feature_name:pardot-fetcher}
    by {host} > 800000'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'mongo'
  - 'env:pilot-staging'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Engagement-Scoring] [Sys]
    [Mongo]  Load average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,feature_name:engagement-scoring,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'engagement-scoring'

- 'message': '.'
  'name': '[Data-tests] [All] [Infra] AWS Elasticache
    Freeable memory aws.elasticache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1000000000.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:aws.elasticache.freeable_memory{replication_group:celery-data-tests}
    < 1000000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'cross-features'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Staging] [Attribution] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:pilot-staging,feature_name:attribution}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'attribution'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Campaign-Insights] [Sys]
    [Mongo] Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:data-tests,feature_name:campaign-insights,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': ''
  'name': '[Staging] [Pod00] [App] [Lead-Scoring]
    [SEV0] Lead-Scoring Cycles'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:pilot-staging,feature_name:lead-scoring,!sfenv:stmp1,!sfenv:stmp2}.as_count(),0)
    < 2'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'lead-scoring'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{value}} \nThis monitor does not include Mongo instances\n{{#is_recovery}} \n\
    {{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [sys] [Core-Fetcher]
    Disk space is low on {{host.name}} - {{device.name}}'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production )

      @slack-dd-prod'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': '@ofek-bazz@salesforce.com

    @slack-prom-call-coaching-prod'
  'multi': true
  'name': 'Call Coaching System Test Staging - Failure'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'notify_no_data': false
    'renotify_interval': 0
    'thresholds':
      'critical': 1
      'ok': 1
      'warning': 1
    'timeout_h': 0
  'query': '"jenkins.job.status".over("host:impl-jenkins-pilot-staging.pod00-CD","job:call-coaching/system_test").last(2).count_by_status()'
  'restricted_roles': null
  'tags':
  - 'ecc'
  - 'system_test'
  'type': 'service check'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [All] [Mongo] [Mongo Queue]  Queued
    read requests'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 200.0
      'warning': 100.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.globallock.currentqueue.readers{environment:integration,type:mongo}
    by {host} > 200'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:campaign-insights,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'campaign-insights'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Pod00] [Core-Fetcher] [Mongo]
    [Mongo Connections] Active clients - Writers'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 30.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.globallock.activeclients.writers{type:mongo,environment:production,feature_name:core-fetcher,pod:pod00}
    by {host} > 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'core-fetcher'
  - 'pod00'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Data-tests] [Attribution] [Mongo] {{host.name}}
    oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:data-tests,feature_name:attribution}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'attribution'
  - 'mongo'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Sys] [Mongo]  No
    swap configured for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:integration,feature_name:oppcasting,!type:jungle,type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'mongo'
  - 'status'
  - 'oppcasting'

- 'message': '{{value}}'
  'name': '[Prod] [Canary] [Pod01] [App] [Oppcasting]
    [SEV0] Oppcasting Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_1h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:oppcasting,canary:true,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'canary'
  - 'oppcasting'
  - 'pod01'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration,feature_name:core-fetcher,pod:pod00}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'
  - 'mongo'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Prod] Number of containers for celery-forecast-worker
    in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 12.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:orca,type:forecasting,implisit_service:implisit/celery-forecast-worker:runtime}
    by {host} < 12'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'orca'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Orca] [Mongo] [Mongo Connections]
    Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:pilot-staging,type:mongo,feature_name:orca}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:pilot-staging'
  - 'orca'

- 'message': "{{#is_alert}}\n\n{{host.name}}: High\
    \ CPU usage: {{value}}  \n{{/is_alert}} \n\n{{#is_recovery}}\n\n{{/is_recovery}}"
  'multi': true
  'name': '[Integration] [Oppcasting] [Sys] [Mongo]
    % CPU Consumption'
  'options':
    'escalation_message': "{{#is_alert}}\n \n{{/is_alert}}\
      \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 85.0
    'timeout_h': 0
  'query': 'avg(last_4h):100 - avg:system.cpu.idle{environment:integration,feature_name:oppcasting,type:mongo}
    by {host} > 85'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'status'
  - 'mongo'
  - 'oppcasting'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Offline-Jobs] % Usable
    Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:production,feature_name:offline-jobs,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'sys'
  - 'offline-jobs'

- 'message': '---PRODUCTION---

    {{host.base_name}} - RMQ - Memory Alerts on rabbitmq_node.name

    ## Check out some extra data on the:

    [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

    ```

    **Notified:**

    - @slack-team-bonobo-alerts-production

    - @bonobo_dev@salesforce.com

    ```'
  'multi': true
  'name': '[Bnbo] [prod] [RMQ] Memory Alerts'
  'options':
    'escalation_message': '***Renotifying***

      ---PRODUCTION---

      {{host.base_name}} - RMQ - Memory Alerts on rabbitmq_node.name

      ## Check out some extra data on the:

      [Bonobo _extra detailed_ Dashboard](https://p.datadoghq.com/sb/283ea714b-b41b4ea928c9f925baa9bc723a9258b2)

      ```

      **Notified:**

      - @slack-team-bonobo-alerts-production

      - @bonobo_dev@salesforce.com

      ```'
    'evaluation_delay': 590
    'include_tags': true
    'locked': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 1440
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'max(last_30m):avg:rabbitmq.node.mem_alarm{env:production,type:bonobo_services}
    by {rabbitmq_node} > 0'
  'restricted_roles':
  - 'name': 'Datadog Admin Role'
    'uuid': '3487b5fa-e140-11e8-9a7c-03c1982c21db'
  'tags':
  - 'team:Bonobo'
  - 'env:production'
  - 'rabbitmq'
  - 'sys'
  - 'memory'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [Core-Fetcher] [Mongo] [Tickets
    - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:data-tests,type:mongo,feature_name:core-fetcher}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:data-tests'
  - 'core-fetcher'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_recovery}} \n{{/is_recovery}}\n\n{{#is_no_data}} \n{{/is_no_data}}"
  'multi': true
  'name': '[Canary] [Containers] [Core Fetcher]
    Number of containers for celery-system-alerts in {{host.name}} is below threshold'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'min(last_1m):sum:docker.containers.running{environment:production,feature_name:core-fetcher,implisit_service:implisit/celery-system-alerts:runtime,type:core-fetcher-canary}
    by {host} < 1'
  'restricted_roles': null
  'tags':
  - 'containers'
  - 'env:production'
  - 'canary'
  - 'core-fetcher'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [app] MongoDB Replica
    with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production,feature_name:orca}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:production'
  - 'orca'
  - 'mongo'

- 'message': 'Oplog window size on {{host.name}}
    - {{host.ip}} is currently {{value}}'
  'multi': true
  'name': '[Staging] [Pod00] [Core-Fetcher] [Mongo]
    {{host.name}} oplog window size less than 1 day.'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 86400.0
    'timeout_h': 0
  'query': 'avg(last_10m):avg:mongodb.oplog.timediff{type:mongo,environment:pilot-staging,feature_name:core-fetcher,pod:pod00}
    by {host} < 86400'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'core-fetcher'
  - 'mongo'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \nMongo logs, journal and boot devices. \n\n{{#is_alert_recovery}}\n\
    \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Lead-Scoring] [Sys] [Mongo]
    Disk space is low on {{host.name}} - {{device.name}} - Logs'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Logs'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:pilot-staging,feature_name:lead-scoring,type:mongo,!device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'mongo'
  - 'mongosys'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [All] [Mongo] [Mongo Connections]
    Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:production,type:mongo}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'cross-features'

- 'message': "{{#is_alert}} \n{{/is_alert}} \n\n\
    {{#is_no_data}} \n{{/is_no_data}} \n\n{{#is_no_data_recovery}} \n{{/is_no_data_recovery}}\
    \ \n\n{{#is_alert_recovery}} \n{{host.name}}: Disk usage back to normal \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Staging] [Pod00] [sys] [Core-Fetcher]
    % Usable Memory on {{type.name}} - {{host.name}}'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable memory: {{value}}

      @slack-dd-prod'
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.15
    'timeout_h': 0
  'query': 'avg(last_4h):min:system.mem.pct_usable{environment:pilot-staging,feature_name:core-fetcher,pod:pod00,!type:mongo}
    by {host} < 0.15'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'status'
  - 'sys'
  - 'core-fetcher'
  - 'pod00'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}\n\n@slack-dd-perf-app"
  'multi': true
  'name': '[Integration] [Core-Fetcher] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:integration,feature_name:core-fetcher}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:integration'
  - 'core-fetcher'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Engagement-Scoring] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-es-staging-pod00}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'engagement-scoring'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{value}} \n{{/is_alert}}\
    \ \n\n{{#is_no_data}}\n \n{{host.name}} \n{{/is_no_data}} \n\n{{#is_alert_recovery}}\n\
    \ \n{{value}} \n{{/is_alert_recovery}}\n\n{{#is_no_data_recovery}}\n \n{{host.name}}\
    \ is reporting again\n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Prod] [sys] [Offline-Jobs] No swap configured
    for {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 0.0
    'timeout_h': 0
  'query': 'avg(last_5m):max:system.swap.total{environment:production,feature_name:offline-jobs,!type:jungle,!type:mongo}
    by {host} <= 0'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'sys'
  - 'status'
  - 'offline-jobs'

- 'message': '.'
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Infra]
    AWS Elasticache - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-pf-data-tests}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'pardot-fetcher'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'multi': true
  'name': '[Staging] [Orca] [Infra] AWS Elasticache
    - bytes used for cache'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 15500000000.0
    'timeout_h': 0
  'query': 'avg(last_5m):avg:aws.elasticache.bytes_used_for_cache{replication_group:celery-orca-pilot-staging}
    by {name} > 15500000000'
  'restricted_roles': null
  'tags':
  - 'env:pilot-staging'
  - 'orca'
  - 'status'
  - 'redis'
  - 'infra'
  - 'managed_service'
  'type': 'query alert'

- 'message': '.'
  'name': '[Integration] [Oppcasting] [Infra] RabbitMQ
    - Messages waiting in queue'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 3.0
      'warning': 2.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:rabbitmq.queue.messages_ready{environment:integration,rabbitmq_vhost:oppcasting}
    > 3'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'oppcasting'
  - 'rabbitMQ'
  - 'infra'
  - 'status'

- 'message': '{{value}}'
  'name': '[Prod] [Canary] [Pod00] [App] [Campaign-Insights]
    [SEV0] Campaign-Insights Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.0
    'timeout_h': 0
  'query': 'sum(last_2h):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:campaign-insights,canary:true,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 1'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'canary'
  - 'campaign-insights'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n{{host.name}}: Low\
    \ usable swap disk: {{value}}  \n \n{{/is_alert}} \n\n{{#is_no_data}}\n{{host.name}}:\
    \ Low usable swap disk: {{value}}  \n \n{{/is_no_data}} \n\n{{#is_recovery}}\n\
    {{host.name}}: Disk usage back to normal \n \n{{/is_recovery}}\n\n{{#is_no_data_recovery}}\n\
    {{host.name}}: is reporting again \n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [sys] [Campaign-Insights]
    % Usable Swap Disk'
  'options':
    'escalation_message': '{{host.name}}: STILL
      is Low usable swap disk: {{value}}'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_audit': true
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 0.6
    'timeout_h': 1
  'query': 'avg(last_4h):min:system.swap.pct_free{environment:data-tests,feature_name:campaign-insights,!type:mongo}
    by {host} < 0.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'sys'
  - 'campaign-insights'

- 'message': '.'
  'name': '[Integration] [All] [Infra] Integration
    - Fetched data from core to All'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 100.0
      'warning': 200.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(avg:orca.get_sf_data.total_obj_fetched{environment:integration},
    0) < 100'
  'restricted_roles': null
  'tags':
  - 'env:integration'
  - 'cross-features'
  - 'infra'
  - 'integration'
  - 'status'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}\n\n{{#is_no_data}}\n\
    \ \n{{/is_no_data}} \n\n{{#is_no_data_recovery}}\n \n{{/is_no_data_recovery}}"
  'multi': true
  'name': '[Data-tests] [Pardot-Fetcher] [Mongo]
    Mongo Latency'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 10
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5.0
    'timeout_h': 1
  'query': 'avg(last_15m):avg:orca.mongo.latency_test.find.time.max{environment:data-tests,feature_name:pardot-fetcher}
    by {mongo} / 60000 > 5'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'pardot-fetcher'
  - 'env:data-tests'
  'type': 'query alert'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}"
  'multi': true
  'name': '[Staging] [Campaign-Insights] [Mongo]
    [app] MongoDB Replica with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:pilot-staging,feature_name:campaign-insights}
    by {host} > 5400'
  'restricted_roles': null
  'tags':
  - 'app'
  - 'env:pilot-staging'
  - 'campaign-insights'
  - 'mongo'

- 'message': "{{#is_alert}}MongoDB Replica lag is\
    \ dangerous on {{host.name}}{{/is_alert}} \n{{#is_recovery}}MongoDB Replica lag\
    \ is back to normal on {{host.name}}{{/is_recovery}}\n{{#is_no_data}}MongoDB Replica\
    \ {{host.name}} is not sending data {{/is_no_data}}"
  'multi': true
  'name': '[OPLOG Lag] Implisit MongoDB Replica
    with lag dangerous on {{host.name}}'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': 60
    'renotify_interval': 0
    'require_full_window': false
    'thresholds':
      'critical': 5400.0
      'warning': 4500.0
    'timeout_h': 0
  'query': 'avg(last_30m):avg:mongodb.replset.replicationlag{environment:production}
    by {host} > 5400'
  'restricted_roles': null

- 'message': "{{#is_alert}}\n\n \n\n{{/is_alert}}\
    \ \n\n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Lead-Scoring] [Sys] [Mongo] Disk
    space is low on {{host.name}} - {{device.name}} - Data'
  'options':
    'escalation_message': 'Disk space is still low
      on {{host.name}} ( {{device.name}} - Production ) - Data'
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 60
    'require_full_window': false
    'thresholds':
      'critical': 85.0
      'warning': 81.0
    'timeout_h': 0
  'query': 'avg(last_10m):max:system.disk.in_use{environment:production,feature_name:lead-scoring,type:mongo,device:/dev/xvdf1}
    by {host,device} * 100 >= 85'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'status'
  - 'mongo'
  - 'lead-scoring'
  'type': 'query alert'

- 'message': '. @slack-sev0-1'
  'name': '[Prod] [Pod00] [App] [Attribution] [SEV0]
    Attribution Cycles'
  'options':
    'escalation_message': ''
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 2.0
    'timeout_h': 0
  'query': 'sum(last_30m):default(sum:orca.module.tenant_run.run_full_cycle.time.count{environment:production,feature_name:attribution,canary:false,!sfenv:stmp1,!sfenv:stmp2}.as_count(),
    0) < 2'
  'restricted_roles': null
  'tags':
  - 'env:production'
  - 'attribution'
  - 'pod00'
  - 'sev0'
  - 'app'
  'type': 'query alert'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pod00] [Core-Fetcher]
    [Mongo] [Mongo Connections] Active clients - Delete'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 9000.0
      'warning': 6000.0
    'timeout_h': 0
  'query': 'avg(last_15m):avg:mongodb.opcounters.deleteps{environment:integration,type:mongo,feature_name:core-fetcher,pod:pod00}
    by {host} > 9000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'core-fetcher'
  - 'pod00'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Integration] [Pardot-Fetcher] [Mongo]
    [Tickets - Threads Mongo] Read available threads'
  'options':
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 40.0
      'warning': 80.0
    'timeout_h': 0
  'query': 'avg(last_15m):max:mongodb.wiredtiger.concurrenttransactions.read.available{environment:integration,type:mongo,feature_name:pardot-fetcher}
    by {host} < 40'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:integration'
  - 'pardot-fetcher'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Data-tests] [All] [Sys] [Mongo]  Load
    average (norm.15)'
  'options':
    'evaluation_delay': 300
    'include_tags': false
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 1.6
      'warning': 1.5
    'timeout_h': 0
  'query': 'min(last_4h):avg:system.load.norm.15{environment:data-tests,type:mongo}
    by {host} > 1.6'
  'restricted_roles': null
  'tags':
  - 'env:data-tests'
  - 'status'
  - 'mongo'
  - 'cross-features'

- 'message': "{{#is_alert}}\n \n{{/is_alert}} \n\
    \n{{value}} \n\n{{#is_alert_recovery}}\n \n{{/is_alert_recovery}}"
  'multi': true
  'name': '[Prod] [Orca] [Mongo] [Mongo Connections]
    Active clients - Insert'
  'options':
    'include_tags': true
    'new_host_delay': 300
    'no_data_timeframe': null
    'notify_no_data': false
    'renotify_interval': 0
    'require_full_window': true
    'thresholds':
      'critical': 20000.0
      'warning': 10000.0
    'timeout_h': 0
  'query': 'avg(last_4h):avg:mongodb.opcounters.insertps{environment:production,type:mongo,feature_name:orca}
    by {host} > 20000'
  'restricted_roles': null
  'tags':
  - 'status'
  - 'mongo'
  - 'env:production'
  - 'orca'

